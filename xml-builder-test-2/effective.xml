<PP xmlns="https://niap-ccevs.org/cc/v1" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:cc="https://niap-ccevs.org/cc/v1" xmlns:sec="https://niap-ccevs.org/cc/v1/section" boilerplate="yes" target-product="Mobile Device">
  <PPReference>
    <ReferenceTable>
      <PPTitle>Mobile Device Fundamentals</PPTitle>
      <PPVersion>4.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2025-01-31</PPPubDate>
      <Keywords>mobile device, security functionality</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2013-10-21</date>
      <subject>Initial Release</subject>
    </entry>
    <entry>
      <version>1.1</version>
      <date>2014-01-12</date>
      <subject>Typographical changes and additional clarifications in application notes. Removed assignment from FCS_TLS_EXT.1 and limited testing to those ciphersuites in both FCS_TLS_EXT.1 and FCS_TLS_EXT.2.</subject>
    </entry>
    <entry>
      <version>2.0</version>
      <date>2015-09-14</date>
      <subject>Included changes based on Technical Rapid Response Team Decisions. Clarified many requirements and evaluation activities. Mandated objective requirements:<h:br/><h:ul><h:li>Application Access Control (FDP_ACF_EXT.1.2)</h:li> <h:li>VPN Information Flow Control (FDP_IFC_EXT.1)</h:li></h:ul> Added new objective requirements:<h:br/><h:ul><h:li>Suite B cryptography for IEEE 802.11</h:li> <h:li>Certificate enrollment</h:li> <h:li>Protection of additional key material types</h:li> <h:li>Heap overflow protection</h:li> <h:li>Bluetooth requirements</h:li> <h:li>Cryptographic operation services for applications</h:li> <h:li>Remote Attestation (FPT_NOT_EXT.1)</h:li></h:ul> Added transition dates for some objective requirements.<h:br/> Included hardware-isolated REK and key storage selections.<h:br/> Allowed key derivation by REK.<h:br/> Clarified FTP_ITC_EXT.1 and added FDP_UPC_EXT.1.<h:br/> Mandated HTTPS and TLS for application use. (FDP_UPC_EXT.1)<h:br/> Removed Dual_EC_DRBG as an approved DRBG.<h:br/> Adopted new TLS requirements. <h:br/> Mandated TSF Wipe upon authentication failure limit and required number of authentication failures be maintained across reboot.<h:br/> Clarified Management Class.<h:br/> Included more domain isolation discussion and tests.<h:br/> Updated Audit requirements and added Auditable Events table.<h:br/> Added SFR Category Mapping Table.<h:br/> Updated Use Case Templates.<h:br/> Moved Glossary to Introduction.</subject>
    </entry>
    <entry>
      <version>3.0</version>
      <date>2015-09-17</date>
      <subject>Included changes based on Technical Rapid Response Team Decisions.<h:br/> Clarified many requirements and evaluation activities.<h:br/> Mandated objective requirements:<h:br/><h:ul><h:li>Generation of Audit Records (FAU_GEN.1)</h:li> <h:li>Audit Storage Protection (FAU_STG.1)</h:li> <h:li>Audit Storage Overwrite (FAU_STG.4)</h:li> <h:li>Lock Screen DAR (FDP_DAR_EXT.2)</h:li> <h:li>Discard Bluetooth Connection Attempts from Bluetooth Addresses with Existing Connection (FIA_BLT_EXT.3)</h:li> <h:li>JTAG Disablement (FPT_JTA)</h:li></h:ul> Added new objective requirements:<h:br/><h:ul><h:li>Application Backup</h:li> <h:li>Biometric Authentication Factor</h:li> <h:li>Access Control</h:li> <h:li>User Authentication</h:li> <h:li>Bluetooth Encryption</h:li></h:ul> WLAN client requirements moved to Extended Package for WLAN Client.<h:br/> Added SFRs to support BYOD Use Case<h:br/> BYOD Use Case<h:br/> Updated key destruction SFR </subject>
    </entry>
    <entry>
      <version>3.1</version>
      <date>2017-04-05</date>
      <subject>Included changes based on Technical Rapid Response Team Decisions and incorporated Technical Decisions.<h:br/> Modified biometric requirements: <h:ul><h:li>FIA_UAU.5 - Added iris, face, voice and vein as supported modalities, in addition to fingerprint (allowed in version 3)</h:li> <h:li>FIA_BMG_EXT.1.1 - Clarified AA to specify that vendor evidence is acceptable and expectations of evidence provided. </h:li> <h:li>FIA_BMG_EXT.1.2 - SAFAR was changed to an assignment of a SAFAR no greater than 1:500. </h:li> <h:li>FIA_AFL_EXT.1 - Updated to allow each biometric modality to utilize an individual or shared counter.</h:li></h:ul> FCS_TLSC_EXT.1.1 - Removed TLS ciphersuites that utilized SHA1 and updated optional ciphersuites to be uniformed across PPs.<h:br/> FCS_STG_EXT.2.2 - Modified to require long term trusted channel key material be encrypted by an approved method.<h:br/> FIA_UAU_EXT.1.1 - Modified to allow the long term trusted channel key material to be available prior to password being entered at start-up.<h:br/></subject>
    </entry>
    <entry>
      <version>3.2</version>
      <date>2021-04-15</date>
      <subject>Removed TLS SFRs and used TLS Functional Package<h:br/> Removed Bluetooth SFRs and utilized Bluetooth Module. Bluetooth SFR moved to Implementation Dependent.<h:br/> FPT_TUD_EXT.4.2 renumbered to <xref to="fel-app-verify-how"/><h:br/></subject>
    </entry>
    <entry>
      <version>3.3</version>
      <date>2022-09-12</date>
      <subject>Integrated Biometrics cPP Module, Included changes based on Technical Rapid Response Team Decisions and open issues from GitHub.<h:br/><h:li>Removed biometric definitions from Tech Terms</h:li> <h:li>Removed FDP_PBA</h:li> <h:li>Removed FIA_BMG</h:li> <h:li>Updated FIA_UAU.5 to support bio cPP module</h:li> <h:li>Moved FTA_TAB.1 to mandatory</h:li> <h:li>Moved FAU_SAR.1 to mandatory</h:li> <h:li>Added ECD</h:li> <h:li>Updated WLAN Client reference from Extended Package to Module</h:li> <h:li>Removed Diffie-Hellman group 14 selection from FCS_CKM.1.1 and FCS_CKM_EXT.7.1/UNLOCKED</h:li></subject>
    </entry>
    <entry>
      <version>4.0</version>
      <date>2024-09-20</date>
      <subject>
        <h:ul>
          <h:li>Updated to conform to CC:2022.</h:li>
          <h:li>Updated TLS package references.</h:li>
          <h:li>Incorporated X.509 package.</h:li>
          <h:li>Incorporated applicable technical decisions.</h:li>
          <h:li>Updated cryptographic algorithm strengths to conform to CNSA.</h:li>
        </h:ul>
      </subject>
    </entry>
  </RevisionHistory>
  <release-notes><h:h3>TDs Applied</h:h3></release-notes><include-pkg id="tls">
    <git>
      <url>https://github.com/commoncriteria/tls</url>
      <branch>release-2.1</branch>
    </git>
    <url>https://www.niap-ccevs.org/static_html/protection-profile/519</url>
  </include-pkg>
  <include-pkg id="X509">
    <git>
      <url>https://github.com/commoncriteria/X509</url>
      <branch>release-1.0</branch>
    </git>
    <url>https://www.niap-ccevs.org/protectionprofiles/511</url>
  </include-pkg>
  <modules>
    <module id="mod-vpnclient">
      <git>
        <url>https://github.com/commoncriteria/vpnclient</url>
        <branch>master</branch>
      </git>
      <url/>
    </module>
    <module id="mod-bluetooth">
      <git>
        <url>https://github.com/commoncriteria/bluetooth</url>
        <branch>master</branch>
      </git>
      <url/>
    </module>
    <module id="mod-mdmagent">
      <git>
        <url>https://github.com/commoncriteria/mdmagent</url>
        <branch>master</branch>
      </git>
      <url/>
    </module>
    <module id="mod-wlanclient">
      <git>
        <url>https://github.com/commoncriteria/wlanclient</url>
        <branch>master</branch>
      </git>
      <url/>
    </module>
    <module id="mod-biometrics" name="Biometric Enrollment and Verification" product="Biometric Devices" short="Biometric cPP" version="1.1">
      <url>https://github.com/biometricITC/cPP-biometrics/blob/master/Protection%20Profile/BiocPP.adoc</url>
    </module>
  </modules>
  <pp-preferences>
    <audit-events-in-sfrs/>
  </pp-preferences>
  <sec:Introduction>
    <sec:Objectives_of_Document title="Overview">The scope of this Protection Profile (PP) is to describe the security functionality of mobile devices in terms of [CC] and to define functional and assurance requirements for such devices.</sec:Objectives_of_Document>
    <tech-terms>
      <term full="Address Space Layout Randomization" abbr="ASLR">An anti-exploitation feature,
        which loads memory mappings into unpredictable locations. ASLR makes it more difficult for
        an attacker to redirect control to code that they have introduced into the address space of
        a process or the kernel.</term>
      <term full="Administrator">The Administrator is responsible for management activities,
        including setting the policy that is applied by the enterprise on the Mobile Device. This
        administrator is likely to be acting remotely and could be the Mobile Device Management
        (MDM) Administrator acting through an MDM Agent. If the device is unenrolled, the user is
        the administrator.</term>
      <term full="Auxiliary Boot Modes">Auxiliary boot modes are states in which the device
        provides power to one or more components to provide an interface that enables an
        unauthenticated user to interact with either a specific component or several components that
        exist outside of the device’s fully authenticated, operational state.</term>
      <term full="Biometric Authentication Factor" abbr="BAF">Authentication factor, which uses
        biometric sample, matched to a biometric authentication template to help establish
        identity.</term>
      <term full="Common Application Developer">Application developers (or software companies)
        often produce many applications under the same name. Mobile devices often allow shared
        resources by such applications where otherwise resources would not be shared.</term>
      <term full="Critical Security Parameter" abbr="CSP">Security-related information whose
        disclosure or modification can compromise the security of a cryptographic module or
        authentication system.</term>
      <term full="Data">Program/application or data files that are stored or transmitted by a
        server or Mobile Device (MD).</term>
      <term full="Data Encryption Key" abbr="DEK">A key used to encrypt data-at-rest.</term>
      <term full="Developer Modes">Developer modes are states in which additional services are
        available to a user in order to provide enhanced system access for debugging of software.</term>
      <term full="Encrypted Software Keys">These keys are stored in the main file system encrypted
        by another key and can be changed and sanitized.</term>
      <term full="Enrolled State">The state in which the Mobile Device is managed with active
        policy settings from the administrator.</term>
      <term full="Enterprise Data">Enterprise data is any data residing in the enterprise servers,
        or temporarily stored on Mobile Devices to which the Mobile Device user is allowed access
        according to security policy defined by the enterprise and implemented by the
        administrator.</term>
      <term full="Ephemeral Keys"> These keys are stored in volatile memory.</term>
      <term full="File Encryption Key" abbr="FEK">A DEK used to encrypt a file or a director when
        File Encryption is used. FEKs are unique to each encrypted file or directory.</term>
      <term full="Hardware-Isolated Keys">The OS can only access these keys by reference, if
        at all, during runtime.</term>
      <term full="Hybrid Authentication">A hybrid authentication factor is one where a user has to
        submit a combination of a biometric sample and a PIN or password and both must pass. If either factor fails, the entire attempt fails. The user shall not be made aware of which factor failed, if either fails.</term>
      <term full="Immutable Hardware Key">These keys are stored as hardware-protected raw key and
        cannot be changed or sanitized.</term>
      <term full="Key Chaining">The method of using multiple layers of encryption keys to protect
        data. A top layer key encrypts a lower layer key, which encrypts the data; this method can
      have any number of layers.</term>
      <term full="Key Encryption Key" abbr="KEK">A key used to encrypt other keys, such as DEKs or
        storage that contains keys.</term>
      <term full="Locked State">Powered on but most functionality is unavailable for use. User
        authentication is required to access functionality.</term>
      <term full="Mobile Device" abbr="MD">A device which is composed of a hardware platform and
        its system software. The device typically provides wireless connectivity and may include
        software for functions like secure messaging, email, web, VPN (Virtual Private Network) connection, and VoIP (Voice
        over IP), for access to the protected enterprise network, enterprise data and applications,
        and for communicating to other Mobile Devices.</term>
      <term full="Mobile Device Management" abbr="MDM">Mobile device management (MDM) products
        allow enterprises to apply security policies to mobile devices. This system consists of two
        primary components: the MDM Server and the MDM Agent.</term>
      <term full="MDM Agent">The MDM Agent is installed on a Mobile Device as an application or is
        part of the Mobile Device’s OS. The MDM Agent establishes a secure connection back to the
        MDM Server controlled by the administrator.</term>
      <term full="Minutia Point">Friction ridge characteristics that are used to individualize a
        fingerprint image. Minutia are the points where friction ridges begin, terminate, or split
        into two or more ridges. In many fingerprint systems, the minutia points are compared for
        recognition purposes.</term>
      <term full="Mobile Device User">The individual authorized to physically control and
        operate the Mobile Device. Depending on the use case, this can be the device owner or an
        individual authorized by the device owner.</term>
      <term full="Modality">A type or class of biometric system, such as fingerprint
        recognition, facial recognition, iris recognition, voice recognition, signature/sign, and
        others.</term>
      <term full="Mutable Hardware Key">These keys are stored as hardware-protected raw key and can
      be changed or sanitized.</term>
      <term full="Operating System" abbr="OS">Software that runs at the highest privilege level
        and can directly control hardware resources. Modern Mobile Devices typically have at least
        two primary operating systems: one, which runs on the application processor and one,
        which runs on the cellular baseband processor. The OS of the application processor handles most
        user interactions and provides the execution environment for apps. The OS of the cellular
        baseband processor handles communications with the cellular network and may control other
        peripherals. The term OS, without context, may be assumed to refer to the OS of the
        application processor.</term>
      <term full="Password Authentication Factor">A type of authentication factor requiring the
        user to provide a secret set of characters to gain access.</term>
      <term full="PIN Authentication Factor">A PIN is a set of numeric or alphabetic characters that may be used
        in addition to a biometric factor to provide a hybrid authentication factor. At this time it
        is not considered as a stand-alone authentication mechanism. A PIN is distinct from a password in that the allowed character set and required length of a PIN
      is typically smaller than that of a password as it is designed to be input quickly.</term>
      <term full="Powered Off State">The device has been shut down such that no TOE function can be
        performed.</term>
      <term full="Protected Data" abbr="PD">Protected data is all non-TSF data, including all user
        or enterprise data. Some or all of this data may be considered sensitive data as well.</term>
      <term full="Root Encryption Key" abbr="REK">A key tied to the device used to encrypt other
        keys.</term>
      <term full="Sensitive data">Sensitive data shall be identified in the TSS section of the
        Security Target (ST) by the ST author. Sensitive data is a subset or all of the Protected
        data. Sensitive data may include all user or enterprise data or may be specific application
        data such as emails, messaging, documents, calendar items, and contacts. Sensitive data is
        protected while in the locked state (FDP_DAR_EXT.2).</term>
      <term full="Software Keys"> The OS access the raw bytes of these keys during runtime.</term>
      <term full="Trust Anchor Database">A list of trusted root Certificate Authority
        certificates.</term>
      <term full="TSF Data">Data for the operation of the TSF upon which the enforcement of the
        requirements relies.</term>
      <term full="Unenrolled State"> The state in which the Mobile Device is not managed. </term>
      <term full="Unlocked State">Powered on and device functionality is available for use. Implies
        user authentication has occurred (when so configured).</term>
      <term full="Verification">A task where the biometric system attempts to confirm
        an individual’s claimed identity by comparing a submitted sample to one or more previously
        enrolled authentication templates.</term>
      <term full="Advanced Encryption Standard" abbr="AES"/>
      <term full="Authenticated Encryption with Associated Data" abbr="AEAD"/>
      <term full="American National Standards Institute" abbr="ANSI"/>
      <term full="Application Processor" abbr="AP"/>
      <term full="Application Programming Interface" abbr="API"/>
      <term full="Baseband Processor" abbr="BP"/>
      <term full="(Bluetooth) Basic Rate/Enhanced Data Rate" abbr="BR/EDR"/>
      <term full="Bring Your Own Device" abbr="BYOD"/>
      <term full="Certificate Authority" abbr="CA"/>
      <term full="Cipher Block Chaining" abbr="CBC"/>
      <term full="Counter with CBC-Message Authentication Code" abbr="CCM"/>
      <term full="CCM Protocol" abbr="CCMP"/>
      <term full="Certificate Management over Cryptographic Message Syntax (CMS)" abbr="CMC"/>
      <term full="Central Processing Unit" abbr="CPU"/>
      <term full="Certificate Revocation List" abbr="CRL"/>
      <term full="Data At Rest" abbr="DAR"/>
      <term full="Data Encryption Key" abbr="DEK"/>
      <term full="Data Execution Prevention" abbr="DEP"/>
      <term full="Diffie-Hellman" abbr="DH"/>
      <term full="Domain Name System" abbr="DNS"/>
      <term full="Digital Signature Algorithm" abbr="DSA"/>
      <term full="Datagram Transport Layer Security" abbr="DTLS"/>
      <term full="Extensible Authentication Protocol" abbr="EAP"/>
      <term full="EAP Over LAN" abbr="EAPOL"/>
      <term full="Elliptic Curve Diffie Hellman" abbr="ECDH"/>
      <term full="Elliptic Curve Digital Signature Algorithm" abbr="ECDSA"/>
      <term full="Electrically Erasable Programmable Read-Only Memory" abbr="EEPROM"/>
      <term full="Enrollment over Secure Transport" abbr="EST"/>
      <term full="Federal Information Processing Standards" abbr="FIPS"/>
      <term full="Frequency Modulation" abbr="FM"/>
      <term full="Fully Qualified Domain Name" abbr="FQDN"/>
      <term full="Finite Field Cryptography" abbr="FFC"/>
      <term full="Galois Counter Mode" abbr="GCM"/>
      <term full="Global Positioning System" abbr="GPS"/>
      <term full="Graphics Processing Unit" abbr="GPU"/>
      <term full="High Definition Multimedia Interface" abbr="HDMI"/>
      <term full="Keyed-Hash Message Authentication Code" abbr="HMAC"/>
      <term full="HyperText Transfer Protocol Secure" abbr="HTTPS"/>
      <term full="Institute of Electrical and Electronics Engineers" abbr="IEEE"/>
      <term full="Internet Protocol" abbr="IP"/>
      <term full="Inter-Process Communication" abbr="IPC"/>
      <term full="Internet Protocol Security" abbr="IPsec"/>
      <term full="Known Answer Test" abbr="KAT"/>
      <term full="Key Derivation Function" abbr="KDF"/>
      <term full="(Bluetooth) Low Energy" abbr="LE"/>
      <term full="Long Term Evolution" abbr="LTE"/>
      <term full="Man-Machine Interface" abbr="MMI"/>
      <term full="Memory Management Unit" abbr="MMU"/>
      <term full="Multimedia Messaging Service" abbr="MMS"/>
      <term full="Network Time Protocol" abbr="NTP"/>
      <term full="Near Field Communication" abbr="NFC"/>
      <term full="National Institute of Standards and Technology" abbr="NIST"/>
      <term full="Never Execute" abbr="NX"/>
      <term full="Online Certificate Status Protocol" abbr="OCSP"/>
      <term full="Object Identifier" abbr="OID"/>
      <term full="Over the Air" abbr="OTA"/>
      <term full="Personal Identity Verification" abbr="PIV"/>
      <term full="Port Access Entity" abbr="PAE"/>
      <term full="Password-Based Key Derivation Function" abbr="PBKDF"/>
      <term full="Pre-Shared Key" abbr="PSK"/>
      <term full="Pseudorandom Function" abbr="PRF"/>
      <term full="Pairwise Master Key" abbr="PMK"/>
      <term full="Pairwise Temporal Key" abbr="PTK"/>
      <term full="Registration Authority" abbr="RA"/>
      <term full="Random Bit Generator" abbr="RBG"/>
      <term full="Read-only memory" abbr="ROM"/>
      <term full="Rivest Shamir Adleman Algorithm" abbr="RSA"/>
      <term full="Secure Hash Algorithm" abbr="SHA"/>
      <term full="Short Messaging Service" abbr="SMS"/>
      <term full="Security Parameter Index" abbr="SPI"/>
      <term full="Secure Shell" abbr="SSH"/>
      <term full="Service Set Identifier" abbr="SSID"/>
      <term full="System Authentication False Accept Rate" abbr="SAFAR"/>
      <term full="System On a Chip" abbr="SoC"/>
      <term full="Transport Layer Security" abbr="TLS"/>
      <term full="Uniform Resource Identifier" abbr="URI"/>
      <term full="Universal Serial Bus" abbr="USB"/>
      <term full="Unstructured Supplementary Service Data" abbr="USSD"/>
      <term full="Virtual Private Network" abbr="VPN"/>
      <term full="eXtensible Configuration Checklist Description Format" abbr="XCCDF"/>
      <term full="XEX (XOR Encrypt XOR) Tweakable Block Cipher with Ciphertext Stealing" abbr="XTS"/>
    </tech-terms>
    <section title="TOE Overview" id="toeov">
      This assurance standard specifies information security
      requirements for Mobile Devices for use in an enterprise. A Mobile Device in the context of
      this assurance standard is a device, which is composed of a hardware platform and its system
      software. The device typically provides wireless connectivity
      and may include software for functions
      like secure messaging, email, web, VPN connection, and VoIP (Voice over IP), for access to the
      protected enterprise network, enterprise data and applications, and for communicating to other
      Mobile Devices.
      <h:br/>
      <h:br/>
      <xref to="NetEnv"/>
      illustrates the network operating environment of the Mobile Device.
      <h:br/>
      <h:br/>
      <figure entity="images/figure1.jpg" title="Mobile Device Network Environment" id="NetEnv"/>
      <h:br/>
      <h:br/>
      Examples of a "Mobile Device" that should claim conformance to this Protection
      Profile include smartphones, tablet computers, and other Mobile Devices with similar
      capabilities.
      <h:br/>
      <h:br/>
      The Mobile Device provides essential services, such as
      cryptographic services, data-at-rest protection, and key storage services to support the
      secure operation of applications on the device. Additional security features such as security
      policy enforcement, application mandatory access control, anti-exploitation features, user
      authentication, and software integrity protection are implemented in order to address threats.
      <h:br/>
      <h:br/>
      This assurance standard describes these essential security services
      provided by the Mobile Device and serves as a foundation for a secure mobile architecture. The
      wireless connectivity shall be validated against the
      <xref to="mod-wlanclient"/>. If the
      mobile device contains Bluetooth functionality (i.e., has Bluetooth hardware), the Bluetooth
      connectivity shall be evaluated against the
      <xref to="mod-bluetooth"/>.
	  As illustrated in
      <xref to="TOE"/>, it is expected that a typical deployment would also include either
      third-party or bundled components. Whether these components are bundled as part of the Mobile
      Device by the manufacturer or developed by a third-party, they must be separately validated
      against the related assurance standards such as the PP-Module for MDM Agent, PP-Module for VPN
      Client, PP-Module for VVoIP, and cPP-Module for Biometrics. It is the responsibility of the architect of
      the overall secure mobile architecture to ensure validation of these components. Additional
      applications that may come pre-installed on the Mobile Device that are not validated are
      considered to be potentially flawed, but not malicious. Examples include email client and web
      browser.
      <h:br/>
      <h:br/>
      <figure entity="images/figure2.jpg" title="Optional Additional Mobile Device Components" id="TOE"/>
      <h:br/>
    </section>
    <sec:Use_Cases>
      <h:p>
        The Mobile Device may be operated in a number of use cases.
        <xref g="use-case-appendix"/>
        provides use case templates that list those selections,
        assignments, and objective requirements that best support the use cases identified by this
        Protection Profile.
        In addition to providing essential security services, the Mobile Device
        includes the necessary security functionality to support configurations for these various use
        cases.
        Each use case may require additional configuration and applications to achieve the
        desired security.
        A selection of these use cases is elaborated below.
      </h:p>
      <h:p>Several of the use case templates include objective requirements that are strongly desired for
        the indicated use cases.
        Readers can expect those requirements to be made mandatory in a
        future revision of this protection profile, and industry should aim to include that security
        functionality in products in the near-term.</h:p>
      <h:p>
        As of publication of this version of the Protection Profile, meeting the requirements in
        <xref to="Security_Requirements"/>
        is necessary for all use cases.
      </h:p>
      <usecases>
        <usecase title="Enterprise-owned device for general-purpose enterprise use and limited personal use" id="uc-enterprise">
          <description>
            <h:br/>
            An enterprise-owned device for general-purpose business use is commonly
          called
            <h:i>Corporately Owned, Personally Enabled (COPE)</h:i>.
          This use case entails a significant degree of enterprise control over configuration 
          and, possibly, software inventory.
          The enterprise elects to provide users with Mobile Devices and additional applications (such as
          VPN or email clients) in order to maintain control of their Enterprise data and security of
          their networks.
          Users may use Internet connectivity to browse the web or access corporate mail
          or run enterprise applications, but this connectivity may be under significant control of the
          enterprise.
          </description>
        </usecase>
        <usecase title="Enterprise-owned device for specialized, high security use" id="uc-secure">
          <description>
            <h:br/>
            An enterprise-owned device with intentionally limited network connectivity, tightly controlled configuration, and limited software inventory is appropriate for specialized, high-security use cases. For example, the device may not be permitted connectivity to any external peripherals. It may only be able to communicate via its Wi-Fi or cellular radios with the enterprise-run network, which may not even permit connectivity to the Internet. Use of the device may entail compliance with policies that are more restrictive than those in any general-purpose use case, yet may mitigate risks to highly sensitive information. As in the previous case, the enterprise will look for additional applications providing enterprise connectivity and services to have a similar level of assurance as the platform.
          </description>
        </usecase>
        <usecase title="Personally-owned device for personal and enterprise use" id="uc-personal">
          <description>
            <h:br/>
            A personally-owned device that is used for both personal activities and enterprise data is commonly called Bring Your Own Device (BYOD). The device may be provisioned for access to enterprise resources after significant personal usage has occurred. Unlike in the enterprise-owned cases, the enterprise is limited in what security policies it can enforce because the user purchased the device primarily for personal use and is unlikely to accept policies that limit the functionality of the device. However, because the enterprise allows the user full (or nearly full) access to the enterprise network, the enterprise will require their own security controls to ensure that enterprise resources are protected from potential threats posed by the personal activities on the device. These controls could potentially be enforced by a separation mechanism built-in to the device itself to distinguish between enterprise and personal activities, or by a third-party application that provides access to enterprise resources and leverages security capabilities provided by the mobile device. Based upon the operational environment and the acceptable risk level of the enterprise, those security functional requirements outlined in
            <xref to="Security_Requirements"/>
            of this PP along with the selections in the Use Case 3 template defined in Appendix F - Use Case Templates are sufficient for the secure implementation of this BYOD use case.
          </description>
        </usecase>
        <usecase title="Personally-owned device for personal and limited enterprise use" id="uc-personal-limited">
          <description>
            <h:br/>
            A personally-owned device that is used for both personal activities and enterprise data is commonly called Bring Your Own Device (BYOD). This device may be provisioned for limited access to enterprise resources such as enterprise email. Because the user does not have full access to the enterprise or enterprise data, the enterprise may not need to enforce any security policies on the device. However, the enterprise may want secure email and web browsing with assurance that the services being provided to those clients by the Mobile Device are not compromised. Based upon the operational environment and the acceptable risk level of the enterprise, those security functional requirements outlined in Section 5 Security Requirements of this PP are sufficient for the secure implementation of this BYOD use case.
          </description>
        </usecase>
      </usecases>
    </sec:Use_Cases>
    <section title="Package Usage" id="package-usage">
      This section contains selections and assignments that are required when the listed Functional Packages are claimed by this PP.
      <package-usage-list>
        <package-usage ref="tls">
          <usage id="usage-tls-protocols" title="TLS Protocol Claims required in FCS_TLS_EXT.1">
            <description>To support FTP_ITC_EXT.1 and FDP_UPC_EXT.1/APPS, the ST author shall claim support for TLS as a client. If DTLS is claimed in FTP_ITC_EXT.1, the ST author shall also claim support for DTLS as a client. Support for TLS as a server or DTLS as a server shall not be claimed.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-tls-support-mutual-auth" title="TLS Client Claims required in FCS_TLSC_EXT.1">
            <description>To support FTP_ITC_EXT.1 and FDP_UPC_EXT.1/APPS, the ST author shall claim support for mutual authentication in FCS_TLSC_EXT.1.1. To support FCS_HTTPS_EXT.1.3, the ST author shall claim how the TOE handles invalid certificates in a manner that is consistent with the claims made in FCS_HTTPS_EXT.1.3. Regardless of the claims made for FCS_HTTPS_EXT.1.3, to support FDP_UPC_EXT.1/APPS, the ST author shall claim in FCS_TLSC_EXT.1.6 that invalid certificates are rejected with no exceptions in this specific case.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-tls-mutual-auth" title="Necessity of claiming FCS_TLSC_EXT.2">
            <description>Because support for TLS client mutual authentication is required, the ST author shall claim FCS_TLSC_EXT.2.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-tls-support-mutual-auth" title="DTLS Client Claims required in FCS_DTLSC_EXT.1">
            <description>To support FTP_ITC_EXT.1 and FDP_UPC_EXT.1/APPS specifically in the case where DTLS is claimed in FTP_ITC_EXT.1.1, the ST author shall claim support for mutual authentication in FCS_DTLSC_EXT.1.1.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-tls-mutual-auth" title="Necessity of claiming FCS_DTLSC_EXT.2 if DTLS is Supported">
            <description>DTLS support is not mandatory. However, if DTLS is claimed in FTP_ITC_EXT.1 or FDP_UPC_EXT.1/APPS, it is necessary for the TOE to support mutual authentication as a DTLS client. In this case, FCS_DTLS_EXT.2 shall be claimed as a result of the selections made in FCS_DTLSC_EXT.1.1.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
        </package-usage>
        <package-usage ref="X509">
          <usage id="usage-x509-validation" title="Certificate Validation and Assertion Required in FIA_XCU_EXT.1.1">
            <description>The ST author shall select the options to verify and assert certificate identities.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-noplatform" title="No Platform-Provided Functionality Claims Permitted">
            <description>
              Because the TOE is the entire mobile device and encompasses the platform, the ST author shall not claim platform-provided functionality. In other words, any applicable SFRs 
              shall select the option to implement or provide the functionality, rather than rely on a platform. These may include one or more of the following, depending on the TOE, but apply to all package requirements that have such a selection:
              <h:ul>
                <h:li>FIA_CMCC_EXT.1</h:li>
                <h:li>FIA_CMPC_EXT.1</h:li>
                <h:li>FIA_ESTC_EXT.1</h:li>
                <h:li>FIA_X509_EXT.1</h:li>
                <h:li>FIA_X509_EXT.2</h:li>
                <h:li>FIA_X509_EXT.3</h:li>
              </h:ul>
            </description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-notca" title="No CA Claims Permitted">
            <description>The ST author shall select the option to request a certificate from an external CA in FIA_XCU_EXT.2.1 and shall not select any options elsewhere in the package that involve claiming the ability to be a CA.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-revocation-sigalgs" title="Limitations on Signature Algorithms in FIA_X509_EXT.1.1">
            <description>The TOE must utilize appropriate cryptographic algorithms that conform to CNSA standards. Thus, the ST author shall select to utilize no other algorithms outside of those specified in RFC 8603 for certificate or CRL signatures. 
              Additionally, the ST author shall not select to use ECDSA with SHA-512 signatures for OCSP responses, and shall select to utilize no other algorithms for OCSP responses.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-extensions" title="Required Extension Processing for FIA_X509_EXT.1.2">
            <description>The ST author shall select the options to process the basicConstraints and extendedKeyUsage extensions. Other extensions may be selected as appropriate without restriction.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-revocation-methods" title="CRL or OCSP-based Revocation Required for FIA_X509_EXT.1.3 ">
            <description>The ST author shall select only from options involving CRL or OCSP in FIA_X509_EXT.1.3.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-revocation-connections" title="Connections to CRL or OCSP Servers Required for FIA_X509_EXT.1.4">
            <description>The ST author shall not select the options to not obtain revocation status information at any time, nor to utilize local revocation information or utilize a network connection to the CA to obtain its revocation information. 
              Revocation information must be retrieved via an option involving CRL or OCSP.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-eku-values" title="Restrictions on Acceptable Key Usage Values for FIA_X509_EXT.1.5">
            <description>
              The ST author shall not select the option to pass certificate information to supported functions and shall select the option to verify certificates by evaluating the extendedKeyUsage field in the leaf certificate.
              <h:br/>
              Additionally, the ST author shall not select the option to validate certificates against any rules for S/MIME certificates.
            </description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-functions" title="Restrictions on Acceptable Functions for FIA_X509_EXT.2.1">
            <description>The ST author shall not select options that involve the S/MIME or SSH protocols. If the TOE supports TSF integrity testing (i.e., FPT_TST_EXT.3 is claimed), FIA_X509_EXT.2.1 must include a claim that X.509 certificates are supported for code signing for software integrity testing. If the TOE supports trusted update verification using code signing certificates (i.e., FPT_TST_EXT.4 is claimed in the context of the TOE's own updates), FIA_X509_EXT.2.1 must include a claim that X.509 certificates are supported for code signing for system software updates. If the TOE supports code signing for mobile apps (i.e., FPT_TUD_EXT.4 is claimed in the context of external apps), the assignment in FIA_X509_EXT.2.1 must be completed to reference "code signing for mobile applications."</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-acquisition-purposes" title="Restrictions on Acceptable Purposes for Certificate Acquisition for FIA_XCU_EXT.2.1">
            <description>The ST author shall not select options that involve the S/MIME or SSH protocols.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
        </package-usage>
      </package-usage-list>
    </section>
    <section title="Product Features Mapped to Implementation-dependent Requirements" id="sec-features">
      The feature(s) enumerated below, if implemented by the TOE, require that additional SFRs be claimed in the ST.
      <h:br/>
      <implements>
        <feature id="bluetooth" title="Bluetooth">
          <description>Bluetooth is a short-range wireless technology standard that is commonly used for exchanging data between devices over short distances. Most, if not all, mobile devices include Bluetooth hardware.<h:br/></description>
        </feature>
      </implements>
    </section>
  </sec:Introduction>
  <sec:Conformance_Claims boilerplate="no">
    <CClaimsInfo cc-version="cc-2022r1" cc-approach="direct-rationale">
      <cc-st-conf>exact</cc-st-conf>
      <cc-pt2-conf>extended</cc-pt2-conf>
      <cc-pt3-conf>extended</cc-pt3-conf>
      <cc-pp-conf/>
      <cc-pp-config-with>
        <Mod-cc-ref>PP-Module for Virtual Private Network (VPN) Clients, version 3.0</Mod-cc-ref>
        <Mod-cc-ref>PP-Module for Bluetooth, version 2.0</Mod-cc-ref>
        <Mod-cc-ref>PP-Module for Mobile Device Management Agent, version 2.0</Mod-cc-ref>
        <Mod-cc-ref>PP-Module for Wireless LAN Clients, version 2.0</Mod-cc-ref>
        <Mod-cc-ref>cPP-Module for Biometric Enrolment and Verification, version 1.1</Mod-cc-ref>
      </cc-pp-config-with>
      <cc-pkg-claim>
        <FP-cc-ref conf="conformant">Functional Package for Transport Layer Security Version 2.1</FP-cc-ref>
        <FP-cc-ref conf="conformant">Functional Package for X.509 Version 1.0</FP-cc-ref>
      </cc-pkg-claim>
    </CClaimsInfo>
  </sec:Conformance_Claims>
  <!-- 3.0 Security Problem Definition-->
  <sec:Security_Problem_Definition>
    <!-- 3.1 Threats -->
    <sec:Threats>
      Mobile devices are subject to the threats of traditional
      computer systems along with those entailed by their mobile nature. The threats considered in
      this PP are those of network eavesdropping, network attacks, physical access,
      malicious or flawed applications, persistent presence, and backup
      as
      detailed in the following sections.
      <threats>
        <threat name="T.MALICIOUS_APP">
          <description> Applications loaded onto the Mobile Device may include malicious or            exploitable code. This code could be included intentionally or unknowingly by the            developer, perhaps as part of a software library. Malicious apps may attempt to            exfiltrate data to which they have access. They may also conduct attacks against the            platform’s system software, which will provide them with additional privileges and the            ability to conduct further malicious activities. Malicious applications may be able to            control the device's sensors (GPS, camera, microphone) to gather intelligence about the            user's surroundings even when those activities do not involve data resident or            transmitted from the device. Flawed applications may give an attacker access to perform            network-based or physical attacks that otherwise would have been prevented.</description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FAU_GEN.1</addressed-by>
          <rationale>FAU_GEN.1 helps mitigate the threat of a malicious app by logging evidence of potential malicious activity.</rationale>
          <addressed-by>FAU_SAR.1</addressed-by>
          <rationale>FAU_SAR.1 helps mitigate the threat of a malicious app by providing a mechanism to read the audit trail.</rationale>
          <addressed-by>FAU_SEL.1 (Objective)</addressed-by>
          <rationale>FAU_SEL.1 helps mitigate the threat of a network attack by allowing the TSF to determine the behavior that indicates potential malicious activity in the audit trail.</rationale>
          <addressed-by>FAU_STG.2</addressed-by>
          <rationale>FAU_STG.2 helps mitigate the threat of a malicious app by maintaining the availability of the audit trail.</rationale>
          <addressed-by>FAU_STG.5</addressed-by>
          <rationale>FAU_STG.5 helps mitigate the threat of a malicious app by maintaining the availability of the audit trail.</rationale>
          <addressed-by>FCS_RBG.6</addressed-by>
          <rationale>FCS_RBG.6 helps mitigate the threat of a malicious app by providing a secure and legitimate interface that can be invoked by apps to perform DRBG functionality.</rationale>
          <addressed-by>FCS_SRV_EXT.1</addressed-by>
          <rationale>FCS_SRV_EXT.1 helps mitigate the threat of a malicious app by providing a secure and legitimate interface that can be invoked by apps to perform cryptographic functionality.</rationale>
          <addressed-by>FCS_SRV_EXT.2 (Objective)</addressed-by>
          <rationale>FCS_SRV_EXT.1 helps mitigate the threat of a malicious app by providing a secure and legitimate interface that can be invoked by apps to interact with protected storage.</rationale>
          <addressed-by>FDP_ACF_EXT.1</addressed-by>
          <rationale>FDP_ACF_EXT.1 helps mitigate the threat of a malicious app by restricting the system services that are accessible to applications.</rationale>
          <addressed-by>FDP_ACF_EXT.2 (Selection-based)</addressed-by>
          <rationale>FDP_ACF_EXT.2 helps mitigate the threat of a malicious app by providing separate copies of system resources for different application groups.</rationale>
          <addressed-by>FDP_ACF_EXT.3 (Objective)</addressed-by>
          <rationale>FDP_ACF_EXT.3 helps mitigate the threat of a malicious app by enforcing policies on applications that prohibit write and execute permissions from being granted simultaneously.</rationale>
          <addressed-by>FDP_BCK_EXT.1 (Objective)</addressed-by>
          <rationale>FDP_BCK_EXT.1 helps mitigate the threat of a malicious app by determining which data to include in backup operations.</rationale>
          <addressed-by>FDP_BLT_EXT.1 (Objective)</addressed-by>
          <rationale>FDP_BLT_EXT.1 helps mitigate the threat of a malicious app by managing which applications communicate with Bluetooth devices.</rationale>
          <addressed-by>FMT_MOF_EXT.1</addressed-by>
          <rationale>FMT_MOF_EXT.1 helps mitigate the threat of a malicious app by limiting the management functions that are available to a given user.</rationale>
          <addressed-by>FMT_SMF_EXT.1</addressed-by>
          <rationale>FMT_SMF_EXT.1 helps mitigate the threat of a malicious app by defining the management functions that are provided by the TOE.</rationale>
          <addressed-by>FMT_SMF_EXT.2</addressed-by>
          <rationale>FMT_SMF_EXT.2 helps mitigate the threat of a malicious app by ensuring that sensitive data is purged from the TOE when it is no longer enrolled in mobile device management.</rationale>
          <addressed-by>FMT_SMF_EXT.3 (Objective)</addressed-by>
          <rationale>FMT_SMF_EXT.3 helps mitigate the threat of a malicious app by providing a current list of authorized administrators and their authorized management functions.</rationale>
          <addressed-by>FPT_AEX_EXT.1</addressed-by>
          <rationale>FPT_AEX_EXT.1 helps mitigate the threat of a malicious app by using address space layout randomization for all applications.</rationale>
          <addressed-by>FPT_AEX_EXT.2</addressed-by>
          <rationale>FPT_AEX_EXT.2 helps mitigate the threat of a malicious app by enforcing memory access permissions.</rationale>
          <addressed-by>FPT_AEX_EXT.3</addressed-by>
          <rationale>FPT_AEX_EXT.3 helps mitigate the threat of a malicious app by implementing stack-based buffer overflow protection running on non-privileged domains.</rationale>
          <addressed-by>FPT_AEX_EXT.4</addressed-by>
          <rationale>FPT_AEX_EXT.4 helps mitigate the threat of a malicious app by enforcing address space isolation.</rationale>
          <addressed-by>FPT_AEX_EXT.5 (Objective)</addressed-by>
          <rationale>FPT_AEX_EXT.5 helps mitigate the threat of a malicious app by enforcing kernel level ASLR.</rationale>
          <addressed-by>FPT_AEX_EXT.6 (Objective)</addressed-by>
          <rationale>FPT_AEX_EXT.6 helps mitigate the threat of a malicious app by preventing non-privileged execution domains from being writable and executable.</rationale>
          <addressed-by>FPT_AEX_EXT.7 (Objective)</addressed-by>
          <rationale>FPT_AEX_EXT.7 helps mitigate the threat of a malicious app by enforcing heap-based buffer overflow protections.</rationale>
          <addressed-by>FPT_BBD_EXT.1 (Objective)</addressed-by>
          <rationale>FPT_BBD_EXT.1 helps mitigate the threat of a malicious app by preventing the application processor's executable memory from being modified by the baseband processor.</rationale>
          <addressed-by>FPT_BLT_EXT.1 (Objective)</addressed-by>
          <rationale>FPT_BLT_EXT.1 helps mitigate the threat of a malicious app by enforcing least functionality of the TOE's Bluetooth interface.</rationale>
          <addressed-by>FPT_NOT_EXT.1</addressed-by>
          <rationale>FPT_NOT_EXT.1 helps mitigate the threat of a malicious app by failing to a secure state when self-test failures occur.</rationale>
          <addressed-by>FPT_NOT_EXT.2 (Objective)</addressed-by>
          <rationale>FPT_NOT_EXT.2 helps mitigate the threat of a malicious app by enforcing remote attestation to ensure that the TSF has not been compromised.</rationale>
          <addressed-by>FPT_STM.1</addressed-by>
          <rationale>FPT_STM.1 helps mitigate the threat of a malicious app by providing reliable time stamps for the audit trail.</rationale>
          <addressed-by>FPT_TST_EXT.1</addressed-by>
          <rationale>FPT_TST_EXT.1 helps mitigate the threat of a malicious app by performing self-tests that may detect a compromise of the TSF.</rationale>
          <addressed-by>FPT_TST_EXT.2/POSTKERNEL (Objective)</addressed-by>
          <rationale>FPT_TST_EXT.2/POSTKERNEL helps mitigate the threat of a malicious app by verifying the integrity of executable code after the kernel is loaded.</rationale>
          <addressed-by>FPT_TST_EXT.2/PREKERNEL</addressed-by>
          <rationale>FPT_TST_EXT.2/PREKERNEL helps mitigate the threat of a malicious app by performing self-tests that may detect a compromise of the TSF.</rationale>
          <addressed-by>FPT_TST_EXT.3 (Selection-based)</addressed-by>
          <rationale>FPT_TST_EXT.3 helps mitigate the threat of a malicious app by preventing the execution of untrusted application code.</rationale>
          <addressed-by>FPT_TUD_EXT.1</addressed-by>
          <rationale>FPT_TUD_EXT.1 helps mitigate the threat of a malicious app by enforcing mechanisms that allow for the identification of the TSF and of applications running on it.</rationale>
          <addressed-by>FPT_TUD_EXT.2</addressed-by>
          <rationale>FPT_TUD_EXT.2 helps mitigate the threat of a malicious app by enforcing mechanisms that allow for maintaining the authenticity and integrity of the TSF.</rationale>
          <addressed-by>FPT_TUD_EXT.3</addressed-by>
          <rationale>FPT_TUD_EXT.3 helps mitigate the threat of a malicious app by enforcing mechanisms that allow for maintaining the authenticity and integrity of installed apps.</rationale>
          <addressed-by>FPT_TUD_EXT.4 (Selection-based)</addressed-by>
          <rationale>FPT_TUD_EXT.4 helps mitigate the threat of a malicious app by preventing the execution of untrusted updates.</rationale>
          <addressed-by>FPT_TUD_EXT.5 (Objective)</addressed-by>
          <rationale>FPT_TUD_EXT.5 helps mitigate the threat of a malicious app by enforcing installation of only trusted mobile application software.</rationale>
          <addressed-by>FPT_TUD_EXT.6 (Objective)</addressed-by>
          <rationale>FPT_TUD_EXT.6 helps mitigate the threat of a malicious app by preventing intentional rollback of software updates.</rationale>
        </threat>
        <threat name="T.NETWORK_ATTACK">
          <description> An attacker is positioned on a wireless communications channel or elsewhere            on the network infrastructure. Attackers may initiate communications with the Mobile            Device or alter communications between the Mobile Device and other endpoints in order to            compromise the Mobile Device. These attacks include malicious software update of any            applications or system software on the device. These attacks also include malicious web            pages or email attachments, which are usually delivered to devices over the            network.</description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FAU_GEN.1</addressed-by>
          <rationale>FAU_GEN.1 helps mitigate the threat of a network attack by maintaining an audit trail of potential malicious activity.</rationale>
          <addressed-by>FAU_SAR.1</addressed-by>
          <rationale>FAU_SAR.1 helps mitigate the threat of a network attack by providing a mechanism to read the audit trail.</rationale>
          <addressed-by>FAU_SEL.1 (Objective)</addressed-by>
          <rationale>FAU_SEL.1 helps mitigate the threat of a network attack by allowing the TSF to determine the behavior that indicates potential malicious activity in the audit trail.</rationale>
          <addressed-by>FAU_STG.2</addressed-by>
          <rationale>FAU_STG.2 helps mitigate the threat of a network attack by maintaining the availability of the audit trail.</rationale>
          <addressed-by>FAU_STG.5</addressed-by>
          <rationale>FAU_STG.5 helps mitigate the threat of a network attack by maintaining the availability of the audit trail.</rationale>
          <addressed-by>FCS_CKM_EXT.6</addressed-by>
          <rationale>FCS_CKM_EXT.6 helps mitigate the threat of network eavesdrop by using salts using where appropriate for cryptographic functions.</rationale>
          <addressed-by>FCS_CKM_EXT.7/UNLOCKED (Implementation-based)</addressed-by>
          <rationale>FCS_CKM_EXT.7/UNLOCKED helps mitigate the threat of a network attack by performing key establishment for trusted communications.</rationale>
          <addressed-by>FCS_CKM.1/AKG</addressed-by>
          <rationale>FCS_CKM.1/AKG helps mitigate the threat of a network attack by ensuring the generation of strong keys used for trusted communications.</rationale>
          <addressed-by>FCS_CKM.1/SKG</addressed-by>
          <rationale>FCS_CKM.1/SKG helps mitigate the threat of a network attack by ensuring the generation of strong keys used for trusted communications.</rationale>
          <addressed-by>FCS_CKM.2</addressed-by>
          <rationale>FCS_CKM.2 helps mitigate the threat of a network attack by implementing secure methods to perform key distribution for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/AEAD</addressed-by>
          <rationale>FCS_COP.1/AEAD mitigates the threat of network attack by enforcing the use of secure authenticated encryption algorithms when wireless functionality is implemented by the TOE.</rationale>
          <addressed-by>FCS_COP.1/Hash</addressed-by>
          <rationale>FCS_COP.1/Hash helps mitigate the threat of a network attack by ensuring that secure hash algorithms are used for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/KeyedHash</addressed-by>
          <rationale>FCS_COP.1/KeyedHash helps mitigate the threat of a network attack by ensuring that secure HMAC algorithms are used for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/SigGen</addressed-by>
          <rationale>FCS_COP.1/SigGen helps mitigate the threat of a network attack by ensuring that secure digital signature algorithms are used for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/SigVer</addressed-by>
          <rationale>FCS_COP.1/SigVer helps mitigate the threat of a network attack by ensuring that secure digital signature algorithms are used for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/SKC (Selection-based)</addressed-by>
          <rationale>FCS_COP.1/SKC helps mitigate the threat of a network attack by ensuring that secure symmetric algorithms are used for trusted communications.</rationale>
          <addressed-by>FCS_HTTPS_EXT.1</addressed-by>
          <rationale>FCS_HTTPS_EXT.1 helps mitigate the threat of a network attack by implementing a secure protocol (HTTPS) for trusted communications.</rationale>
          <addressed-by>FCS_RBG_EXT.2 (Objective)</addressed-by>
          <rationale>FCS_RBG_EXT.2 helps mitigate the threat of a network attack by ensuring the DRBG state at power-off and startup remains the same.</rationale>
          <addressed-by>FCS_RBG.1</addressed-by>
          <rationale>FCS_RBG.1 helps mitigate the threat of a network attack by ensuring that keys used for trusted communications are generated using a secure DRBG.</rationale>
          <addressed-by>FCS_RBG.2 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.2 helps mitigate the threat of network eavesdrop by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.3 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.3 helps mitigate the threat of a network attack by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.4 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.4 helps mitigate the threat of a network attack by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.5 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.5 helps mitigate the threat of a network attack by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.6</addressed-by>
          <rationale>FCS_RBG.6 helps mitigate the threat of a network attack by providing a secure DRBG service for third-party applications running on the TOE which may use this service to generate their own cryptographic keys for trusted communications.</rationale>
          <addressed-by>FCS_SRV_EXT.1</addressed-by>
          <rationale>FCS_SRV_EXT.1 helps mitigate the threat of a network attack by ensuring applications have the proper mechanism to perform cryptographic operations.</rationale>
          <addressed-by>FCS_SRV_EXT.2 (Objective)</addressed-by>
          <rationale>FCS_SRV_EXT.2 helps mitigate the threat of a network attack by ensuring applications have the proper mechanism to perform cryptographic operations with keys in secure storage.</rationale>
          <addressed-by>FDP_BLT_EXT.1 (Objective)</addressed-by>
          <rationale>FDP_BLT_EXT.1 helps mitigate the threat of a network attack by managing which applications communicate with Bluetooth devices.</rationale>
          <addressed-by>FDP_IFC_EXT.1</addressed-by>
          <rationale>FDP_IFC_EXT.1 helps mitigate the threat of a network attack by ensuring that the TOE has the ability to enforce the use of an IPsec VPN for all network traffic.</rationale>
          <addressed-by>FDP_STG_EXT.1</addressed-by>
          <rationale>FDP_STG_EXT.1 helps mitigate the threat of network eavesdrop by protecting the X.509 certificates used for trusted communications.</rationale>
          <addressed-by>FDP_UPC_EXT.1/APPS</addressed-by>
          <rationale>FDP_UPC_EXT.1/APPS helps mitigate the threat of network eavesdrop by implementing a means for applications to communicate securely via a trusted channel.</rationale>
          <addressed-by>FDP_UPC_EXT.1/BLUETOOTH (Implementation-based)</addressed-by>
          <rationale>FDP_UPC_EXT.1/BLUETOOTH helps mitigate the threat of a network attack by protecting communication channels using Bluetooth functionality via a trusted channel.</rationale>
          <addressed-by>FMT_MOF_EXT.1</addressed-by>
          <rationale>FMT_MOF_EXT.1 helps mitigate the threat of a network attack by limiting the management functions that are available to a given user.</rationale>
          <addressed-by>FMT_SMF_EXT.1</addressed-by>
          <rationale>FMT_SMF_EXT.1 helps mitigate the threat of a network attack by providing a list of specific management functions.</rationale>
          <addressed-by>FMT_SMF_EXT.2</addressed-by>
          <rationale>FMT_SMF_EXT.2 helps mitigate the threat of a network attack by specifying the remediation actions allowed upon enrollment.</rationale>
          <addressed-by>FPT_BLT_EXT.1 (Objective)</addressed-by>
          <rationale>FPT_BLT_EXT.1 helps mitigate the threat of a network attack by enforcing least functionality of the TOE's Bluetooth interface.</rationale>
          <addressed-by>FPT_FLS.1</addressed-by>
          <rationale>FPT_FLS.1 helps mitigate the threat of a network attack by ensuring that a malfunctioning DRBG function cannot be used to generate potentially insecure keys.</rationale>
          <addressed-by>FPT_STM.1</addressed-by>
          <rationale>FPT_STM.1 helps mitigate the threat of a malicious app by providing reliable time stamps for the audit trail.</rationale>
          <addressed-by>FPT_TST.1</addressed-by>
          <rationale>FPT_TST.1 helps mitigate the threat of a network attack by implementing a mechanism to detect when the DRBG may be failing to generate secure cryptographic keys.</rationale>
          <addressed-by>FTA_SSL_EXT.1</addressed-by>
          <rationale>FTA_SSL_EXT.1 helps mitigate the threat of a network attack by managing the transition to a locked state after a set time or operation.</rationale>
          <addressed-by>FTA_TAB.1</addressed-by>
          <rationale>FTA_TAB.1 helps mitigate the threat of a network attack by providing actionable consequences for misuse of the TSF.</rationale>
          <addressed-by>FTP_ITC_EXT.1</addressed-by>
          <rationale>FTP_ITC_EXT.1 helps mitigate the threat of a network attack by requiring the TSF to implement trusted protocols for network communication.</rationale>
        </threat>
        <threat name="T.NETWORK_EAVESDROP">
          <description> An attacker is positioned on a wireless communications channel or elsewhere            on the network infrastructure. Attackers may monitor and gain access to data exchanged            between the Mobile Device and other endpoints, resulting in            modification or disclosure of sensitive communications. </description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FCS_CKM_EXT.6</addressed-by>
          <rationale>FCS_CKM_EXT.6 helps mitigate the threat of network eavesdrop by using salts using where appropriate for cryptographic functions.</rationale>
          <addressed-by>FCS_CKM_EXT.7/UNLOCKED (Implementation-based)</addressed-by>
          <rationale>FCS_CKM_EXT.7/UNLOCKED helps mitigate the threat of network eavesdrop by performing key establishment for trusted communications.</rationale>
          <addressed-by>FCS_CKM.1/AKG</addressed-by>
          <rationale>FCS_CKM.1/AKG helps mitigate the threat of network eavesdrop by ensuring the generation of strong keys used for trusted communications.</rationale>
          <addressed-by>FCS_CKM.1/SKG</addressed-by>
          <rationale>FCS_CKM.1/SKG helps mitigate the threat of network eavesdrop by ensuring the generation of strong keys used for trusted communications.</rationale>
          <addressed-by>FCS_CKM.2</addressed-by>
          <rationale>FCS_CKM.2 helps mitigate the threat of a network eavesdrop by implementing secure methods to perform key distribution for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/AEAD</addressed-by>
          <rationale>FCS_COP.1/AEAD mitigates the threat of network eavesdrop by enforcing the use of a cryptographic algorithm to protect data in transit that includes assurance of both authenticity and confidentiality.</rationale>
          <addressed-by>FCS_COP.1/Hash</addressed-by>
          <rationale>FCS_COP.1/Hash helps mitigate the threat of network eavesdrop by ensuring that secure hash algorithms are used for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/KeyedHash</addressed-by>
          <rationale>FCS_COP.1/KeyedHash helps mitigate the threat of a network eavesdrop by ensuring that secure HMAC algorithms are used for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/SigGen</addressed-by>
          <rationale>FCS_COP.1/SigGen helps mitigate the threat of network eavesdrop by ensuring that secure digital signature algorithms are used for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/SigVer</addressed-by>
          <rationale>FCS_COP.1/SigVer helps mitigate the threat of network eavesdrop by ensuring that secure digital signature algorithms are used for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/SKC (Selection-based)</addressed-by>
          <rationale>FCS_COP.1/SKC helps mitigate the threat of network eavesdrop by ensuring that secure symmetric algorithms are used for trusted communications.</rationale>
          <addressed-by>FCS_HTTPS_EXT.1</addressed-by>
          <rationale>FCS_HTTPS_EXT.1 helps mitigate the threat of network eavesdrop by implementing a secure protocol (HTTPS) for trusted communications.</rationale>
          <addressed-by>FCS_RBG_EXT.2 (Objective)</addressed-by>
          <rationale>FCS_RBG_EXT.2 helps mitigate the threat of network eavesdrop by defining requirements for secure DRBG implementation.</rationale>
          <addressed-by>FCS_RBG_EXT.3 (Objective)</addressed-by>
          <rationale>FCS_RBG_EXT.3 helps mitigate the threat of network eavesdrop by defining requirements for secure DRBG implementation.</rationale>
          <addressed-by>FCS_RBG.2 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.2 helps mitigate the threat of network eavesdrop by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.3 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.3 helps mitigate the threat of network eavesdrop by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.4 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.4 helps mitigate the threat of network eavesdrop by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.5 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.5 helps mitigate the threat of network eavesdrop by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.6</addressed-by>
          <rationale>FCS_RBG.6 helps mitigate the threat of a network eavesdrop by providing a secure DRBG service for third-party applications running on the TOE which may use this service to generate their own cryptographic keys for trusted communications.</rationale>
          <addressed-by>FCS_SRV_EXT.1</addressed-by>
          <rationale>FCS_SRV_EXT.1 helps mitigate the threat of network eavesdrop by ensuring applications have the proper mechanism to perform cryptographic operations.</rationale>
          <addressed-by>FDP_BLT_EXT.1 (Objective)</addressed-by>
          <rationale>FDP_BLT_EXT.1 helps mitigate the threat of network eavesdrop by managing which applications communicate with Bluetooth devices.</rationale>
          <addressed-by>FDP_IFC_EXT.1</addressed-by>
          <rationale>FDP_IFC_EXT.1 helps mitigate the threat of network eavesdrop by ensuring that the TOE has the ability to enforce the use of an IPsec VPN for all network traffic.</rationale>
          <addressed-by>FDP_STG_EXT.1</addressed-by>
          <rationale>FDP_STG_EXT.1 helps mitigate the threat of network eavesdrop by protecting the X.509 certificates used for trusted communications.</rationale>
          <addressed-by>FDP_UPC_EXT.1/APPS</addressed-by>
          <rationale>FDP_UPC_EXT.1/APPS helps mitigate the threat of network eavesdrop by implementing a means for applications to communicate securely via a trusted channel.</rationale>
          <addressed-by>FDP_UPC_EXT.1/BLUETOOTH (Implementation-based)</addressed-by>
          <rationale>FDP_UPC_EXT.1/BLUETOOTH helps mitigate the threat of network eavesdrop by protecting communication channels using Bluetooth functionality via a trusted channel.</rationale>
          <addressed-by>FIA_X509_EXT.6</addressed-by>
          <rationale>FIA_X509_EXT.6 helps mitigate the threat of network eavesdrop by defining a secure mechanism by which the TSF can acquire certificates for its own use.</rationale>
          <addressed-by>FPT_BLT_EXT.1 (Objective)</addressed-by>
          <rationale>FPT_BLT_EXT.1 helps mitigate the threat of network eavesdrop by enforcing least functionality of the TOE's Bluetooth interface.</rationale>
          <addressed-by>FPT_FLS.1</addressed-by>
          <rationale>FPT_FLS.1 helps mitigate the threat of network eavesdrop by ensuring that a malfunctioning DRBG function cannot be used to generate potentially insecure keys.</rationale>
          <addressed-by>FPT_TST.1</addressed-by>
          <rationale>FPT_TST.1 helps mitigate the threat of network eavesdrop by implementing a mechanism to detect when the DRBG may be failing to generate secure cryptographic keys.</rationale>
          <addressed-by>FTP_ITC_EXT.1</addressed-by>
          <rationale>FTP_ITC_EXT.1 helps mitigate the threat of network eavesdrop by requiring the TSF to implement trusted protocols for network communication.</rationale>
        </threat>
        <threat name="T.PERSISTENT_PRESENCE">
          <description> Persistent presence on a device by an attacker implies that the device has            lost integrity and cannot regain it. The device has likely lost this integrity due to            some other threat vector, yet the continued access by an attacker constitutes an            on-going threat in itself. In this case, the device and its data may be controlled by an            adversary as well as by its legitimate owner.</description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FMT_MOF_EXT.1</addressed-by>
          <rationale>FMT_MOF_EXT.1 helps mitigate the threat of persistent presence by enforcing limitations on TSF usage when it is enrolled in mobile device management.</rationale>
          <addressed-by>FMT_SMF_EXT.1</addressed-by>
          <rationale>FMT_SMF_EXT.1 helps mitigate the threat of persistent presence by defining the management functions that are supported by the TOE.</rationale>
          <addressed-by>FMT_SMF_EXT.2</addressed-by>
          <rationale>FMT_SMF_EXT.2 helps mitigate the threat of persistent presence by maintaining a secure state of the TOE if it is unenrolled from mobile device management.</rationale>
          <addressed-by>FPT_NOT_EXT.1</addressed-by>
          <rationale>FPT_NOT_EXT.1 helps mitigate the threat of persistent presence by having the TOE enter a secure failure state when self-test integrity failures occur.</rationale>
          <addressed-by>FPT_TST_EXT.1</addressed-by>
          <rationale>FPT_TST_EXT.1 helps mitigate the threat of a persistent presence by performing self-tests to verify the integrity of the TSF.</rationale>
          <addressed-by>FPT_TST_EXT.2/PREKERNEL</addressed-by>
          <rationale>FPT_TST_EXT.2/PREKERNEL  helps mitigate the threat of a persistent presence by performing self-tests to verify the integrity of the TSF.</rationale>
          <addressed-by>FPT_TST_EXT.3 (Selection-based)</addressed-by>
          <rationale>FPT_TST_EXT.3 helps mitigate the threat of a persistent presence by preventing the execution of untrusted application code.</rationale>
          <addressed-by>FPT_TUD_EXT.2</addressed-by>
          <rationale>FPT_TUD_EXT.2 helps mitigate the threat of a persistent presence by ensuring that only legitimate updates are applied to the TOE.</rationale>
          <addressed-by>FPT_TUD_EXT.3</addressed-by>
          <rationale>FPT_TUD_EXT.3 helps mitigate the threat of a persistent presence by ensuring mobile application software updates are digitally signed prior to installation.</rationale>
          <addressed-by>FPT_TUD_EXT.4 (Selection-based)</addressed-by>
          <rationale>FPT_TUD_EXT.4 helps mitigate the threat of a persistent presence by preventing the execution of untrusted updates.</rationale>
          <addressed-by>FPT_TUD_EXT.5 (Objective)</addressed-by>
          <rationale>FPT_TUD_EXT.5 helps mitigate the threat of a persistent presence by enforcing mobile application software verification by X.509v3 prior to installation.</rationale>
          <addressed-by>FPT_TUD_EXT.6 (Objective)</addressed-by>
          <rationale>FPT_TUD_EXT.6 helps mitigate the threat of a persistent presence by preventing intentional rollback of software updates.</rationale>
        </threat>
        <threat name="T.PHYSICAL_ACCESS">
          <description> An attacker, with physical access, may attempt to access user data on the            Mobile Device including credentials. These physical access threats may involve attacks,            which attempt to access the device through external hardware ports, impersonate the user            authentication mechanisms, through its user interface, and also through direct and            possibly destructive access to its storage media. Note: Defending against device re-use            after physical compromise is out of scope for this Protection Profile.</description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FCS_CKM_EXT.1</addressed-by>
          <rationale>FCS_CKM_EXT.1 helps mitigate the threat of physical access by implementing a method of protecting data at rest while the TOE is in a locked state.</rationale>
          <addressed-by>FCS_CKM_EXT.3</addressed-by>
          <rationale>FCS_CKM_EXT.3 helps mitigate the threat of physical access by implementing a method of protecting data at rest while the TOE is in a locked state.</rationale>
          <addressed-by>FCS_CKM_EXT.5</addressed-by>
          <rationale>FCS_CKM_EXT.5 helps mitigate the threat of physical access by implementing a secure mechanism to erase protected data from the TOE.</rationale>
          <addressed-by>FCS_CKM_EXT.6</addressed-by>
          <rationale>FCS_CKM_EXT.6 helps mitigate the threat of physical access by generating salts using RBG.</rationale>
          <addressed-by>FCS_CKM_EXT.7/LOCKED</addressed-by>
          <rationale>FCS_CKM_EXT.7/LOCKED helps mitigate the threat of physical access by implementing a method of protecting data at rest while the TOE is in a locked state.</rationale>
          <addressed-by>FCS_CKM_EXT.7/UNLOCKED (Implementation-based)</addressed-by>
          <rationale>FCS_CKM_EXT.7/UNLOCKED helps mitigate the threat of physical access by implementing a method of protecting data at rest while the TOE is in a locked state.</rationale>
          <addressed-by>FCS_CKM_EXT.8</addressed-by>
          <rationale>FCS_CKM_EXT.8 helps mitigate the threat of physical access by performing password conditioning to increase the difficulty of deriving a key from a password.</rationale>
          <addressed-by>FCS_CKM.2</addressed-by>
          <rationale>FCS_CKM.2 helps mitigate the threat of physical access by implementing secure methods to perform key distribution for trusted communications.</rationale>
          <addressed-by>FCS_CKM.6</addressed-by>
          <rationale>FCS_CKM.6 helps mitigate the threat of physical access by ensuring that keys used for trusted communications are destroyed in a secure manner.</rationale>
          <addressed-by>FCS_COP.1/Hash</addressed-by>
          <rationale>FCS_COP.1/Hash helps mitigate the threat of physical access by implementing an integrity mechanism used to verify stored keys.</rationale>
          <addressed-by>FCS_COP.1/KeyedHash</addressed-by>
          <rationale>FCS_COP.1/KeyedHash helps mitigate the threat of physical access by implementing an integrity mechanism used to verify stored keys.</rationale>
          <addressed-by>FCS_IV_EXT.1</addressed-by>
          <rationale>FCS_IV_EXT.1 helps mitigate the threat of physical access by ensuring that appropriate IVs are used for symmetric keys.</rationale>
          <addressed-by>FCS_RBG.1</addressed-by>
          <rationale>FCS_RBG.1 helps mitigate the threat of physical access by ensuring that keys used for protected storage are generated using a secure DRBG.</rationale>
          <addressed-by>FCS_RBG.2 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.2 helps mitigate the threat of network eavesdrop by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.3 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.3 helps mitigate the threat of physical access by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.4 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.4 helps mitigate the threat of physical access by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.5 (Selection-based)</addressed-by>
          <rationale>FCS_RBG.5 helps mitigate the threat of physical access by ensuring that the TOE's DRBG is seeded with sufficient entropy to ensure the generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_STG_EXT.1</addressed-by>
          <rationale>FCS_STG_EXT.1 helps mitigate the threat of physical access by implementing a secure key storage for keys used to protect data at rest.</rationale>
          <addressed-by>FCS_STG_EXT.2</addressed-by>
          <rationale>FCS_STG_EXT.2 helps mitigate the threat of physical access by enforcing confidentiality for key storage.</rationale>
          <addressed-by>FCS_STG_EXT.3</addressed-by>
          <rationale>FCS_STG_EXT.3 helps mitigate the threat of physical access by enforcing integrity for key storage.</rationale>
          <addressed-by>FDP_DAR_EXT.1</addressed-by>
          <rationale>FDP_DAR_EXT.1 helps mitigate the threat of physical access by encrypting sensitive data at rest.</rationale>
          <addressed-by>FDP_DAR_EXT.2</addressed-by>
          <rationale>FDP_DAR_EXT.2 helps mitigate the threat of physical access by allowing data to be marked as sensitive such that it is encrypted while at rest.</rationale>
          <addressed-by>FIA_AFL_EXT.1</addressed-by>
          <rationale>FIA_AFL_EXT.1 helps mitigate the threat of physical access by limiting the extent to which brute force authentication attempts to the TOE can be made.</rationale>
          <addressed-by>FIA_PMG_EXT.1</addressed-by>
          <rationale>FIA_PMG_EXT.1 helps mitigate the threat of physical access by defining strong password characteristics.</rationale>
          <addressed-by>FIA_TRT_EXT.1</addressed-by>
          <rationale>FIA_AFL_EXT.1 helps mitigate the threat of physical access by limiting the extent to which brute force authentication attempts to the TOE can be made.</rationale>
          <addressed-by>FIA_UAU_EXT.1</addressed-by>
          <rationale>FIA_UAU_EXT.1 helps mitigate the threat of physical access by preventing decryption prior to proper authorization to the device.</rationale>
          <addressed-by>FIA_UAU_EXT.2</addressed-by>
          <rationale>FIA_UAU_EXT.2 helps mitigate the threat of physical access by requiring successful authentication before allowing the user to take action on the TOE.</rationale>
          <addressed-by>FIA_UAU_EXT.4 (Optional)</addressed-by>
          <rationale>FIA_UAU_EXT.4 helps mitigate the threat of physical access by enforcing a secondary authentication mechanism for accessing enterprise resources.</rationale>
          <addressed-by>FIA_UAU.5</addressed-by>
          <rationale>FIA_UAU.5 helps mitigate the threat of physical access by defining the supported authentication mechanisms.</rationale>
          <addressed-by>FIA_UAU.6/CREDENTIAL</addressed-by>
          <rationale>FIA_UAU.6/CREDENTIAL helps mitigate the threat of physical access by implementing functionality to require re-authentication before any attempted changes 
            to authenticated mechanisms.</rationale>
          <addressed-by>FIA_UAU.6/LOCKED</addressed-by>
          <rationale>FIA_UAU.6/LOCKED helps mitigate the threat of physical access by implementing functionality to require re-authentication in certain conditions.</rationale>
          <addressed-by>FIA_UAU.7</addressed-by>
          <rationale>FIA_UAU.7 helps mitigate the threat of physical access by providing only limited information during authentication.</rationale>
          <addressed-by>FPT_FLS.1</addressed-by>
          <rationale>FPT_FLS.1 helps mitigate the threat of physical access by ensuring that a malfunctioning DRBG function cannot be used to generate potentially insecure keys.</rationale>
          <addressed-by>FPT_JTA_EXT.1</addressed-by>
          <rationale>FPT_JTA_EXT.1 helps mitigate the threat of physical access by specifying the mechanism used to control access to JTAG.</rationale>
          <addressed-by>FPT_KST_EXT.1</addressed-by>
          <rationale>FPT_KST_EXT.1 helps mitigate the threat of physical access by ensuring plaintext key material is not stored in readable non-volatile memory.</rationale>
          <addressed-by>FPT_KST_EXT.2</addressed-by>
          <rationale>FPT_KST_EXT.2 helps mitigate the threat of physical access by preventing transmission of plaintext key material outside the secure boundary of the TOE.</rationale>
          <addressed-by>FPT_KST_EXT.3</addressed-by>
          <rationale>FPT_KST_EXT.3 helps mitigate the threat of physical access by ensuring TOE users cannot export plaintext keys.</rationale>
          <addressed-by>FPT_TST.1</addressed-by>
          <rationale>FPT_TST.1 helps mitigate the threat of physical access by implementing a mechanism to detect when the DRBG may be failing to generate secure cryptographic keys.</rationale>
          <addressed-by>FTA_SSL_EXT.1</addressed-by>
          <rationale>FTA_SSL_EXT.1 helps mitigate the threat of physical access by managing the transition to a locked state after a set time or operation.</rationale>
        </threat>
      </threats>
    </sec:Threats>
    <!-- 3.2 Assumptions -->
    <sec:Assumptions>
      The specific conditions listed below are assumed to
      exist in the TOE’s Operational Environment. These include both practical realities in the
      development of the TOE security requirements and the essential environmental conditions on the
      use of the TOE.
      <assumptions>
        <assumption name="A.CONFIG">
          <description>It is assumed that the TOE’s security functions are configured correctly in a
            manner to ensure that the TOE security policies will be enforced on all applicable
            network traffic flowing among the attached networks.</description>
          <objective-refer ref="OE.CONFIG">
            <rationale>The operational environment objective OE.CONFIG is realized through A.CONFIG.</rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.NOTIFY">
          <description>It is assumed that the mobile user will immediately notify the administrator
            if the Mobile Device is lost or stolen.</description>
          <objective-refer ref="OE.NOTIFY">
            <rationale>The operational environment objective OE.NOTIFY is realized through A.NOTIFY.</rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PRECAUTION">
          <description>It is assumed that the mobile user exercises precautions to reduce the risk
            of loss or theft of the Mobile Device.</description>
          <objective-refer ref="OE.PRECAUTION">
            <rationale>The operational environment objective OE.PRECAUTION is realized through
              A.PRECAUTION.</rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PROPER_USER">
          <description>Mobile Device users are not willfully negligent or hostile, and use the
            device within compliance of a reasonable Enterprise security policy.</description>
          <objective-refer ref="OE.DATA_PROPER_USER">
            <rationale>The operational environment objective OE.DATA_PROPER_USER is realized through
              A.PROPER_USER.</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </sec:Assumptions>
    <!-- 3.3 Organizational Security Policies -->
    <sec:Organizational_Security_Policies>
      <OSPs/>
    </sec:Organizational_Security_Policies>
  </sec:Security_Problem_Definition>
  <!-- 4.0 Security Objectives -->
  <sec:Security_Objectives>
    <!-- 4.1 Security Objectives for the TOE -->
    <!-- 4.2 Security Objctives for the Operational Environment -->
    <section title="Security Objectives for the Operational Environment" id="sooe">
      The following security objectives for the operational environment assist the OS in correctly providing its security functionality. These track with the assumptions about the environment.
      <SOEs>
        <SOE name="OE.CONFIG">
          <description>TOE administrators will configure the Mobile Device security functions
            correctly to create the intended security policy</description>
        </SOE>
        <SOE name="OE.DATA_PROPER_USER">
          <description>Administrators take measures to ensure that mobile device users are adequately vetted against malicious intent and are made aware of the expectations for appropriate use of the device.</description>
        </SOE>
        <SOE name="OE.NOTIFY">
          <description>The Mobile User will immediately notify the administrator if the Mobile
            Device is lost or stolen.</description>
        </SOE>
        <SOE name="OE.PRECAUTION">
          <description>The mobile device user exercises precautions to reduce the risk of loss or theft of
            the Mobile Device.</description>
        </SOE>
      </SOEs>
    </section>
    <!-- 4.3 Security Objectives Rationale -->
    <sec:Security_Objectives_Rationale/>
  </sec:Security_Objectives>
  <!-- 5.0 Security Requirements -->
  <sec:req title="Security Requirements">
    <!-- 5.1 Security Functional Requirements-->
    <sec:SFRs title="Security Functional Requirements">
      <section id="ss-audit-table" title="Auditable Events for Mandatory SFRs">
        <audit-table id="t-audit-mandatory" table="mandatory"/>
      </section>
      <!-- 5.1.1 Class: Security Audit (FAU) -->
      <section id="fau" title="Class: Security Audit (FAU)">
        <!-- FAU_GEN.1 Audit Data Generation -->
        <f-component cc-id="fau_gen.1" id="fau-gen-1" name="Audit Data Generation">
          <f-element id="fel-audit-gen">
            <title>The TSF shall be able to generate audit data of the following auditable events:<h:br/><h:ul><h:li>Start-up and shutdown of the audit functions</h:li> <h:li>All auditable events for the [<h:i>not specified</h:i>] level of audit</h:li>
                [<h:li><h:i>All administrative actions</h:i></h:li> <h:li><h:i>Start-up and shutdown of the OS</h:i></h:li> <h:li><h:i>Insertion or removal of removable media</h:i></h:li> <h:li><h:i>Specifically defined auditable events in <xref g="t-audit-mandatory"/></h:i></h:li> <h:li>Auditable events as defined in the <xref to="tls"/>;</h:li> <h:li>Auditable events as defined in the <xref to="X509"/>;</h:li> <h:li><h:i> <selectables><selectable id="fau_gen.1.1_1">Audit data reaching <assignable>integer value less than 100</assignable> percent of audit capacity</selectable><selectable id="fau_gen.1.1_3">Auditable events defined in <xref g="t-audit-objective"/> for Objective SFRs</selectable><selectable id="fau_gen.1.1_4">Auditable events defined in <xref g="t-audit-impl-dep"/> for Implementation-Dependent SFRs</selectable><selectable id="fau_gen.1.1_5">Auditable events defined in <xref g="t-audit-sel-based"/> for Selection-Based SFRs</selectable><selectable id="fau_gen.1.1_6" exclusive="yes">no additional auditable events</selectable></selectables>]</h:i></h:li></h:ul></title>
            <note role="application">
              Administrator actions are defined as functions labeled as
              mandatory for FMT_MOF_EXT.1.2 (i.e. ‘M-MM’ in
              <xref to="fmt_smf"/>). If the TSF
              does not support removable media, number 4 is implicitly met.
              <h:br/>
              <h:br/>
              The
              TSF must generate audit data for all events contained in
              <xref g="t-audit-mandatory"/>. For all other audit tables (i.e., tables for non-mandatory SFRs and references to functional packages), the ST author includes the audit events (if any) for the SFRs that are claimed in the ST.
              <h:br/>
              <h:br/>
              <h:b><xref g="t-audit-mandatory"/> Application Note:</h:b>
              <h:br/>
              FPT_TST_EXT.1 –
              Audit of self-tests is required only at initial start-up. Since the TOE "transitions
              to non-operational mode" upon failure of a self-test, per FPT_NOT_EXT.1, this is
              considered equivalent evidence to audit data for the failure of a self-test.
              <h:br/>
              <h:br/>
              FDP_DAR_EXT.1 - "None" must be selected, if the TOE utilizes whole
              volume encryption for protected data, since it is not feasible to audit when the
              encryption/decryption fails. If the TOE utilizes file-based encryption for protected
              data and audits when this encryption/decryption fails, then that auditable event should
              be selected.
              <h:br/>
              <h:br/>
              For FMT_SMF_EXT.1, it is acceptable
              for the initiation of the software update to be audited without indicating the outcome
              (success or failure) of the update.
              <h:br/>
            </note>
          </f-element>
          <f-element id="fel-audit-what">
            <title>The TSF shall record within the audit data at least the following information: <h:ul><h:li>Date and time of the event</h:li> <h:li>Type of event</h:li> <h:li>Subject identity</h:li> <h:li>The outcome (success or failure) of the event</h:li><h:b><h:li>Additional information in <xref g="t-audit-mandatory"/></h:li> <h:li>Additional information defined in the <xref to="tls"/>;</h:li> <h:li>Additional information defined in the <xref to="X509"/>;</h:li> <h:li> <selectables><selectable id="fau_gen.1.2_1">Additional information defined in <xref g="t-audit-objective"/> for Objective SFRs</selectable><selectable id="fau_gen.1.2_2">Additional information defined in <xref g="t-audit-impl-dep"/> for Implementation-Dependent SFRs</selectable><selectable id="fau_gen.1.2_3">Additional information defined in <xref g="t-audit-sel-based"/> for Selection-Based SFRs</selectable><selectable id="fau_gen.1.2_4" exclusive="yes">no additional information</selectable></selectables></h:li></h:b></h:ul></title>
            <note role="application">
              The subject identity is usually the process name/ID. The event
              type is often indicated by a severity level, for example, ‘info’, ‘warning’, or
              ‘error’.
              <h:br/>
              <h:br/>
              <h:br/>
              <h:br/>
              For each audit event selected from
              <xref to="t-audit-additional"/>
              in
              FAU_GEN.1.1 if additional information is required to be recorded within the audit
              data, it should be included in this selection.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall check the TSS and ensure that it lists all of the auditable
                events and provides a format for audit data. Each audit data format type must
                be covered, along with a brief description of each field. The evaluator shall check
                to make sure that every audit event type mandated by the PP is described and that
                the description of the fields contains the information required in FAU_GEN.1.2.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall also make a determination of the administrative actions
                that are relevant in the context of this PP including those listed in the Management
                section. The evaluator shall examine the administrative guide and make a
                determination of which administrative commands are related to the configuration
                (including enabling or disabling) of the mechanisms implemented in the TOE that are
                necessary to enforce the requirements specified in the PP. The evaluator shall
                document the methodology or approach taken while determining which actions in the
                administrative guide are security relevant with respect to this PP. The evaluator
                may perform this activity as part of the activities associated with ensuring the
                AGD_OPE guidance satisfies the requirements.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>The evaluator shall test the TOE’s ability to correctly generate audit data by having the TOE generate audit data for the events listed in the provided table and administrative actions. This should include all instances of an event. The evaluator shall test that audit data are generated for the establishment and termination of a channel for each of the cryptographic protocols contained in the ST. For administrative actions, the evaluator shall test that each action determined by the evaluator above to be security relevant in the context of this PP is auditable. When verifying the test results, the evaluator shall ensure the audit data generated during testing match the format specified in the administrative guide, and that the fields specified in FAU_GEN.1.2 are contained in the audit data. <h:br/> <h:br/>Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly. For example, testing performed to ensure that the administrative guidance provided is correct verifies that AGD_OPE.1 is satisfied and should address the invocation of the administrative actions that are needed to verify the audit data are generated as expected. <h:br/> <h:br/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FAU_SAR.1 Audit Review -->
        <f-component cc-id="fau_sar.1" id="fau-sar-1" name="Audit Review">
          <f-element id="fau-sar-1e1">
            <title>
              The TSF shall provide [<h:i>the administrator</h:i>] with the
              capability to read [<h:i>all audited events and data contents</h:i>]
              from the audit data.
            </title>
            <note role="application">
              The administrator must have access to read the audit data,
              perhaps through an API or via an MDM Agent, which transfers the local records stored
              on the TOE to the MDM Server where the enterprise administrator may view them. If this
              requirement is included in the ST, function
              <xref to="mf-auditLogs"/>
              must be
              included in the selection of FMT_SMF_EXT.1.
            </note>
          </f-element>
          <f-element id="fel-audit-provide">
            <title>The TSF shall provide the audit data in a manner suitable for the user to interpret the information.</title>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>The evaluation activity for this requirement is performed in conjunction with test for function <xref to="mf-auditLogs"/> of FMT_SMF_EXT.1.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FAU_SEL.1 Selective Audit -->
        <f-component cc-id="fau_sel.1" id="fau-sel-1" name="Selective Audit" status="objective">
          <f-element id="fel-audit-select">
            <title>
              The TSF shall be able to select the set of events to be audited from the set of
              all auditable events based on the following attributes
              <h:ol type="a">
                <h:li>[<h:i>event type</h:i>]</h:li>
                <h:li>[<h:i>success of auditable security events</h:i></h:li>
                <h:li>
                  <h:i>failure of auditable security events</h:i>
                </h:li>
                <h:li><h:i><assignable>other attributes</assignable></h:i>]</h:li>
              </h:ol>
            </title>
            <note role="application">The intent of this requirement is to identify all criteria
              that can be selected to trigger an audit event. This can be configured through an
              interface on the TSF for a user or administrator to invoke. For the ST author, the
              assignment is used to list any additional criteria or "none".</note>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>
                The evaluator shall review the administrative guidance to ensure that the
                guidance itemizes all event types, as well as describes all attributes that are to
                be selectable in accordance with the requirement, to include those attributes listed
                in the assignment. The administrative guidance shall also contain instructions on
                how to set the pre-selection as well as explain the syntax (if present) for
                multi-value pre-selection. The administrative guidance shall also identify those
                audit data that are always recorded, regardless of the selection criteria
                currently being enforced.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                The evaluator shall also perform the following tests:
                <h:br/>
                <testlist>
                  <h:br/>
                  <h:br/>
                  <test>For each attribute listed in the requirement, the evaluator shall devise a test to show that selecting the attribute causes only audit events with that attribute (or those that are always recorded, as identified in the administrative guidance) to be recorded.</test>
                  <test>[conditional] If the TSF supports specification of more complex audit pre-selection criteria (e.g., multiple attributes, logical expressions using attributes) then the evaluator shall devise tests showing that this capability is correctly implemented. The evaluator shall also, in the test plan, provide a short narrative justifying the set of tests as representative and sufficient to exercise the capability.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>All modifications to the audit configuration that occur while the audit collection functions are operating</audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FAU_STG.2 Protected Audit Data Storage -->
        <f-component cc-id="fau_stg.2" id="fau-stg-2" name="Protected Audit Data Storage">
          <f-element id="fel-audit-store">
            <title>The TSF shall protect the stored audit data in the audit trail from unauthorized deletion.</title>
          </f-element>
          <f-element id="fel-audit-mod">
            <title>
              The TSF shall be able to [<h:i>prevent</h:i>] unauthorized
              modifications to the stored audit data in the audit trail.
            </title>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS lists the location of all logs and the
                access controls of those files such that unauthorized modification and deletion are
                prevented.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall attempt to delete the audit trail in a manner that the access controls should prevent (as an unauthorized user) and shall verify that the attempt fails.</test>
                  <test>The evaluator shall attempt to modify the audit trail in a manner that the access controls should prevent (as an unauthorized application) and shall verify that the attempt fails.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FAU_STG.5 Prevention of Audit Data Loss -->
        <f-component cc-id="fau_stg.5" id="fau-stg-5" name="Prevention of Audit Data Loss">
          <f-element id="fel-audit-loss">
            <title>The TSF shall [<h:i>overwrite the oldest stored audit records</h:i>] <h:s>[assignment: other actions to be taken in case of audit storage
              failure and conditions for the actions]</h:s> if the audit data storage is full.</title>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to ensure that it describes the size limits
                on the audit records, the detection of a full audit trail, and the actions taken
                by the TSF when the audit trail is full. The evaluator shall ensure that the
                actions results in the deletion or overwrite of the oldest stored record.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </section>
      <!-- 5.1.2 Class: Cryptographic Support (FCS) -->
      <section id="fcs" title="Class: Cryptographic Support (FCS)">
        This section describes how keys are generated, derived, combined, released and destroyed. There are two major types of keys: DEKs and KEKs. (A REK is considered a KEK.)
         DEKs are used to protect data (as in the DAR protection described in FDP_DAR_EXT.1 and FDP_DAR_EXT.2). KEKs are used to protect other keys – DEKs, other KEKs, and other types of keys stored by the user or applications.
         The following diagram shows an example key hierarchy to illustrate the concepts of this profile. 
         This example is not meant as an approved design, but ST authors will be expected to provide a diagram illustrating their key hierarchy in order to demonstrate that they meet the requirements of this profile. 
         Please note if
        <xref to="uau_biometric"/>
        is selected in FIA_UAU.5.1, each BAF claimed in FIA_MBV_EXT.1.1 in the
        <xref to="mod-biometrics"/>
        shall be illustrated in the key hierarchy diagram, to include a description of when and how the BAF is used to release keys.
	 If
        <xref to="uau_hybr"/>
        is selected in FIA_UAU.5.1, meaning that a PIN or password must be used in conjunction with the BAF, this interaction shall be included.
        <h:br/>
        <figure entity="images/figure3.jpg" title="An Illustrative Key Hierarchy" id="Keys"/>
        <ext-comp-def title="Cryptographic Key Management" fam-id="FCS_CKM_EXT">
          <fam-behavior>This family defines requirements for management of cryptographic keys that are not addressed by FCS_CKM in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="HTTPS Protocol" fam-id="FCS_HTTPS_EXT">
          <fam-behavior>This family defines requirements for implementation of the HTTPS protocol.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Initialization Vector Generation" fam-id="FCS_IV_EXT">
          <fam-behavior>This family defines requirements for initialization vector generation in support of key generation.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Random Bit Generation" fam-id="FCS_RBG_EXT">
          <fam-behavior>This family defines requirements for the generation of random bits.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Cryptographic Algorithm Services" fam-id="FCS_SRV_EXT">
          <fam-behavior>This family defines requirements for the ability of the TOE to make its cryptographic operations available to non-TSF components.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Cryptographic Key Storage" fam-id="FCS_STG_EXT">
          <fam-behavior>This family defines requirements for the implementation of secure key storage with access control, confidentiality, and integrity protections.</fam-behavior>
        </ext-comp-def>
        <!-- FCS_CKM.1/AKG Cryptographic
          Key Generation - Asymmetric Key -->
        <f-component cc-id="fcs_ckm.1" id="sfr-fcs-ckm-1-akg" name="Cryptographic           Key Generation - Asymmetric Key" iteration="AKG">
          <f-element id="fel-asym-gen">
            <title>
              The TSF shall generate
              <h:b>asymmetric</h:b>
              cryptographic keys in accordance with
              a specified cryptographic key generation algorithm
              <selectables>
                <tabularize id="fcs-ckm-1-ak-sels" title="Allowable Choices for FCS_CKM.1/AKG">
                  <textcol>Identifier</textcol>
                  <selectcol>Cryptographic Key Generation Algorithm</selectcol>
                  <reqtext>and specified cryptographic <h:b>algorithm parameters</h:b> <h:s>key sizes</h:s></reqtext>
                  <selectcol>Cryptographic Algorithm Parameters</selectcol>
                  <reqtext>that meet the following: </reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_CKM.1/AKG.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-ckm-ak-rsa">
                  <col>RSA</col>
                  <col>RSA</col>
                  <col>Modulus of size <selectables><selectable id="sel-exp-ak-rsa-3072">3072</selectable><selectable id="sel-exp-ak-rsa-4096">4096</selectable><selectable id="sel-exp-ak-rsa-6144">6144</selectable><selectable id="sel-exp-ak-rsa-8192">8192</selectable></selectables> bits</col>
                  <col>NIST FIPS PUB 186-5 (Section A.1.1)</col>
                </selectable>
                <selectable id="sel-fcs-ckm-ak-ecdsa-erb">
                  <col>ECC-ERB</col>
                  <col>ECC-ERB - Extra Random Bits</col>
                  <col>Elliptic Curve <selectables><selectable id="sel-exp-ak-edcsa-erb-P384">P-384</selectable><selectable id="sel-exp-ak-edcsa-erb-P521">P-521</selectable></selectables></col>
                  <col>FIPS PUB 186-5 (Section A.2.1)<h:p/>NIST SP 800-186 (Section 3) [NIST Curves]</col>
                </selectable>
                <selectable id="sel-fcs-ckm-ak-ecdsa-rs">
                  <col>ECC-RS</col>
                  <col>ECC-RS - Rejection Sampling</col>
                  <col>Elliptic Curve <selectables><selectable id="sel-exp-ak-edcsa-rs-P384">P-384</selectable><selectable id="sel-exp-ak-edcsa-rs-P521">P-521</selectable></selectables></col>
                  <col>FIPS PUB 186-5 (Section A.2.2)<h:p/>NIST SP 800-186 (Section 3) [NIST Curves]</col>
                </selectable>
                <selectable id="sel-fcs-ckm-ak-ffc-erb">
                  <col>FFC-ERB</col>
                  <col>FFC-ERB - Extra Random Bits</col>
                  <col>Static domain parameters approved for <selectables><selectable id="fcs_ckm.1.1_AKG_1">IKE Groups <selectables><selectable id="sel-dp-ak-ffc-erb-modp3072">MODP-3072</selectable><selectable id="sel-dp-ak-ffc-erb-modp4096">MODP-4096</selectable><selectable id="sel-dp-ak-ffc-erb-modp6144">MODP-6144</selectable><selectable id="sel-dp-ak-ffc-erb-modp8192">MODP-8192</selectable></selectables> </selectable><selectable id="fcs_ckm.1.1_AKG_2">TLS Groups <selectables><selectable id="sel-dp-ak-ffc-erb-ffdhe3072">ffdhe3072</selectable><selectable id="sel-dp-ak-ffc-erb-ffdhe4096">ffdhe4096</selectable><selectable id="sel-dp-ak-ffc-erb-ffdhe6144">ffdhe6144</selectable><selectable id="sel-dp-ak-ffc-erb-ffdhe8192">ffdhe8192</selectable></selectables> </selectable></selectables></col>
                  <col>NIST SP 800-56A Revision 3 (Section 5.6.1.1.3) [key pair generation]<h:p/> <selectables><selectable id="fcs_ckm.1.1_AKG_3">RFC 3526 [IKE groups]</selectable><selectable id="fcs_ckm.1.1_AKG_4">RFC 7919 [TLS groups]</selectable></selectables></col>
                </selectable>
                <selectable id="sel-fcs-ckm-ak-ffc-rs">
                  <col>FFC-RS</col>
                  <col>FFC-RS - Extra Random Bits</col>
                  <col>Static domain parameters approved for <selectables><selectable id="fcs_ckm.1.1_AKG_5">IKE Groups <selectables><selectable id="sel-dp-ak-ffc-rs-modp3072">MODP-3072</selectable><selectable id="sel-dp-ak-ffc-rs-modp4096">MODP-4096</selectable><selectable id="sel-dp-ak-ffc-rs-modp6144">MODP-6144</selectable><selectable id="sel-dp-ak-ffc-rs-modp8192">MODP-8192</selectable></selectables> </selectable><selectable id="fcs_ckm.1.1_AKG_6">TLS Groups <selectables><selectable id="sel-dp-ak-ffc-rs-ffdhe3072">ffdhe3072</selectable><selectable id="sel-dp-ak-ffc-rs-ffdhe4096">ffdhe4096</selectable><selectable id="sel-dp-ak-ffc-rs-ffdhe6144">ffdhe6144</selectable><selectable id="sel-dp-ak-ffc-rs-ffdhe8192">ffdhe8192</selectable></selectables> </selectable></selectables></col>
                  <col>NIST SP 800-56A Revision 3 (Section 5.6.1.1.3) [key pair generation]<h:p/> <selectables><selectable id="fcs_ckm.1.1_AKG_7">RFC 3526 [IKE groups]</selectable><selectable id="fcs_ckm.1.1_AKG_8">RFC 7919 [TLS groups]</selectable></selectables></col>
                </selectable>
                <selectable id="sel-fcs-ckm-ak-lms">
                  <col>LMS</col>
                  <col>LMS</col>
                  <col>Private key size =undefined<h:p/>Winternitz parameter =undefined<h:p/>Tree height = <selectables><selectable id="fcs_ckm.1.1_AKG_19">5</selectable><selectable id="fcs_ckm.1.1_AKG_20">10</selectable><selectable id="fcs_ckm.1.1_AKG_21">15</selectable><selectable id="fcs_ckm.1.1_AKG_22">20</selectable><selectable id="fcs_ckm.1.1_AKG_23">25</selectable></selectables></col>
                  <col>RFC 8554 [LMS]<h:p/>NIST SP 800-208 [parameters]</col>
                </selectable>
                <selectable id="sel-fcs-ckm-ak-mlkem">
                  <col>ML-KEM</col>
                  <col>ML-KEM KeyGen</col>
                  <col>Parameter set = ML-KEM-1024</col>
                  <col>NIST FIPS 203 (Section 7.1)</col>
                </selectable>
                <selectable id="sel-fcs-ckm-ak-mldsa">
                  <col>ML-DSA</col>
                  <col>ML-DSA KeyGen</col>
                  <col>Parameter set = ML-DSA-87</col>
                  <col>NIST FIPS 204 (Section 5.1)</col>
                </selectable>
                <selectable id="sel-fcs-ckm-ak-xmss">
                  <col>XMSS</col>
                  <col>XMSS</col>
                  <col>Private key size =undefined<h:p/>Tree height = <selectables><selectable id="fcs_ckm.1.1_AKG_30">10</selectable><selectable id="fcs_ckm.1.1_AKG_31">16</selectable><selectable id="fcs_ckm.1.1_AKG_32">20</selectable></selectables></col>
                  <col>RFC 8391 [XMSS]<h:p/>NIST SP 800-208 [parameters]</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">
              <h:p>For RSA the choice of the modulus implies the resulting key sizes of the public and private keys generated using the specified standard methods. RSA key generation with modulus size 2048 bits is no longer permitted by CNSA.</h:p>
              <h:p>For Finite Field Cryptography (FFC) DSA, ST authors should consult schemes for
              guidelines on use. FIPS PUB 186-5 does not approve DSA for digital signature
              generation but allows DSA for digital signature verification for legacy purposes.
              “FFC-ERB” or “FFC–RS” may be claimed only for generating private and public keys when
              “DH” is claimed in FCS_CKM_EXT.7/LOCKED or FCS_CKM_EXT.7/UNLOCKED.</h:p>
              <h:p>When generating ECC keys pairs for key agreement and if “ECDH” is claimed in FCS_CKM_EXT.7/LOCKED or FCS_CKM_EXT.7/UNLOCKED, then “ECC–ERB” or “ECC–RS” must be claimed. The sizes of the private key, which is a scalar, and the public key, which is a point on the elliptic curve, are determined by the choice of the curve.</h:p>
              <h:p>When generating ECC key pairs for digital signature generation and if “ECDSA” is claimed in FCS_COP.1/SigGen, then “ECC–ERB” or “ECC–RS” must be claimed. The sizes of the private key, which is a scalar, and the public key, which is a point on the elliptic curve, are determined by the choice of the curve.</h:p>
              <h:p>If the TSF acts only as a receiver in the RSA key establishment scheme,
	      the ST does not need to implement RSA key generation.</h:p>
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to verify that it describes how the TOE generates a key
						based on output from a random bit generator as specified in FCS_RBG.1. The evaluator shall
						review the TSS to verify that it describes how the functionality described by FCS_RBG.1 is
						invoked.
                <h:p/>
                The evaluator shall examine the TSS to verify that it identifies the usage and key lifecycle
						for keys generated using each selected algorithm.
                <h:p/>
                The evaluator shall examine the TSS to verify that any one-time values such as nonces or masks
						are constructed in accordance with the relevant standards.
                <h:p/>
                If the TOE uses the generated key in a key chain or hierarchy then the evaluator shall verify that the
						TSS describes how the key is used as part of the key chain or hierarchy.
              </TSS>
              <Guidance>The evaluator shall verify that the guidance instructs the administrator how to configure the TOE to
						generate keys for the selected key generation algorithms for all key types and uses identified in
						the TSS.</Guidance>
              <Tests>The following tests are conditional based on the selections made in the SFR. The evaluator shall perform the following tests or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>RSA Key Generation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Key Generation Algorithm</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">RSA</h:td><h:td valign="top">RSA</h:td><h:td valign="top">Modulus of size [<h:b>selection:</h:b> <h:i>3072, 4096, 6144, 8192</h:i>] bits</h:td><h:td valign="top">NIST FIPS PUB 186-5 (Section A.1.1)</h:td></h:tr></h:table> <h:p/>FIPS PUB 186-5 Key Pair generation specifies five methods for generating the primes <h:i>p</h:i>and <h:i>q</h:i>. <h:p/>These are: <h:ol><h:li>Random provable primes</h:li> <h:li>Random probable primes</h:li> <h:li>Provable primes with conditions based on auxiliary provable primes</h:li> <h:li>Probable primes with conditions based on auxiliary provable primes</h:li> <h:li>Probable primes with conditions based on auxiliary probable primes</h:li></h:ol> <h:p/>In addition to the key generation method, the input parameters are: <h:ul><h:li>Modulus [3072, 4096, 6144, 8192]</h:li> <h:li>Hash algorithm [SHA-384, SHA-512] (methods 1, 3, 4 only)</h:li> <h:li>Rabin-Miller prime test [2<h:sup>100</h:sup>, 2<h:sup>Security String</h:sup>] (methods 2, 4, 5 only)</h:li> <h:li><h:i>p</h:i> mod 8 value [0,1,3,5,7]</h:li> <h:li><h:i>q</h:i> mod 8 value [0,1,3,5,7]</h:li> <h:li>Private key format [standard, Chinese Remainder Theorem]</h:li> <h:li>Public exponent [fixed value, random]</h:li></h:ul> <h:p/>The evaluator shall verify the ability of the TSF to correctly produce values for the RSA key components, including the public verification exponent <h:i>e</h:i>, the private prime factors <h:i>p</h:i>and <h:i>q</h:i>, the public modulus <h:i>n</h:i>, and the calculation of the private signature exponent <h:i>d</h:i>. <h:p/> <h:br/> <h:i><h:b>Testing for Random Provable Primes and Conditional Methods</h:b></h:i> <h:p/>To test the key generation method for the random provable primes method and for all the primes with conditions methods (methods 1, 3-5), the evaluator must seed the TSF key generation routine with sufficient data to deterministically generate the RSA key pair. <h:p/>For each supported combination of the above input parameters, the evaluator shall have the TSF generate 25 key pairs. The evaluator shall verify the correctness of the TSF’s implementation by comparing values generated by the TSF with those generated by a known good implementation using the same input parameters. <h:p/> <h:br/> <h:i><h:b>Testing for Random Probable Primes Method</h:b></h:i> <h:p/>If the TOE generates random probable primes (method 2) then, if possible, the random probable primes method should also be verified against a known good implementation as described above. If verification against a known good implementation is not possible, the evaluator shall have the TSF generate 25 key pairs for each supported key length nlen and verify that all of the following are true. <h:p/> <h:ul><h:li><h:i>n</h:i> = <h:i>p</h:i>*<h:i>q</h:i></h:li> <h:li><h:i>p</h:i> and <h:i>q</h:i> are probably prime according to Miller-Rabin tests with error
							probability &lt;2<h:sup>(-125)</h:sup></h:li> <h:li>2<h:sup>16</h:sup> &lt; <h:i>e</h:i> &lt; 2<h:sup>256</h:sup> and <h:i>e</h:i> is an odd integer</h:li> <h:li>GCD(<h:i>p</h:i>-1,<h:i>e</h:i>) = 1</h:li> <h:li>GCD(<h:i>q</h:i>-1,<h:i>e</h:i>) = 1</h:li> <h:li>|<h:i>p</h:i>-<h:i>q</h:i>| &gt; 2<h:sup>(<h:i>nlen</h:i>/2 – 100)</h:sup></h:li> <h:li><h:i>p</h:i> ≥ squareroot(2)*( 2<h:sup>(<h:i>nlen</h:i>/2 -1)</h:sup> )</h:li> <h:li><h:i>q</h:i> ≥ squareroot(2)*( 2<h:sup>(<h:i>nlen</h:i>/2 -1)</h:sup> )</h:li> <h:li>2<h:sup>(<h:i>nlen</h:i>/2)</h:sup> &lt; d &lt; LCM(<h:i>p</h:i>-1,<h:i>q</h:i>-1)</h:li> <h:li>e*d = 1 mod LCM(<h:i>p</h:i>-1,<h:i>q</h:i>-1)</h:li></h:ul> <h:br/> <h:b>Elliptic Curve Key Generation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Key Generation Algorithm</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ECC-ERB</h:td><h:td valign="top">ECC – Extra Random Bits</h:td><h:td valign="top">Elliptic Curve [<h:b>selection:</h:b> <h:i>P-384, P-521</h:i>]</h:td><h:td valign="top">NIST FIPS PUB 186-5 (Section A.2.1)<h:p/>
													NIST SP 800-186 (Section 3) [NIST Curves]</h:td></h:tr><h:tr><h:td valign="top">ECC-RS</h:td><h:td valign="top">ECC – Rejection Sampling</h:td><h:td valign="top">Elliptic Curve [<h:b>selection:</h:b> <h:i>P-384, P-521</h:i>]</h:td><h:td valign="top">NIST FIPS PUB 186-5 (Section A.2.2)<h:p/>
													NIST SP 800-186 (Section 3) [NIST Curves]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to generate asymmetric cryptographic keys using elliptic curves, the evaluator shall perform the ECC Key Generation Test and the ECC Key Validation Test using the following input parameters. <h:ul><h:li>Elliptic curve [P-384, P-521]</h:li> <h:li>Key pair generation method [extra random bits, rejection sampling]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>ECC Key Generation Test</h:b></h:i> <h:br/>For each supported combination of the above input parameters the evaluator shall require the implementation under test to generate 10 private and public key pairs ( <h:i>d, Q</h:i>). The private key, <h:i>d</h:i>, shall be generated using a random bit generator as specified in FCS_RBG.1. The private key, <h:i>d</h:i>, is used to compute the public key, <h:i>Q'</h:i>. The evaluator shall confirm that 0&lt; <h:i>d</h:i>&lt; <h:i>n</h:i>(where <h:i>n</h:i>is the order of the group), and the computed value <h:i>Q'</h:i>is then compared to the generated public and private key pairs’ public key, <h:i>Q</h:i>, to confirm that <h:i>Q</h:i>is equal to <h:i>Q'</h:i>. <h:p/> <h:br/> <h:i><h:b>ECC Key Validation Test</h:b></h:i> <h:br/>For each supported combination of the above parameters the evaluator shall generate 12 private and public key pairs using the key generation function of a known good implementation. For each set of 12 public keys, the evaluator shall modify four public key values by shifting <h:i>x</h:i>or <h:i>y</h:i>out of range by adding the order of the field and modify four other public key values by shifting <h:i>x</h:i>or <h:i>y</h:i>so that they are still in bounds, but not on the curve. The remaining public key values are left unchanged (i.e., correct). To determine correctness, the evaluator shall submit the public keys to the public key validation (PKV) function of the TOE and confirm that the results correspond as expected for the modified and unmodified values. <h:p/> <h:br/> <h:b>Finite Field Cryptography Key Generation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Key Generation Algorithm</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">FFC-ERB</h:td><h:td valign="top">FFC – Extra Random Bits</h:td><h:td valign="top">Static domain parameters approved for [<h:b>selection:</h:b> <h:i>IKE groups [<h:b>selection:</h:b> MODP-3072, MODP-4096, 
									MODP-6144, MODP-8192], TLS groups [<h:b>selection:</h:b>  
									ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192]</h:i>]]</h:td><h:td valign="top">NIST SP 800-56A Revision 3 (Section 5.6.1.1.3) [key pair generation]<h:p/>
												[<h:b>selection:</h:b> <h:i>RFC 3526 [IKE groups], RFC 7919 [TLS groups]</h:i>]</h:td></h:tr><h:tr><h:td valign="top">FFC-RS</h:td><h:td valign="top">FFC – Rejection Sampling</h:td><h:td valign="top">Static domain parameters approved for [<h:b>selection:</h:b>
								  IKE groups [<h:b>selection:</h:b> <h:i>MODP-3072, MODP-4096, 
									MODP-6144, MODP-8192], TLS groups [<h:b>selection:</h:b>  
								    ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192]]</h:i>]</h:td><h:td valign="top">NIST SP 800-56A Revision 3 (Section 5.6.1.1.4) [key pair generation]<h:p/>
								  [<h:b>selection:</h:b> <h:i>RFC 3526 [IKE groups], RFC 7919 [TLS groups]</h:i>]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to generate asymmetric cryptographic keys using finite fields, the evaluator shall perform the Safe Primes Generation Test and the Safe Primes Validation Test using the following input parameter: <h:ul><h:li>Fields/Groups [MODP-3072, MODP-4096, MODP-6144, MODP-8192,  
							ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>Safe Primes Generation Test</h:b></h:i> <h:br/>For each supported safe primes group, generate 10 key pairs. The evaluator shall verify the correctness of the TSF’s implementation by comparing values generated by the TSF with those generated by a known good implementation using the same input parameters. <h:p/> <h:br/> <h:i><h:b>Safe Primes Verification Test</h:b></h:i> <h:br/>For each supported safe primes group, use a known good implementation to generate 10 key pairs. For each set of 10, the evaluator shall modify three so they are incorrect. The remaining values are left unmodified (i.e. correct). To determine correctness, the evaluator shall submit the key pairs to the public key validation (PKV) function of the TOE and shall confirm that the results correspond as expected for the modified and unmodified values. <h:p/> <h:br/> <h:b>LMS Key Generation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Key Generation Algorithm</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">LMS</h:td><h:td valign="top">LMS Key Generation</h:td><h:td valign="top">Private key size = [<h:b>selection:</h:b>  
									192 bits with [<h:b>selection:</h:b> <h:i>SHA-256/192, SHAKE256/192],
									256 bits with [<h:b>selection:</h:b> SHA-256, SHAKE256]</h:i>]; 
								  Winternitz parameter = [<h:b>selection:</h:b> <h:i>1, 2, 4, 8</h:i>]; 
								  Tree height = [<h:b>selection:</h:b> <h:i>5, 10, 15, 20, 25</h:i>]
								</h:td><h:td valign="top">RFC 8554 [LMS]<h:p/>NIST SP 800-208 [parameters]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to generate asymmetric cryptographic keys using LMS, the evaluator shall perform the LMS Key Generation Test using the following input parameters: <h:ul><h:li>Hash algorithm [SHA-256/192, SHAKE256/192, SHA-256, SHAKE256]</h:li> <h:li>Winternitz [1, 2, 4, 8]</h:li> <h:li>Tree height [5, 10, 15, 20, 25]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>LMS Key Generation Test</h:b></h:i> <h:br/>For each supported combination of the hash algorithm, Winternitz parameter, and tree height, the evaluator shall generate one public key for each of the test cases. The number of test cases depends on the tree height: <h:b><h:div style="text-align: center;"><ctr ctr-type="Table" pre="Table " id="lms-test-cases">: Number of LMS Test Cases</ctr></h:div></h:b> <h:table border="1" style="width:50%"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Height</h:td><h:td valign="top">Number of test cases</h:td></h:tr><h:tr><h:td valign="top">5</h:td><h:td valign="top">5</h:td></h:tr><h:tr><h:td valign="top">10</h:td><h:td valign="top">4</h:td></h:tr><h:tr><h:td valign="top">15</h:td><h:td valign="top">3</h:td></h:tr><h:tr><h:td valign="top">20</h:td><h:td valign="top">2</h:td></h:tr><h:tr><h:td valign="top">25</h:td><h:td valign="top">1</h:td></h:tr></h:table> <h:p/>The evaluator shall verify the correctness of the TSF’s implementation by comparing the public key generated by the TSF with that generated by a known good implementation using the same input parameters. <h:p/> <h:br/> <h:b>ML-KEM Key Generation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Key Generation Algorithm</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ML-KEM</h:td><h:td valign="top">ML-KEM Key Generation</h:td><h:td valign="top">Parameter set = [ML-KEM-1024]</h:td><h:td valign="top">NIST FIPS PUB 203 (Section 7.1)</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to generate asymmetric cryptographic keys using ML-KEM, the evaluator shall perform the Algorithm Functional Test using the following input parameters: <h:ul><h:li>Parameter set [ML-KEM-1024]</h:li> <h:li>Random seed d [32 bytes]</h:li> <h:li>Random seed z [32 bytes]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each supported parameter set the evaluator shall require the implementation under test to generate 25 key pairs using 25 different randomly generated pairs of 32-byte seed values ( <h:i>d, z</h:i>). To determine correctness, the evaluator shall compare the resulting key pairs ( <h:i>ek, dk</h:i>) with those generated using a known good implementation using the same inputs. <h:p/> <h:br/> <h:b>ML-DSA Key Generation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Key Generation Algorithm</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ML-DSA</h:td><h:td valign="top">ML-DSA Key Generation</h:td><h:td valign="top">Parameter set = ML-DSA-87</h:td><h:td valign="top">NIST FIPS PUB 204 (Section 5.1)</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to generate asymmetric cryptographic keys using ML-DSA, the evaluator shall perform the Algorithm Functional Test using the following input parameters: <h:ul><h:li>Parameter set [ML-DSA-87]</h:li> <h:li>Random seed [32 bytes]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each supported parameter set the evaluator shall require the implementation under test to generate 25 key pairs using 25 different randomly generated 32-byte seed values. To determine correctness, the evaluator shall compare the resulting key pairs with those generated using a known good implementation using the same inputs. <h:p/> <h:br/> <h:b>XMSS Key Generation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Key Generation Algorithm</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">XMSS</h:td><h:td valign="top">XMSS</h:td><h:td valign="top">Private key size = [<h:b>selection:</h:b> <h:i>192 bits
									with [<h:b>selection:</h:b> SHA-256/192, SHAKE256/192], 256 bits 
									with [<h:b>selection:</h:b> SHA-256, SHAKE256]</h:i>], tree height = 
							    [<h:b>selection:</h:b> <h:i>10, 16, 20</h:i>]</h:td><h:td valign="top">RFC 8391 [XMSS]<h:p/>
									NIST SP 800-208 [parameters]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to generate asymmetric cryptographic keys using XMSS, the evaluator shall perform the XMSS Key Generation Test using the following input parameters: <h:ul><h:li>Hash algorithm [SHA-256/192, SHAKE256/192, SHA-256, SHAKE256]</h:li> <h:li>Tree height [10, 16, 20] (XMSS only)</h:li></h:ul> <h:p/> <h:b><h:div style="text-align: center;"><ctr ctr-type="Table" pre="Table " id="xmss-akg-test-cases">: Number of Test Cases for XMSS<h:sup>MT</h:sup></ctr></h:div></h:b> <h:table border="1" style="width:50%"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Height</h:td><h:td valign="top">Number of test cases</h:td></h:tr><h:tr><h:td valign="top">10</h:td><h:td valign="top">5</h:td></h:tr><h:tr><h:td valign="top">16</h:td><h:td valign="top">4</h:td></h:tr><h:tr><h:td valign="top">20</h:td><h:td valign="top">3</h:td></h:tr><h:tr><h:td valign="top">40</h:td><h:td valign="top">2</h:td></h:tr><h:tr><h:td valign="top">60</h:td><h:td valign="top">1</h:td></h:tr></h:table> <h:p/> <h:br/> <h:i><h:b>XMSS Key Generation Test</h:b></h:i> <h:br/>For each supported combination of hash algorithm and tree height, the evaluator shall generate one public key for each test case. The number of test cases depends on the tree height as specified in <xref to="xmss-akg-test-cases"/>. <h:p/>The evaluator shall verify the correctness of the TSF’s implementation by comparing values generated by the TSF with those generated by a known good implementation using the same input parameters. <h:p/>Note: The number of test cases is limited due to the extreme amount of time it can take to generate XMSS trees. <h:p/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM.1/SKG Cryptographic Key Generation - Symmetric Key -->
        <f-component cc-id="fcs_ckm.1" id="sfr-fcs-ckm-1-skg" name="Cryptographic Key Generation - Symmetric Key" iteration="SKG">
          <f-element id="fcs-ckm-1e1-skg">
            <title>
              The TSF shall generate
              <h:b>symmetric</h:b>
              cryptographic keys in accordance with
              a specified cryptographic key generation algorithm
              <selectables>
                <tabularize id="fcs-ckm-1-skg-sels" title="Allowable Choices for FCS_CKM.1/SKG">
                  <textcol>Identifier</textcol>
                  <selectcol>Cryptographic Key Generation Algorithm</selectcol>
                  <reqtext>and specified cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic Key Sizes</selectcol>
                  <reqtext>that meet the following: </reqtext>
                  <selectcol>List of standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_CKM.1/SKG.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-ckm-sk-rsk">
                  <col>RSK</col>
                  <col>Direct Generation from a Random Bit Generator as specified in FCS_RBG.1</col>
                  <col><selectables><selectable id="sel-exp-skg-256">256</selectable><selectable id="sel-exp-skg-256">384</selectable><selectable id="sel-exp-skg-512">512</selectable></selectables> bits</col>
                  <col>NIST SP 800-133 Revision 2 (Section 6.1)[Direct generation of symmetric keys]</col>
                </selectable>
              </selectables>
            </title>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to verify that it describes how the TOE obtains a symmetric
                cryptographic key through direct generation from a random bit generator as specified in
                FCS_RBG.1. The evaluator shall review the TSS to verify that it describes how the functionality
                described by FCS_RBG.1 is invoked.
                <h:p/>
                The evaluator shall examine the TSS to verify that it identifies the usage, and key lifecycle for
                keys generated using each selected algorithm.
                <h:p/>
                If the TOE uses the generated key in a key chain/hierarchy then the evaluator shall verify that the
                TSS describes how the key is used as part of the key chain/hierarchy.
              </TSS>
              <Guidance>The evaluator shall verify that the AGD instructs the administrator how to configure the TOE to
                use the RBG to generate symmetric keys for all uses identified in the ST.</Guidance>
              <Tests>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/>To test the TOE’s ability to generate symmetric cryptographic keys using a random bit generator, the evaluator shall configure the symmetric cryptographic key generation capability for each claimed key size. The evaluator shall use the description of the RBG interface to verify that the TOE requests and receives an amount of RBG output greater than or equal to the requested key size.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM.2 Cryptographic Key Distribution -->
        <f-component cc-id="fcs_ckm.2" id="fcs-ckm-2" name="Cryptographic Key Distribution">
          <f-element id="fel-crypt-key-estab">
            <title>
              The TSF shall distribute cryptographic keys in accordance with the specified cryptographic 
              key distribution method
              <h:b>key wrapping</h:b>
              and
              <selectables>
                <selectable id="sel-ckm-2-encap">key encapsulation</selectable>
                <selectable id="sel-ckm-2-no-other">
                  <h:b>no other methods</h:b>
                </selectable>
              </selectables>
              that meets the following: [none].
            </title>
            <note role="application">
              <h:p>Key wrapping is used in support of wireless LAN communications. Key encapsulation is used in support of TLS when ML-KEM is used as the method of key establishment.</h:p>
            </note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS documents that the security strength supported by
                the selected key distribution methods is sufficient for the security strength of the keys
                distributed through those methods.
                <h:p/>
                It is not necessary to identify the services that use each key distribution method here. That
                information should be documented in the requirements for the individual services and
                protocols that invoke key distribution.
              </TSS>
              <Guidance>The evaluator shall verify that the AGD guidance instructs the administrator
                how to configure the TOE to use the selected key distribution methods.</Guidance>
              <Tests>Specific testing for this component is covered by testing for the claimed components in FCS_COP.1/KeyEncap or FCS_COP.1/KeyWrap, depending on selections made.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM.6 Timing and Event of Cryptographic Key Destruction -->
        <f-component cc-id="fcs_ckm.6" id="fcs-ckm-6" name="Timing and Event of Cryptographic Key Destruction">
          <f-element id="fel-key-kill-when">
            <title>
              The TSF shall destroy [<h:i>all plaintext keying material and critical security
              parameters (CSPs)</h:i>] when
              <selectables>
                <selectable id="fcs_ckm.6.1_1">no longer needed</selectable>
                <selectable id="fcs_ckm.6.1_3">
                  <assignable>other circumstances for destruction</assignable>
                </selectable>
              </selectables>.
            </title>
          </f-element>
          <f-element id="fel-key-kill-how">
            <title>
              The TSF shall destroy
              <h:b>plaintext</h:b>
              keying material
              <h:b>and critical security parameters</h:b>
              by 
                implementing key destruction in accordance with the following rules: [<h:i>
                <h:ul>
                  <h:li>For volatile memory, the destruction shall be executed by a single direct overwrite consisting of  <selectables><selectable id="fcs_ckm.6.2_1">a pseudo-random pattern using a TSF DRBG (as specified in FCS_RBG.1)</selectable><selectable id="fcs_ckm.6.2_2">zeroes</selectable></selectables></h:li>
                  <h:li>For non-volatile EEPROM, the destruction shall be executed by a single direct overwrite consisting of a pseudo-random pattern using a 
                    TSF DRBG (as specified in FCS_RBG.1), followed by a read-verify.</h:li>
                  <h:li>For non-volatile flash memory, that is not wear-leveled, the destruction shall be executed by <selectables><selectable id="fcs_ckm.6.2_3">a single direct overwrite consisting of zeros followed by a read-verify</selectable><selectable id="fcs_ckm.6.2_4">a block erase that erases the reference to memory that stores data as well as the data itself</selectable></selectables></h:li>
                  <h:li>For non-volatile flash memory that is wear-leveled, the destruction shall be executed by <selectables><selectable id="fcs_ckm.6.2_5">a single direct overwrite consisting of zeros</selectable><selectable id="fcs_ckm.6.2_6">a block erase</selectable></selectables></h:li>
                  <h:li>For non-volatile memory other than EEPROM and flash, the destruction shall be executed by a single direct overwrite with a random pattern that 
                    is changed before each write.</h:li>
                </h:ul>
              </h:i>]
            </title>
            <note role="application">
              <h:p>For the purposes of this requirement, keying material refers to authentication data, passwords, secret/private symmetric keys, private asymmetric keys, data used to derive keys, values derived from passwords, etc. “Plaintext keying material” may refer to a KEK that is used to encrypt other keying material. Destruction of encrypted keying material may be accomplished by destroying the KEK used to encrypt it. If different mechanisms are used for destroying different keying material, all relevant claims should be selected and the TSS should identify which keying material is destroyed by which mechanism.</h:p>
              <h:p>There are multiple situations in which plaintext keying material is no longer needed, including when the TOE is powered off, when the wipe when trusted channels are disconnected, when keying material is no longer needed by the trusted channel per the protocol, and when transitioning to the locked state (for those values derived from the Password Authentication Factor or that key material which is protected by the password-derived or biometric-unlocked KEK according to FCS_STG_EXT.2 – see Figure 3). For keys (or key material used to derive those keys) protecting sensitive data received in the locked state, "no longer needed" includes "while in the locked state." The assignment for "other circumstances for destruction" is completed for any user or Administrator directed key destruction such as initiating the wipe function or other manual destruction.</h:p>
              <h:p>Key storage areas in non-volatile storage can be overwritten with any value that renders the keys unrecoverable. The value used can be all zeroes, all ones, or any other pattern or combination of values significantly different than the value of the key itself. When ‘a value that does not contain any CSP’ is chosen, it means that the TOE uses some other specified data not drawn from a source that may contain keying material or reveal information about it or any other TSF-protected data. In other words, the data used for overwriting is carefully selected and not taken from a general ‘pool’ that might contain current or residual data that itself requires confidentiality protection. If multiple copies exist, all copies must be destroyed.</h:p>
            </note>
            <aactivity>
              <TSS>
                <h:p>The evaluator shall verify that the TSS identifies all plaintext keying material and CSPs stored by the TOE, the type of memory in which it is stored, and when and how the keying material is erased. If the TOE uses one or more KEKs to protect stored keying material, the evaluator shall verify that the TSS describes the destruction of that keying material, either directly or by destruction of the KEK used to encrypt it.</h:p>
                <h:p>If different types of memory are used to store the materials to be protected, the evaluator shall check to ensure that the TSS describes the clearing procedure in terms of the memory in which the data are stored (for example, "secret keys stored on flash are cleared by overwriting once with zeros, while secret keys stored on the internal persistent storage device are cleared by overwriting one time with a random pattern that is changed before each write"). For block erases, the evaluator shall also ensure that the TSS identifies the block erase command that is used and shall verify that the command used also addresses any copies of the plaintext key material that may be created, e.g. in order to optimize the use of Flash memory.</h:p>
              </TSS>
              <Guidance/>
              <Tests>
                <h:p>
                  <h:b>Evaluation Activity Note:</h:b>
                  The following tests likely require the TOE developer to
                provide access to a test platform that provides the evaluator with tools that are
                typically not found on the end consumer version of the TOE.
                </h:p>
                <h:p>The evaluator shall perform the following tests for all keys and key material subject to destruction by the TOE. For these tests, the evaluator shall utilize an appropriate development environment (e.g., a virtual machine) and development tools (debuggers, simulators, etc.) to test that keys are cleared, including all copies of
                  the key that may have been created internally by the TOE during normal cryptographic
                  processing with that key.</h:p>
                <testlist>
                  <test>Applied to each key held as plaintext in volatile memory and subject to destruction by overwrite by the TOE (whether or not the plaintext value is subsequently encrypted for storage in volatile or non-volatile memory). In the case where the only selection made for the destruction method key was removal of power, then this test is unnecessary. The evaluator shall: <h:br/>  <h:ol><h:li>Record the value of the key in the TOE subject to clearing.</h:li> <h:li>Cause the TOE to perform a normal cryptographic processing with the
                        key from Step #1.</h:li> <h:li>Cause the TOE to clear the key.</h:li> <h:li>Cause the TOE to stop the execution but not exit.</h:li> <h:li>Cause the TOE to dump the entire memory of the TOE into a binary
                        file.</h:li> <h:li>Search the content of the binary file created in Step #5 for instances
                        of the known key value from Step #1.</h:li> <h:li>Break the key value from Step #1 into 3 similar sized pieces and
                        perform a search using each piece.</h:li></h:ol>  <h:br/> Steps 1-6 ensure that the complete key does not exist anywhere in volatile memory. If a copy is found, then the test fails. <h:br/>  <h:br/> Step 7 ensures that partial key fragments do not remain in memory. If a fragment is found, there is a minuscule chance that it is not within the context of a key (e.g., some random bits that happen to match). If this is the case the test should be repeated with a different key in Step #1. If a fragment is found the test fails. <h:br/>  <h:br/></test>
                  <test>Applied to each key held in non-volatile memory and subject to destruction by overwrite by the TOE. The evaluator shall use special tools (as needed), provided by the TOE developer if necessary, to view the key storage location: <h:br/>  <h:ol><h:li>Record the value of the key in the TOE subject to clearing.</h:li> <h:li>Cause the TOE to perform a normal cryptographic processing with the
                        key from Step #1.</h:li> <h:li>Cause the TOE to clear the key.</h:li> <h:li>Search the non-volatile memory the key was stored in for instances of
                        the known key value from Step #1. If a copy is found, then the test
                        fails.</h:li> <h:li>Break the key value from Step #1 into 3 similar sized pieces and
                        perform a search using each piece. If a fragment is found then the test is
                        repeated (as described for test 1 above), and if a fragment is found in the
                        repeated test then the test fails.</h:li></h:ol>  <h:br/>  <h:br/></test>
                  <test>Applied to each key held as non-volatile memory and subject to destruction by overwrite by the TOE. The evaluator shall use special tools (as needed), provided by the TOE developer if necessary, to view the key storage location: <h:br/>  <h:ol><h:li>Record the storage location of the key in the TOE subject to
                        clearing.</h:li> <h:li>Cause the TOE to perform a normal cryptographic processing with the
                        key from Step #1.</h:li> <h:li>Cause the TOE to clear the key.</h:li> <h:li>Read the storage location in Step #1 of non-volatile memory to ensure
                        the appropriate pattern is utilized. </h:li></h:ol>  <h:br/> The test succeeds if correct pattern is used to overwrite the key in the memory location. If the pattern is not found the test fails.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM_EXT.1 Cryptographic Key Support -->
        <f-component cc-id="fcs_ckm_ext.1" id="fcs-ckm-ext-1" name="Cryptographic Key Support">
          <comp-lev> requires the TSF to implement a Root Encryption Key (REK).</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Generation of a REK.</h:li>
            </h:ul>
          </audit>
          <dependencies>FCS_RBG.1 Random Bit Generation</dependencies>
          <f-element id="fel-mut-hard">
            <title>The TSF shall support  <selectables><selectable id="s-immutable-hardware">immutable hardware</selectable><selectable id="mutable_hardware">mutable hardware</selectable></selectables>  REKs with a  <selectables><selectable id="s-rek-sym">symmetric</selectable><selectable id="s-rek-asym">asymmetric</selectable></selectables>  key of strength  <selectables><selectable id="s-rek-192">192 bits</selectable><selectable id="s-rek-256">256 bits</selectable></selectables>. </title>
            <ext-comp-def-title>
              <title>The TSF shall support <assignable>description of REKs</assignable></title>
            </ext-comp-def-title>
          </f-element>
          <f-element id="fel-rek-iso">
            <title>Each REK shall be hardware-isolated from the OS on the TSF in runtime. </title>
          </f-element>
          <f-element id="fel-rek-gen">
            <title>Each REK shall be generated by an RBG in accordance with FCS_RBG.1. </title>
            <note role="application">
              Either asymmetric or symmetric keys are allowed; the ST author
              makes the selection appropriate for the device. Symmetric keys must be of size 
              256 bits in order to correspond with FCS_COP.1/SKC. Asymmetric keys may be of any
              strength corresponding to FCS_CKM.1/AKG.
              <h:br/>
              <h:br/>
              The raw key material of
              "immutable hardware" REKs is computationally processed by hardware and software
              cannot access the raw key material. Thus if
              <xref to="s-immutable-hardware"/>
              is selected in
	      FCS_CKM_EXT.1.1 it implicitly meets FCS_CKM_EXT.7/LOCKED or FCS_CKM_EXT.7/UNLOCKED.
	      If
              <xref to="mutable_hardware"/>
              is selected
              in FCS_CKM_EXT.1.1, FCS_CKM_EXT.7/LOCKED or FCS_CKM_EXT.7/UNLOCKED must be included in the ST.
              <h:br/>
              <h:br/>
              The
              lack of a public/documented API for importing or exporting the REK, when a
              private/undocumented API exists, is not sufficient to meet this requirement.
              <h:br/>
              <h:br/>
              The RBG used to generate a REK may be an RBG native to the hardware
              key container or may be an off-device RBG. If performed by an off-device RBG, the
              device manufacturer must not be able to access a REK after the manufacturing process
              has been completed. The Evaluation Activities for these two cases differ.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall review the TSS to determine that a REK is supported by the
                TOE, that the TSS includes a description of the protection provided by the TOE for a
                REK, and that the TSS includes a description of the method of generation of a REK.
                <h:br/>
                <h:br/>
                The evaluator shall verify that the description of the protection
                of a REK describes how any reading, import, and export of that REK is prevented.
                For example, if the hardware protecting the REK is removable, the description
                should include how other devices are prevented from reading the REK. The evaluator
                shall verify that the TSS describes how encryption/decryption/derivation actions are
                isolated so as to prevent applications and system-level processes from reading the
                REK while allowing encryption/decryption/derivation by the key.
                <h:br/>
                <h:br/>
                The evaluator shall verify that the description includes how the OS is
                prevented from accessing the memory containing REK key material, which software is
                allowed access to the REK, how any other software in the execution environment is
                prevented from reading that key material, and what other mechanisms prevent the REK
                key material from being written to shared memory locations between the OS and
                the separate execution environment.
                <h:br/>
                <h:br/>
                If key derivation is
                performed using a REK, the evaluator shall ensure that the TSS description includes
                a description of the key derivation function and shall verify the key derivation
                uses an approved derivation mode and key expansion algorithm according to
                FCS_CKM_EXT.3.2.
                <h:br/>
                <h:br/>
                The evaluator shall verify that the generation
                of a REK meets the FCS_RBG.1 requirement:
                <h:br/>
                <h:ul>
                  <h:li>If REKs is/are generated on-device, the TSS shall include a description
                    of the generation mechanism including what triggers a generation, how the
                    functionality described by FCS_RBG.1 is invoked, and whether a separate
                    instance of the RBG is used for REKs.</h:li>
                  <h:li>If REKs is/are generated off-device, the TSS shall include evidence that
                    the RBG meets FCS_RBG.1. This will likely necessitate a second set of RBG
                    documentation equivalent to the documentation provided for the RBG Evaluation
                    Activities. In addition, the TSS shall describe the manufacturing process that
                    prevents the device manufacturer from accessing any REKs.</h:li>
                </h:ul>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>
              <selectables onlyone="yes">
                <selectable>generation of a REK</selectable>
                <selectable>none</selectable>
              </selectables>
            </audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FCS_CKM_EXT.2 Cryptographic Key Random Generation -->
        <f-component cc-id="fcs_ckm_ext.2" id="fcs-ckm-ext-2" name="Cryptographic Key Random Generation">
          <comp-lev> requires the TSF to specify the mechanism it uses to generate Data Encryption Keys (DEKs).</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_RBG.1 Random Bit Generation</dependencies>
          <f-element id="fel-dek-gen">
            <title>
              All DEKs shall be
              <selectables>
                <selectable id="fcs_ckm_ext.2.1_1">randomly generated</selectable>
                <selectable id="fcs_ckm_ext.2.1_2">from the combination of a randomly generated DEK with another DEK or salt in a way that preserves the effective entropy of each factor by <selectables><selectable id="fcs_ckm_ext.2.1_3">using an XOR operation</selectable><selectable id="fcs_ckm_ext.2.1_4">concatenating the keys and using a KDF (as described in SP 800-108)</selectable><selectable id="s-dek-800-56">concatenating the keys and using a KDF (as described in SP 800-56C)</selectable></selectables></selectable>
              </selectables>
              with entropy corresponding to the security strength of AES key sizes of
                256 bits.
            </title>
            <ext-comp-def-title>
              <title>
                All DEKs shall be
                <assignable>generation mechanism</assignable>
                with entropy corresponding
		to the security strength of AES key sizes of 256 bits.
              </title>
            </ext-comp-def-title>
            <note role="application">
              The intent of this requirement is to ensure that the DEK
              cannot be recovered with less work than a full exhaust of the key space for AES. The
              key generation capability of the TOE uses an RBG implemented on the TOE device
              (FCS_RBG.1). A DEK is used in addition to the KEK so that
              authentication factors can be changed without having to re-encrypt all of the user
              data on the device.
              <h:br/>
              <h:br/>
              The ST author selects all applicable DEK
              generation types implemented by the TOE.
              <h:br/>
              <h:br/>
              SP 800-56C specifies a two-step key derivation
              procedure that employs an extraction-then-expansion technique for deriving keying
              material from a shared secret generated during a key establishment scheme. The
              Randomness Extraction step as described in Section 5 of SP 800-56C is followed by Key
              Expansion using the key derivation functions defined in SP 800-108 (as described in
              Section 6 of SP 800-56C).
            </note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the documentation of the product's encryption key
                management is detailed enough that, after reading, the product's key management hierarchy is clear 
                and that it meets the requirements to ensure the keys are adequately protected. The evaluator shall ensure
                that the documentation includes both an essay and one or more diagrams. Note that this may also be documented as 
                separate proprietary evidence rather than being included in the TSS.
                <h:br/>
                <h:br/>
                The evaluator shall also examine the key hierarchy section of the TSS to ensure that
                the formation of all DEKs is described and that the key sizes match that described
                by the ST author. The evaluator shall examine the key hierarchy section of the TSS
                to ensure that each DEK is generated or combined from keys of equal or greater
                security strength using one of the selected methods.
                <h:br/>
                <h:ul>
                  <h:li>If the symmetric DEK is generated by an RBG, the evaluator shall review
                    the TSS to determine that it describes how the functionality described by
                    FCS_RBG.1 is invoked. The evaluator uses the description of the RBG
                    functionality in FCS_RBG.1 or documentation available for the operational
                    environment to determine that the key size being requested is greater than or
                    equal to the key size and mode to be used for the encryption/decryption of the
                    data.</h:li>
                  <h:li>If the DEK is formed from a combination, the evaluator shall verify that
                    the TSS describes the method of combination and that this method is either an
                    XOR or a KDF to justify that the effective entropy of each factor is preserved. 
                    The evaluator shall also verify that each combined value was originally generated 
                  from an Approved DRBG described in FCS_RBG.1.</h:li>
                  <h:li>
                    If
                    <xref to="s-dek-800-56"/>
                    is selected,
		  the evaluator shall ensure the TSS includes a description of the
                    randomness extraction step.
                  </h:li>
                </h:ul>
                The description must include how an approved untruncated MAC function is
                being used for the randomness extraction step and the evaluator must verify the TSS
                describes that the output length (in bits) of the MAC function is at least as large
                as the targeted security strength (in bits) of the parameter set employed by the key
                establishment scheme (see Tables 1-3 of SP 800-56C).
                <h:br/>
                <h:br/>
                The
                description must include how the MAC function being used for the randomness
                extraction step is related to the PRF used in the key expansion and verify the TSS
                description includes the correct MAC function:
                <h:ul>
                  <h:li>If an HMAC-hash is used in the randomness extraction step, then the same
                    HMAC-hash (with the same hash function hash) is used as the PRF in the key
                    expansion step.</h:li>
                  <h:li>If an AES-CMAC is used in the
                    randomness extraction step, then AES-CMAC with a 128-bit key is used as the PRF
                    in the key expansion step.</h:li>
                  <h:li>The description must include the lengths of the salt values being used in
                    the randomness extraction step and the evaluator shall verify the TSS
                    description includes correct salt lengths:</h:li>
                  <h:li>If an HMAC-hash is being used as the MAC, the salt length can be any value
                    up to the maximum bit length permitted for input to the hash function
                    hash.</h:li>
                  <h:li>If an AES-CMAC is being used as the MAC, the salt length shall be the same
                    length as the AES key (i.e., 256 bits).</h:li>
                </h:ul>
                (conditional) If a KDF is used, the evaluator shall ensure that the TSS
                includes a description of the key derivation function and shall verify the key
                derivation uses an approved derivation mode and key expansion algorithm according to
                SP 800-108 or SP 800-56C.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator uses the description of the RBG functionality in
                FCS_RBG.1 or documentation available for the operational environment to
                determine that the key size being generated or combined is identical to the key size
                and mode to be used for the encryption/decryption of the
                data.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>If a KDF is used, the evaluator shall perform one or more of the following tests to verify the correctness of the key derivation function, depending on the modes that are supported. <xref to="notations"/> maps the data fields to the notations used in SP 800-108 and SP 800-56C. <h:br/> <h:br/> <h:b><ctr ctr-type="Table" id="notations">: Notations used in SP 800-108 and SP
                    800-56C</ctr></h:b> <h:br/> <h:table><h:tr class="header"><h:td>Data Fields</h:td><h:td>Notations
                    </h:td><h:td/></h:tr><h:tr class="header"><h:td/><h:td>SP 800-108</h:td><h:td>SP
                      800-56C</h:td></h:tr><h:tr><h:td>Pseudorandom
                      function</h:td><h:td>PRF</h:td><h:td>PRF</h:td></h:tr><h:tr><h:td>Counter
                    length</h:td><h:td>r</h:td><h:td>r</h:td></h:tr><h:tr><h:td>Length of output of
                      PRF</h:td><h:td>h</h:td><h:td>h</h:td></h:tr><h:tr><h:td>Length of derived keying
                      material</h:td><h:td>L</h:td><h:td>L</h:td></h:tr><h:tr><h:td>Length of input values</h:td><h:td>l length</h:td><h:td>l
                      length</h:td></h:tr><h:tr><h:td>Pseudorandom input values I</h:td><h:td>K1 (key derivation
                      key)</h:td><h:td>Z (shared secret)</h:td></h:tr><h:tr><h:td>Pseudorandom salt
                      values</h:td><h:td>n/a</h:td><h:td>s</h:td></h:tr><h:tr><h:td>Randomness extraction
                      MAC</h:td><h:td>n/a</h:td><h:td>MAC</h:td></h:tr></h:table> <h:br/> <h:br/> <h:b>Counter Mode Tests:</h:b> <h:br/> <h:br/>The evaluator shall determine the following characteristics of the key derivation function: <h:ul><h:li>One or more pseudorandom functions that are supported by the
                    implementation (PRF).</h:li> <h:li>One or more of the values {8, 16, 24, 32} that equal the length of the
                    binary representation of the counter (r).</h:li> <h:li>The length (in bits) of the output of the PRF (h).</h:li> <h:li>Minimum and maximum values for the length (in bits) of the derived keying
                    material (L). These values can be equal if only one value of L is supported.
                    These must be evenly divisible by h.</h:li> <h:li>Up to two values of L that are NOT evenly divisible by h.</h:li> <h:li>Location of the counter relative to fixed input data: before, after, or in
                    the middle.</h:li> <h:ul><h:li>Counter before fixed input data: fixed input data string length (in
                      bytes), fixed input data string value.</h:li> <h:li>Counter after fixed input data: fixed input data string length (in
                      bytes), fixed input data string value.</h:li> <h:li> Counter in the middle of fixed input data: length of data before
                      counter (in bytes), length of data after counter (in bytes), value of string
                      input before counter, value of string input after counter.</h:li></h:ul> <h:li>The length (I_length) of the input values I.</h:li></h:ul>For each supported combination of I_length, MAC, salt, PRF, counter location, value of r, and value of L, the evaluator shall generate 10 test vectors that include pseudorandom input values I, and pseudorandom salt values. If there is only one value of L that is evenly divisible by h, the evaluator shall generate 20 test vectors for it. For each test vector, the evaluator shall supply this data to the TOE in order to produce the keying material output. <h:br/> <h:br/>The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation. <h:br/> <h:br/> <h:b> Feedback Mode Tests:</h:b> <h:br/> <h:br/>The evaluator shall determine the following characteristics of the key derivation function: <h:ul><h:li>One or more pseudorandom functions that are supported by the
                    implementation (PRF).</h:li> <h:li>The length (in bits) of the output of the PRF (h).</h:li> <h:li>Minimum and maximum values for the length (in bits) of the derived keying
                    material (L). These values can be equal if only one value of L is supported.
                    These must be evenly divisible by h.</h:li> <h:li>Up to two values of L that are NOT evenly divisible by h.</h:li> <h:li>Whether or not zero-length IVs are supported.</h:li> <h:li>Whether or not a counter is used, and if so:</h:li> <h:ul><h:li>One or more of the values {8, 16, 24, 32} that equal the length of the
                      binary representation of the counter (r).</h:li> <h:li> Location of the counter relative to fixed input data: before, after, or
                      in the middle.</h:li> <h:ul><h:li>Counter before fixed input data: fixed input data string length (in
                        bytes), fixed input data string value.</h:li> <h:li>Counter after fixed input data: fixed input data string length (in
                        bytes), fixed input data string value.</h:li> <h:li>Counter in the middle of fixed input data: length of data before
                        counter (in bytes), length of data after counter (in bytes), value of string
                        input before counter, value of string input after counter.</h:li></h:ul></h:ul> <h:li>The length (I_length) of the input values I.</h:li></h:ul>For each supported combination of I_length, MAC, salt, PRF, counter location (if a counter is used), value of r (if a counter is used), and value of L, the evaluator shall generate 10 test vectors that include pseudorandom input values I and pseudorandom salt values. If the KDF supports zero-length IVs, five of these test vectors will be accompanied by pseudorandom IVs and the other five will use zero-length IVs. If zero-length IVs are not supported, each test vector will be accompanied by an pseudorandom IV. If there is only one value of L that is evenly divisible by h, the evaluator shall generate 20 test vectors for it. <h:br/> <h:br/>For each test vector, the evaluator shall supply this data to the TOE in order to produce the keying material output. The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation. <h:br/> <h:br/> <h:b> Double Pipeline Iteration Mode Tests:</h:b> <h:br/> <h:br/>The evaluator shall determine the following characteristics of the key derivation function: <h:ul><h:li>One or more pseudorandom functions that are supported by the
                    implementation (PRF).</h:li> <h:li>The length (in bits) of the output of the PRF (h).</h:li> <h:li>Minimum and maximum values for the length (in bits) of the derived keying
                    material (L). These values can be equal if only one value of L is supported.
                    These must be evenly divisible by h.</h:li> <h:li>Up to two values of L that are NOT evenly divisible by h.</h:li> <h:li>Whether or not a counter is used, and if so:</h:li> <h:ul><h:li>One or more of the values {8, 16, 24, 32} that equal the length of the
                      binary representation of the counter (r).</h:li> <h:li>Location of the counter relative to fixed input data: before, after, or
                      in the middle.</h:li> <h:ul><h:li> Counter before fixed input data: fixed input data string length (in
                        bytes), fixed input data string value.</h:li> <h:li> Counter after fixed input data: fixed input data string length (in
                        bytes), fixed input data string value.</h:li> <h:li> Counter in the middle of fixed input data: length of data before
                        counter (in bytes), length of data after counter (in bytes), value of string
                        input before counter, value of string input after counter.</h:li></h:ul></h:ul> <h:li>The length (I_length) of the input values I.</h:li></h:ul>For each supported combination of I_length, MAC, salt, PRF, counter location (if a counter is used), value of r (if a counter is used), and value of L, the evaluator shall generate 10 test vectors that include pseudorandom input values I, and pseudorandom salt values. If there is only one value of L that is evenly divisible by h, the evaluator shall generate 20 test vectors for it. <h:br/> <h:br/>For each test vector, the evaluator shall supply this data to the TOE in order to produce the keying material output. The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation. <h:br/> <h:br/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM_EXT.3 Cryptographic Key Generation -->
        <f-component cc-id="fcs_ckm_ext.3" id="fcs-ckm-ext-3" name="Cryptographic Key Generation">
          <comp-lev> requires the TSF to generate and manage the strength of Key Encryption Keys (KEKs).</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FCS_CKM.1 Cryptographic Key Generation
            <h:br/>
            FCS_COP.1 Cryptographic Operation
            <h:br/>
            FCS_RBG.1 Random Bit Generation
            <h:br/>
          </dependencies>
          <f-element id="fel-kek-asym">
            <title>The TSF shall use  <selectables><selectable id="s-kek-asym">asymmetric KEKs of <assignable>security strength greater than or equal to 192 bits</assignable> security strength</selectable><selectable id="s-kek-sym">symmetric KEKs of 256-bit security strength corresponding to at least the security strength of the keys encrypted by the KEK</selectable></selectables>. </title>
            <ext-comp-def-title>
              <title>The TSF shall use <assignable>description of KEKs</assignable>.</title>
            </ext-comp-def-title>
            <note role="application">The ST author selects all applicable KEK types implemented by
              the TOE.</note>
          </f-element>
          <f-element id="fel-kek-gen">
            <title>
              The TSF shall generate all KEKs using one of the following methods:
              <h:ul>
                <h:li>Derive the KEK from a Password Authentication Factor according to
                    FCS_CKM_EXT.8 and</h:li>
              </h:ul>
              <selectables linebreak="yes">
                <selectable id="fcs_ckm_ext.3.2_1">Generate the KEK using an RBG that meets this profile (as specified in FCS_RBG.1)</selectable>
                <selectable id="fcs_ckm_ext.3.2_2">Generate the KEK using a key generation scheme that meets this profile (as specified in FCS_CKM.1/AKG or FCS_CKM.1/SKG)</selectable>
                <selectable id="fcs_ckm_ext.3.2_3">Combine the KEK from other KEKs in a way that preserves the effective entropy of each factor by <selectables><selectable id="fcs_ckm_ext.3.2_4">using an XOR operation</selectable><selectable id="fcs_ckm_ext.3.2_5">concatenating the keys and using a KDF (as described in SP 800-108)</selectable><selectable id="fcs_ckm_ext.3.2_6">concatenating the keys and using a KDF (as described in SP 800-56C)</selectable><selectable id="fcs_ckm_ext.3.2_7">encrypting one key with another</selectable></selectables></selectable>
              </selectables>.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall generate all KEKs using one of the following methods:
                <h:ul>
                  <h:li>Derive the KEK from a Password Authentication Factor according to
                  FCS_COP.1.1 and</h:li>
                </h:ul>
                <selectables linebreak="yes">
                  <selectable>Generate the KEK using an RBG that meets this profile (as specified in
                    FCS_RBG.1)</selectable>
                  <selectable>Generate the KEK using a key generation scheme that meets this profile
                    (as specified in FCS_CKM.1/AKG or FCS_CKM.1/SKG)</selectable>
                  <selectable>
                    Combine the KEK from other KEKs in a way that preserves the effective
                    entropy of each factor by
                    <selectables>
                      <selectable>using an XOR operation</selectable>
                      <selectable>concatenating the keys and using a KDF (as described in SP
                        800-108)</selectable>
                      <selectable>concatenating the keys and using a KDF (as described in SP
                        800-56C)</selectable>
                      <selectable>encrypting one key with another</selectable>
                    </selectables>
                  </selectable>
                </selectables>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              The conditioning of passwords is performed in accordance with
              FCS_CKM_EXT.8.
              <h:br/>
              <h:br/>
              It is expected that key generation derived
              from conditioning, using an RBG or generation scheme, and through combination, will
              each be necessary to meet the requirements set out in this document. In particular,
              <xref to="Keys"/>
              has KEKs of each type: KEK_3 is generated, KEK_1 is derived
              from a Password Authentication Factor, and KEK_2 is combined from two KEKs. In
              <xref to="Keys"/>, KEK_3 may either be a symmetric key generated from an RBG or an
              asymmetric key generated using a key generation scheme according to FCS_CKM.1/AKG.
              <h:br/>
              <h:br/>
              If combined, the ST author should describe which method of
              combination is used in order to justify that the effective entropy of each factor is
              preserved.
              <h:br/>
              <h:br/>
              SP 800-56C specifies a two-step key derivation procedure that
              employs an extraction-then-expansion technique for deriving keying material from a
              shared secret generated during a key establishment scheme. The Randomness Extraction
              step as described in Section 5 of SP 800-56C is followed by Key Expansion using the
              key derivation functions defined in SP 800-108 (as described in Section 6 of SP
              800-56C).
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the key hierarchy section of the TSS to ensure that
                the formation of all KEKs are described and that the key sizes match that described
                by the ST author. The evaluator shall examine the key hierarchy section of the TSS
                to ensure that each key (DEKs, software-based key storage, and KEKs) is encrypted by
                keys of equal or greater security strength using one of the selected
                methods.
                <h:br/>
                <h:br/>
                The evaluator shall review the TSS to verify that it
                contains a description of the conditioning used to derive KEKs. This description must
                include the size and storage location of salts. This activity may be performed in
                combination with that for FCS_CKM_EXT.8.
                <h:br/>
                <h:br/>
                (conditional) If
                the symmetric KEK is generated by an RBG, the evaluator shall review the TSS to
                determine that it describes how the functionality described by FCS_RBG.1 is
                invoked. The evaluator uses the description of the RBG functionality in
                FCS_RBG.1 or documentation available for the operational environment to
                determine that the key size being requested is greater than or equal to the key size
                and mode to be used for the encryption/decryption of the data.
                <h:br/>
                <h:br/>
                (conditional) If the KEK is generated according to an asymmetric key scheme, the
                evaluator shall review the TSS to determine that it describes how the functionality
                described by FCS_CKM.1/AKG is invoked. The evaluator uses the description of the key
                generation functionality in FCS_CKM.1/AKG or documentation available for the operational
                environment to determine that the key strength being requested is greater than or
                equal to 112 bits.
                <h:br/>
                <h:br/>
                (conditional) If the KEK is formed from a
                combination, the evaluator shall verify that the TSS describes the method of
                combination and that this method is either an XOR, a KDF, or
                encryption.
                <h:br/>
                <h:br/>
                (conditional) If a KDF is used, the evaluator shall
                ensure that the TSS includes a description of the key derivation function and shall
                verify the key derivation uses an approved derivation mode and key expansion
                algorithm according to SP 800-108.
                <h:br/>
                <h:br/>
                (conditional) If
                <xref to="s-dek-800-56"/>
                is selected,
                the evaluator shall ensure the TSS includes a description of the randomness
                extraction step. The description must include
                <h:ul>
                  <h:li>How an approved untruncated MAC function is being used for the randomness
                    extraction step and the evaluator must verify the TSS describes that the output
                    length (in bits) of the MAC function is at least as large as the targeted
                    security strength (in bits) of the parameter set employed by the key
                    establishment scheme (see Tables 1-3 of SP 800-56C).</h:li>
                  <h:li>How the MAC function being used for the randomness extraction step is
                    related to the PRF used in the key expansion and verify the TSS description
                    includes the correct MAC function:</h:li>
                  <h:ul>
                    <h:li>If an HMAC-hash is used in the randomness extraction step, then the same
                      HMAC-hash (with the same hash function hash) is used as the PRF in the key
                      expansion step.</h:li>
                    <h:li>If an AES-CMAC (with key length 128, 192, or 256 bits) is used in the
                      randomness extraction step, then AES-CMAC with a 128-bit key is used as the
                      PRF in the key expansion step.</h:li>
                  </h:ul>
                  <h:li>The lengths of the salt values being used in the randomness extraction
                    step and the evaluator shall verify the TSS description includes correct salt
                    lengths:</h:li>
                  <h:ul>
                    <h:li>If an HMAC-hash is being used as the MAC, the salt length can be any
                      value up to the maximum bit length permitted for input to the hash function
                      hash.</h:li>
                    <h:li>If an AES-CMAC is being used as the MAC, the salt length shall be the
                      same length as the AES key (i.e., 256 bits).</h:li>
                  </h:ul>
                </h:ul>
                <h:br/>
                The evaluator shall also ensure that the documentation of the product's encryption key
                management is detailed enough that, after reading, the product's key management hierarchy is clear 
                and that it meets the requirements to ensure the keys are adequately protected. The evaluator shall ensure
                that the documentation includes both an essay and one or more diagrams. Note that this may also be documented as 
                separate proprietary evidence rather than being included in the TSS.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>If a KDF is used, the evaluator shall perform one or more of the following tests to verify the correctness of the key derivation function, depending on the modes that are supported. <xref to="KDF"/> maps the data fields to the notations used in SP 800-108 and SP 800-56C. <h:br/> <h:br/> <h:b><ctr ctr-type="Table" id="KDF">: Notations used in SP 800-108 and SP 800-56C</ctr></h:b> <h:br/> <h:table><h:tr class="header"><h:td>Data Fields</h:td><h:td colspan="2">Notations</h:td></h:tr><h:tr class="header"><h:td/><h:td>SP 800-108</h:td><h:td>SP
                      800-56C</h:td></h:tr><h:tr><h:td>Pseudorandom
                      function</h:td><h:td>PRF</h:td><h:td>PRF</h:td></h:tr><h:tr><h:td>Counter
                    length</h:td><h:td>r</h:td><h:td>r</h:td></h:tr><h:tr><h:td>Length of output of
                      PRF</h:td><h:td>h</h:td><h:td>h</h:td></h:tr><h:tr><h:td>Length of derived keying
                      material</h:td><h:td>L</h:td><h:td>L</h:td></h:tr><h:tr><h:td>Length of input
                      values</h:td><h:td>I_length</h:td><h:td>I_length</h:td></h:tr><h:tr><h:td>Pseudorandom input values I</h:td><h:td>K<h:sub>1</h:sub>
                      (key derivation key)</h:td><h:td>Z (shared secret)</h:td></h:tr><h:tr><h:td>Pseudorandom salt
                      values</h:td><h:td>n/a</h:td><h:td>s</h:td></h:tr><h:tr><h:td>Randomness extraction
                      MAC</h:td><h:td>n/a</h:td><h:td>MAC</h:td></h:tr></h:table> <h:br/> <h:br/> <h:b>Counter Mode Tests:</h:b> <h:br/> <h:br/>The evaluator shall determine the following characteristics of the key derivation function: <h:ul><h:li>One or more pseudorandom functions that are supported by the
                    implementation (PRF).</h:li> <h:li>One or more of the values {8, 16, 24, 32} that equal the length of the
                    binary representation of the counter (r).</h:li> <h:li>The length (in bits) of the output of the PRF (h).</h:li> <h:li>Minimum and maximum values for the length (in bits) of the derived keying
                    material (L). These values can be equal if only one value of L is supported.
                    These must be evenly divisible by h.</h:li> <h:li>Up to two values of L that are NOT evenly divisible by h.</h:li> <h:li>Location of the counter relative to fixed input data: before, after, or in
                    the middle.<h:ul><h:li>Counter before fixed input data: fixed input data string length (in
                        bytes), fixed input data string value.</h:li> <h:li>Counter after fixed input data: fixed input data string length (in
                        bytes), fixed input data string value.</h:li> <h:li>Counter in the middle of fixed input data: length of data before
                        counter (in bytes), length of data after counter (in bytes), value of string
                        input before counter, value of string input after counter.</h:li></h:ul></h:li> <h:li>The length (I_length) of the input values I.</h:li></h:ul> <h:br/>For each supported combination of I_length, MAC, salt, PRF, counter location, value of r, and value of L, the evaluator shall generate 10 test vectors that include pseudorandom input values I, and pseudorandom salt values. If there is only one value of L that is evenly divisible by h, the evaluator shall generate 20 test vectors for it. For each test vector, the evaluator shall supply this data to the TOE in order to produce the keying material output. <h:br/> <h:br/>The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation. <h:br/> <h:br/> <h:b>Feedback Mode Tests:</h:b> <h:br/>The evaluator shall determine the following characteristics of the key derivation function: <h:br/> <h:ul><h:li>One or more pseudorandom functions that are supported by the
                    implementation (PRF).</h:li> <h:li>The length (in bits) of the output of the PRF (h).</h:li> <h:li>Minimum and maximum values for the length (in bits) of the derived keying
                    material (L). These values can be equal if only one value of L is supported.
                    These must be evenly divisible by h.</h:li> <h:li>Up to two values of L that are NOT evenly divisible by h.</h:li> <h:li>Whether or not zero-length IVs are supported.</h:li> <h:li>Whether or not a counter is used, and if so: <h:ul><h:li>One or more of the values {8, 16, 24, 32} that equal the length of the
                        binary representation of the counter (r).</h:li> <h:li>Location of the counter relative to fixed input data: before, after,
                        or in the middle.</h:li> <h:ul><h:li>Counter before fixed input data: fixed input data string length (in
                          bytes), fixed input data string value.</h:li> <h:li>Counter after fixed input data: fixed input data string length (in
                          bytes), fixed input data string value.</h:li> <h:li>Counter in the middle of fixed input data: length of data before
                          counter (in bytes), length of data after counter (in bytes), value of
                          string input before counter, value of string input after counter.</h:li></h:ul></h:ul></h:li> <h:li>The length (I_length) of the input values I.</h:li></h:ul> <h:br/>For each supported combination of I_length, MAC, salt, PRF, counter location (if a counter is used), value of r (if a counter is used), and value of L, the evaluator shall generate 10 test vectors that include pseudorandom input values I and pseudorandom salt values. If the KDF supports zero-length IVs, five of these test vectors will be accompanied by pseudorandom IVs and the other five will use zero-length IVs. If zero-length IVs are not supported, each test vector will be accompanied by an pseudorandom IV. If there is only one value of L that is evenly divisible by h, the evaluator shall generate 20 test vectors for it. <h:br/> <h:br/>For each test vector, the evaluator shall supply this data to the TOE in order to produce the keying material output. The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation. <h:br/> <h:br/> <h:b>Double Pipeline Iteration Mode Tests:</h:b> <h:br/>The evaluator shall determine the following characteristics of the key derivation function: <h:br/> <h:ul><h:li>One or more pseudorandom functions that are supported by the
                    implementation (PRF).</h:li> <h:li>The length (in bits) of the output of the PRF (h).</h:li> <h:li>Minimum and maximum values for the length (in bits) of the derived keying
                    material (L). These values can be equal if only one value of L is supported.
                    These must be evenly divisible by h.</h:li> <h:li>Up to two values of L that are NOT evenly divisible by h.</h:li> <h:li>Whether or not a counter is used, and if so:<h:ul><h:li>One or more of the values {8, 16, 24, 32} that equal the length of the
                        binary representation of the counter (r).</h:li> <h:li>Location of the counter relative to fixed input data: before, after,
                        or in the middle. <h:ul><h:li>Counter before fixed input data: fixed input data string length
                            (in bytes), fixed input data string value.</h:li> <h:li>Counter after fixed input data: fixed input data string length (in
                            bytes), fixed input data string value.</h:li> <h:li>Counter in the middle of fixed input data: length of data before
                            counter (in bytes), length of data after counter (in bytes), value of
                            string input before counter, value of string input after
                            counter.</h:li></h:ul></h:li></h:ul></h:li> <h:li>The length (I_length) of the input values I.</h:li></h:ul> <h:br/>For each supported combination of I_length, MAC, salt, PRF, counter location (if a counter is used), value of r (if a counter is used), and value of L, the evaluator shall generate 10 test vectors that include pseudorandom input values I, and pseudorandom salt values. If there is only one value of L that is evenly divisible by h, the evaluator shall generate 20 test vectors for it. <h:br/> <h:br/>For each test vector, the evaluator shall supply this data to the TOE in order to produce the keying material output. The results from each test may either be obtained by the evaluator directly or by supplying the inputs to the implementer and receiving the results in response. To determine correctness, the evaluator shall compare the resulting values to those obtained by submitting the same inputs to a known good implementation.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM_EXT.5 TSF Wipe -->
        <f-component cc-id="fcs_ckm_ext.5" id="fcs-ckm-ext-5" name="TSF Wipe">
          <comp-lev> requires the TSF to implement a cryptographic or other mechanism to make TSF data unreadable.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>TSF wipe of protected data.</h:li>
              <h:li>TSF wipe of enterprise data.</h:li>
            </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Failure of the wipe.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            FCS_CKM.6 Timing and Event of Cryptographic Key Destruction
            <h:br/>
            FCS_RBG.1 Random Bit Generation
          </dependencies>
          <f-element id="fel-wipe-how">
            <title>
              The TSF shall wipe all protected data by
              <selectables linebreak="yes">
                <selectable id="fcs_ckm_ext.5.1_1">Cryptographically erasing the encrypted DEKs or the KEKs in non-volatile memory by following the requirements in FCS_CKM_EXT.6.2</selectable>
                <selectable id="fcs_ckm_ext.5.1_2">Overwriting all PD according to the following rules: <h:ul><h:li>For EEPROM, the destruction shall be executed by a single direct overwrite consisting of a pseudo random pattern using the TSF’s RBG (as specified in FCS_RBG.1, followed by a read-verify. </h:li><h:li>For flash memory, that is not wear-leveled, the destruction shall be executed <selectables><selectable id="fcs_ckm_ext.5.1_3">by a single direct overwrite consisting of zeros followed by a read-verify</selectable><selectable id="fcs_ckm_ext.5.1_4">by a block erase that erases the reference to memory that stores data as well as the data itself</selectable></selectables>. </h:li><h:li>For flash memory, that is wear-leveled, the destruction shall be executed <selectables><selectable id="fcs_ckm_ext.5.1_5">by a single direct overwrite consisting of zeros</selectable><selectable id="fcs_ckm_ext.5.1_6">by a block erase</selectable></selectables>. </h:li><h:li>For non-volatile memory other than EEPROM and flash, the destruction shall be executed by a single direct overwrite with a random pattern that is changed before each write. </h:li></h:ul></selectable>
              </selectables>.
            </title>
            <note role="application">Protected data is all non-TSF data, including all user or enterprise data.
			 Some or all of this data may be considered sensitive data as well.</note>
          </f-element>
          <f-element id="fel-wipe-power">
            <title>The TSF shall perform a power cycle on conclusion of the wipe procedure. </title>
            <aactivity>
              <TSS>
                The evaluator shall check to ensure the TSS describes how the device is wiped, the type of clearing procedure that is performed (cryptographic erase or overwrite) and, if overwrite is performed, the overwrite procedure (overwrite with zeros, overwrite three or more times by a different alternating pattern, overwrite with random pattern, or block erase).
                <h:br/>
                <h:br/>
                If different types of memory are used to store the data to be protected, the evaluator shall check to ensure that the TSS describes the clearing procedure in terms of the memory in which the data are stored (for example, data stored on flash are cleared by overwriting once with zeros, while data stored on the internal persistent storage device are cleared by overwriting three times with a random pattern that is changed before each write).
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall verify that the AGD guidance describes how to enable encryption, if it is not enabled by default. Additionally the evaluator shall verify that the AGD guidance describes how to initiate the wipe command.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following test may require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <h:br/>
                <h:br/>
                <testlist>
                  <test>
                    The evaluator shall perform one of the following tests. The test before and after the wipe command shall be identical. This test shall be repeated for each type of memory used to store the data to be protected.
                    <h:br/>
                    <h:br/>
                    <testlist>
                      <test><h:b>For File-based Methods:</h:b>  <h:br/> The evaluator shall enable encryption according to the AGD guidance. The evaluator shall create a user data (protected data or sensitive data) file, for example, by using an application. The evaluator shall use a tool provided by the developer to examine this data stored in memory (for example, by examining a decrypted files). The evaluator shall initiate the wipe command according to the AGD guidance provided for FMT_SMF_EXT.1. The evaluator shall use a tool provided by the developer to examine the same data location in memory to verify that the data has been wiped according to the method described in the TSS (for example, the files are still encrypted and cannot be accessed).</test>
                      <test><h:b>For Volume-based Methods:</h:b>  <h:br/> The evaluator shall enable encryption according to the AGD guidance. The evaluator shall create a unique data string, for example, by using an application. The evaluator shall use a tool provided by the developer to search decrypted data for the unique string. The evaluator shall initiate the wipe command according to the AGD guidance provided for FMT_SMF_EXT.1. The evaluator shall use a tool provided by the developer to search for the same unique string in decrypted memory to verify that the data has been wiped according to the method described in the TSS (for example, the files are still encrypted and cannot be accessed).</test>
                    </testlist>
                  </test>
                  <test>The evaluator shall cause the device to wipe and verify that the wipe concludes with a power cycle.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>
              <selectables onlyone="yes">
                <selectable>Failure of the wipe</selectable>
                <selectable>none</selectable>
              </selectables>
            </audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FCS_CKM_EXT.6 Salt Generation -->
        <f-component cc-id="fcs_ckm_ext.6" id="fcs-ckm-ext-6" name="Salt Generation">
          <comp-lev> requires the TSF to generate salts in a specified manner.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_RBG.1 Random Bit Generation</dependencies>
          <f-element id="fel-salt-gen">
            <title>The TSF shall generate all salts using an RBG that meets FCS_RBG.1. </title>
            <note role="application">
              This requirement refers only to salt generation. In the
              examples given, a salt may be used as part of the scheme/algorithm. Requirements on
              nonces or ephemeral keys are provided elsewhere, if needed. The list below is
              provided for clarity, in order to give examples of where the TSF may be generating
              cryptographic salts; it is not exhaustive nor is it intended to mandate implementation
              of all of these schemes/algorithms. Cryptographic salts are generated for various uses
              including:
              <h:ul>
                <h:li>RSASSA-PSS signature generation</h:li>
                <h:li>DSA signature generation</h:li>
                <h:li>ECDSA signature generation</h:li>
                <h:li>DH static key agreement scheme</h:li>
                <h:li>PBKDF</h:li>
                <h:li>Key Agreement Scheme in NIST SP 800-56B</h:li>
                <h:li>AES GCM</h:li>
              </h:ul>
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS contains a description regarding the
                salt generation, including which algorithms on the TOE require salts. The evaluator
                shall confirm that the salt is generated using an RBG described in FCS_RBG.1.
                For PBKDF derivation of KEKs, this evaluation activity may be performed in
                conjunction with FCS_CKM_EXT.3.2.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM_EXT.7 Cryptographic Key Establishment -->
        <f-component cc-id="fcs_ckm_ext.7" id="fcs-ckm-ext-7" name="Cryptographic Key Establishment" status="invisible">
          <comp-lev>requires the TSF to perform key establishment regardless of whether the device is locked or
            unlocked.</comp-lev>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is
            included in the PP, PP-Module, functional package or ST:
            <h:br/>
            <h:ul>
              <h:li>minimal: Success and failure of the activity;</h:li>
              <h:li>basic: The object attribute(s), and object value(s) excluding any sensitive information.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            <h:br/>
            <h:br/>
            [FDP_ITC.1 Import of User Data without Security Attributes, or
            <h:br/>
            FDP_ITC.2 Import of User Data with Security Attributes, or
            <h:br/>
            FCS_CKM.1 Cryptographic Key Generation, or
            <h:br/>
            FCS_CKM.5 Cryptographic Key Derivation, or
            <h:br/>
            FCS_CKM_EXT.8 Password-Based Key Derivation],
            <h:br/>
            [FCS_CKM_EXT.7 Cryptographic Key Distribution, or
            <h:br/>
            FCS_COP.1 Cryptographic Operation]
            <h:br/>
            FCS_CKM.6 Timing and Event of Cryptographic Key Destruction
            <h:br/>
            FCS_COP.1 Cryptographic Operation
          </dependencies>
          <f-element id="fcs_ckm_ext-7-1">
            <title>
              The TSF shall derive shared cryptographic keys with input from multiple parties in accordance 
              with specified cryptographic key agreement algorithms
              <assignable>cryptographic algorithm</assignable>
              and specified cryptographic parameters
              <assignable>cryptographic parameters</assignable>
              that meet the
              following:
              <assignable>list of standards</assignable>.
            </title>
          </f-element>
        </f-component>
        <!-- FCS_CKM_EXT.7/LOCKED Cryptographic Key Establishment (When Locked) -->
        <f-component cc-id="fcs_ckm_ext.7" id="fcs-ckm-ext-7-locked" name="Cryptographic Key Establishment (When Locked)" iteration="LOCKED">
          <f-element id="fel-key-locked">
            <title>
              The TSF shall derive shared cryptographic keys with input from multiple parties in accordance 
              with specified cryptographic key agreement algorithms
              <h:b>for the purposes of
                encrypting sensitive data received while the device is locked</h:b>.
              <selectables>
                <tabularize id="fcs-ckm-ext-7-sels" title="Allowable choices for FCS_CKM_EXT.7">
                  <textcol>Identifier</textcol>
                  <selectcol>Cryptographic Algorithm</selectcol>
                  <reqtext>and specified cryptographic parameters</reqtext>
                  <selectcol>Cryptographic Parameters</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>.
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_CKM_EXT.7/LOCKED.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-ckm-kat-kas2">
                  <col>KAS2</col>
                  <col>RSA</col>
                  <col>Modulus size <selectables><selectable id="fcs_ckm_ext.7.1_LOCKED_1">3072</selectable><selectable id="fcs_ckm_ext.7.1_LOCKED_2">4096</selectable><selectable id="fcs_ckm_ext.7.1_LOCKED_3">6144</selectable><selectable id="fcs_ckm_ext.7.1_LOCKED_4">8192</selectable></selectables> bits</col>
                  <col>NIST SP 800-56B Revision 2 (Section 8.3) [KAS2]</col>
                </selectable>
                <selectable id="sel-fcs-ckm-kat-dh">
                  <col>DH</col>
                  <col>Finite Field Cryptography Diffie-Hellman</col>
                  <col>Static domain parameters approved for <selectables><selectable id="fcs_ckm_ext.7.1_LOCKED_5">IKE Groups <selectables><selectable id="sel-kat-ffc-modp3072">MODP-3072</selectable><selectable id="sel-kat-ffc-modp4096">MODP-4096</selectable><selectable id="sel-kat-ffc-modp6144">MODP-6144</selectable><selectable id="sel-kat-ffc-modp8192">MODP-8192</selectable></selectables> </selectable><selectable id="fcs_ckm_ext.7.1_LOCKED_6">TLS Groups <selectables><selectable id="sel-kat-ffc-ffdhe3072">ffdhe3072</selectable><selectable id="sel-kat-ffc-ffdhe4096">ffdhe4096</selectable><selectable id="sel-kat-ffc-ffdhe6144">ffdhe6144</selectable><selectable id="sel-kat-ffc-ffdhe8192">ffdhe8192</selectable></selectables> </selectable></selectables></col>
                  <col>NIST SP 800-56A Revision 3 (Section 5.7.1.1) [DH]<h:p/> <selectables><selectable id="fcs_ckm_ext.7.1_LOCKED_7">RFC 3526 [IKE groups]</selectable><selectable id="fcs_ckm_ext.7.1_LOCKED_8">RFC 7919 [TLS groups]</selectable></selectables></col>
                </selectable>
                <selectable id="sel-fcs-ckm-kat-ecdh">
                  <col>ECDH</col>
                  <col>Elliptic Curve Diffie-Hellman</col>
                  <col>Elliptic Curve <selectables><selectable id="sel-exp-kat-ecdh-P384">P-384</selectable><selectable id="sel-exp-kat-ecdh-P521">P-521</selectable></selectables></col>
                  <col>NIST SP 800-56A Revision 3 (Section 5.7.1.2) [ECDH]<h:p/>NIST SP 800-186 (Section 3.2.1) [NIST Curves]</col>
                </selectable>
                <selectable id="sel-fcs-ckm-kat-ecdhed">
                  <col>ECDH-Ed</col>
                  <col>ECDH with Montgomery Curves</col>
                  <col>Domain parameters approved for elliptic curves []</col>
                  <col>RFC 7748 (Section 5) [ECDH-Ed]<h:p/>NIST SP 800-186 (Section 3.2.2) [Montgomery Curves]</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">This SFR defines the asymmetric key scheme used to protect data
              at rest as defined by FDP_DAR_EXT.2.2.</note>
            <aactivity>
              <TSS>The evaluator shall ensure that the TSS documents that the security strength of the
                material contributed by the TOE is sufficient for the security strength of the key and the
                agreement method.</TSS>
              <Guidance>There are no additional guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>KAS2</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">KAS2</h:td><h:td valign="top">RSA</h:td><h:td valign="top">Modulus Size [<h:b>selection:</h:b> 3072, 4096,
                      6144, 8192] bits</h:td><h:td valign="top">NIST SP 800-56B Revision 2 (Section 8.3) [KAS2]</h:td></h:tr></h:table> <h:p/>To test the TOE’s implementation of the of the KAS2 RSA Key Agreement scheme, the evaluator shall perform the Algorithm Functional Test and Validation Test using the following input parameters: <h:ul><h:li>RSA Private key format [Basic, Prime Factor, Chinese Remainder Theorem]</h:li> <h:li>Modulo value [3072, 4096, 6144, 8192]</h:li> <h:li>Role [initiator, responder]</h:li></h:ul> <h:p/>The evaluator shall generate a test group (i.e. set of tests) for each parameter value of the above parameter type with the largest number of supported values. For example, if the TOE supports all five Modulo values, then the evaluator shall generate five test groups. Each of the above supported parameter values must be included in at least one test group. <h:p/>Regardless of how many parameter values are supported, there must be at least two test groups. <h:p/>Half of the test groups are designated as Algorithm Functional Tests (AFT) and the remainder are designated as Validation Tests (VAT). If there is an odd number of groups, then the extra group is designated randomly as either AFT or VAT. <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each test group designated as AFT, the evaluator shall generate 10 test cases using random data (except for a fixed public exponent, if supported). The resulting shared secrets shall be compared with those generated by a known-good implementation using the same inputs. <h:p/> <h:br/> <h:i><h:b>Validation Test</h:b></h:i> <h:br/>For each test group designated as VAT, the evaluator shall generate 25 test cases are using random data (except for a fixed public exponent, if supported). Of the 25 test cases: <h:ul><h:li>Two test cases must have a shared secret with a leading nibble of 0s,</h:li> <h:li>Two test cases have modified derived key material,</h:li> <h:li>Two test cases have modified tags, if key confirmation is supported,</h:li> <h:li>Two test cases have modified MACs, if key confirmation is supported, and</h:li> <h:li>The remaining test cases are not modified.</h:li></h:ul> <h:p/>To determine correctness, the evaluator shall confirm that the resulting 25 shared secrets correspond as expected for both the modified and unmodified values. <h:p/> <h:br/> <h:b>FFC Diffie-Hellman Key Agreement</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">DH</h:td><h:td valign="top">Finite Field Cryptography Diffie-Hellman</h:td><h:td valign="top">Static domain parameters approved for [<h:b>selection:</h:b>
                      IKE groups [<h:b>selection:</h:b> MODP-3072, MODP-4096,
                      MODP-6144, MODP-8192], TLS groups [<h:b>selection:</h:b> 
                      ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192]]]</h:td><h:td valign="top">NIST SP 800-56A Revision 3 (Section 5.7.1.1) [DH]<h:p/>
                      [<h:b>selection:</h:b> RFC 3526 [IKE Groups], RFC 7919 [TLS Groups]]</h:td></h:tr></h:table> <h:p/>To test the TOE’s implementation of FFC Diffie-Hellman Key Agreement, the evaluator shall perform the Algorithm Functional Test and Validation Test using the following input parameters: <h:ul><h:li>Domain Parameter Group [MODP-3072, MODP-4096, MODP-6144, MODP-8192, 
                    ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each supported domain parameter group, the evaluator shall generate 10 test cases by generating the initiator and responder secret keys using random data, calculating the responder public key, and creating the shared secret. The resulting shared secrets shall be compared with those generated by a known-good implementation using the same inputs. <h:p/> <h:br/> <h:i><h:b>Validation Test</h:b></h:i> <h:br/>For each supported combination of the above parameters the evaluator shall generate 15 Diffie Hellman initiator/responder key pairs using the key generation function of a known-good implementation. For each set of key pairs, the evaluator shall modify five initiator private key values. The remaining key values are left unchanged (i.e., correct). To determine correctness, the evaluator shall confirm that the 15 shared secrets correspond as expected for both the modified and unmodified inputs. <h:p/> <h:br/> <h:b>Elliptic Curve Diffie-Hellman Key Agreement</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ECDH</h:td><h:td valign="top">Elliptic Curve Diffie-Hellman</h:td><h:td valign="top">Elliptic Curve [<h:b>selection:</h:b> P-384, P-521</h:td><h:td valign="top">NIST SP 800-56A Revision 3 (Section 5.7.1.2) [ECDH]<h:p/>
                      NIST SP 800-186 (Section 3.2.1) [NIST Curves]</h:td></h:tr></h:table> <h:p/>To test the TOE’s implementation of Elliptic Curve Diffie-Hellman Key Agreement, the evaluator shall perform the Algorithm Functional Test and Validation Test using the following input parameters: <h:ul><h:li>Elliptic Curve [P-384, P-521]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each supported Elliptic Curve the evaluator shall generate 10 test cases by generating the initiator and responder secret keys using random data, calculating the responder public key, and creating the shared secret. The resulting shared secrets shall be compared with those generated by a known-good implementation using the same inputs. <h:p/> <h:br/> <h:i><h:b>Validation Test</h:b></h:i> <h:br/>For each supported Elliptic Curve the evaluator shall generate 15 Diffie Hellman initiator/responder key pairs using the key generation function of a known-good implementation. For each set of key pairs, the evaluator shall modify five initiator private key values. The remaining key values are left unchanged (i.e., correct). To determine correctness, the evaluator shall confirm that the 15 shared secrets correspond as expected for the modified and unmodified values. <h:br/> <h:b>Curve25519 Key Establishment Schemes</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ECDH-Ed</h:td><h:td valign="top">ECDH with Montgomery Curves</h:td><h:td valign="top">Domain parameters approved for elliptic curves [<h:i>curve25519</h:i>]</h:td><h:td valign="top">RFC 7748 (Section 5) [ECDH-Ed]<h:p/>
                      NIST SP 800-186 (Section 3.2.2) [Montgomery Curves]</h:td></h:tr></h:table> <h:p/> <h:br/> <h:i><h:b>Curve25519 Key Establishment Schemes</h:b></h:i> <h:br/>The evaluator shall verify a TOE's implementation of the key agreement scheme using the following Function and Validity tests. These validation tests for each key agreement scheme verify that a TOE has implemented the components of the key agreement scheme according to the specification. These components include the calculation of the shared secret K and the hash of K. <h:p/> <h:br/> <h:i><h:b>Function Test</h:b></h:i> <h:br/>The Function test verifies the ability of the TOE to implement the key agreement schemes correctly. To conduct this test the evaluator shall generate or obtain test vectors from a known good implementation of the TOE supported schemes. For each supported key agreement role and hash function combination, the tester shall generate 10 sets of public keys. These keys are static, ephemeral or both depending on the scheme being tested. <h:p/>The evaluator shall obtain the shared secret value K, and the hash of K. <h:p/>The evaluator shall verify the correctness of the TSF’s implementation of a given scheme by using a known good implementation to calculate the shared secret value K and compare the hash generated from this value. <h:p/> <h:br/> <h:i><h:b>Validation Test</h:b></h:i> <h:br/>The Validity test verifies the ability of the TOE to recognize another party’s valid and invalid key agreement results. To conduct this test, the evaluator generates a set of 30 test vectors consisting of data sets including the evaluator’s public keys and the TOE’s public/private key pairs. <h:p/>The evaluator shall inject an error in some of the test vectors to test that the TOE recognizes invalid key agreement results caused by the following fields being incorrect: the shared secret value K or the hash of K. At least two of the test vectors shall remain unmodified and therefore should result in valid key agreement results (they should pass). <h:p/>The TOE shall use these modified test vectors to emulate the key agreement scheme using the corresponding parameters. The evaluator shall compare the TOE’s results with the results using a known good implementation verifying that the TOE detects these errors.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM_EXT.7/UNLOCKED Cryptographic Key Establishment (When Unlocked) -->
        <f-component cc-id="fcs_ckm_ext.7" id="fcs-ckm-ext-7-unlocked" name="Cryptographic Key Establishment (When Unlocked)" iteration="UNLOCKED" status="feat-based">
          <depends on="key-agreement-support"/>
          <f-element id="fcs-ckm-ext-7e1">
            <title>
              The TSF shall derive shared cryptographic keys with input from multiple parties in accordance 
              with specified cryptographic key agreement algorithms
              <selectables>
                <tabularize id="fcs-ckm-ext-7-sels" title="Allowable choices for FCS_CKM_EXT.7">
                  <textcol>Identifier</textcol>
                  <selectcol>Cryptographic algorithm</selectcol>
                  <reqtext>and specified cryptographic parameters</reqtext>
                  <selectcol>Cryptographic parameters</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of standards</selectcol>
                  <reqtext>.
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_CKM_EXT.7/UNLOCKED.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-ckm-kat-kas2">
                  <col>KAS2</col>
                  <col>RSA</col>
                  <col>Modulus size <selectables><selectable id="fcs_ckm_ext.7.1_UNLOCKED_1">3072</selectable><selectable id="fcs_ckm_ext.7.1_UNLOCKED_2">4096</selectable><selectable id="fcs_ckm_ext.7.1_UNLOCKED_3">6144</selectable><selectable id="fcs_ckm_ext.7.1_UNLOCKED_4">8192</selectable></selectables> bits</col>
                  <col>NIST SP 800-56B Revision 2 (Section 8.3) [KAS2]</col>
                </selectable>
                <selectable id="sel-fcs-ckm-kat-dh">
                  <col>DH</col>
                  <col>Finite Field Cryptography Diffie-Hellman</col>
                  <col>Static domain parameters approved for <selectables><selectable id="fcs_ckm_ext.7.1_UNLOCKED_5">IKE Groups <selectables><selectable id="sel-kat-ffc-modp3072">MODP-3072</selectable><selectable id="sel-kat-ffc-modp4096">MODP-4096</selectable><selectable id="sel-kat-ffc-modp6144">MODP-6144</selectable><selectable id="sel-kat-ffc-modp8192">MODP-8192</selectable></selectables> </selectable><selectable id="fcs_ckm_ext.7.1_UNLOCKED_6">TLS Groups <selectables><selectable id="sel-kat-ffc-ffdhe3072">ffdhe3072</selectable><selectable id="sel-kat-ffc-ffdhe4096">ffdhe4096</selectable><selectable id="sel-kat-ffc-ffdhe6144">ffdhe6144</selectable><selectable id="sel-kat-ffc-ffdhe8192">ffdhe8192</selectable></selectables> </selectable></selectables></col>
                  <col>NIST SP 800-56A Revision 3 (Section 5.7.1.1) [DH]<h:p/> <selectables><selectable id="fcs_ckm_ext.7.1_UNLOCKED_7">RFC 3526 [IKE groups]</selectable><selectable id="fcs_ckm_ext.7.1_UNLOCKED_8">RFC 7919 [TLS groups]</selectable></selectables></col>
                </selectable>
                <selectable id="sel-fcs-ckm-kat-ecdh">
                  <col>ECDH</col>
                  <col>Elliptic Curve Diffie-Hellman</col>
                  <col>Elliptic Curve <selectables><selectable id="sel-exp-kat-ecdh-P384">P-384</selectable><selectable id="sel-exp-kat-ecdh-P521">P-521</selectable></selectables></col>
                  <col>NIST SP 800-56A Revision 3 (Section 5.7.1.2) [ECDH]<h:p/>NIST SP 800-186 (Section 3.2.1) [NIST Curves]</col>
                </selectable>
              </selectables>
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall derive shared cryptographic keys with input from multiple parties in accordance 
                with specified cryptographic key agreement algorithms
                <assignable>cryptographic algorithm</assignable>
                and specified cryptographic parameters
                <assignable>cryptographic parameters</assignable>
                that meet the
                following:
                <assignable>list of standards</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              This SFR is claimed if the TSF supports key agreement schemes as a method of key establishment for trusted channels. This will generally apply to all conformant TOEs, except in the rare (but possible) case where only key encapsulation is used.
              <h:p/>
              All of the above algorithms with the selectable parameters are CNSA 1.0 compliant.
              <h:p/>
              This SFR must be included in the ST if key agreement or transport is a service provided by the TOE to 
              tenant software, or if they are used by the TOE itself to support or implement PP-specified security 
              functionality.
              <h:p/>
            </note>
            <aactivity>
              <TSS>The evaluator shall ensure that the TSS documents that the security strength of the
                material contributed by the TOE is sufficient for the security strength of the key and the
                agreement method.</TSS>
              <Guidance>There are no additional Guidance evaluation activities for this component.</Guidance>
              <Tests>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>KAS2</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">KAS2</h:td><h:td valign="top">RSA</h:td><h:td valign="top">Modulus Size [<h:b>selection:</h:b> 3072, 4096,
                      6144, 8192] bits</h:td><h:td valign="top">NIST SP 800-56B Revision 2 (Section 8.3) [KAS2]</h:td></h:tr></h:table> <h:p/>To test the TOE’s implementation of the of the KAS2 RSA Key Agreement scheme, the evaluator shall perform the Algorithm Functional Test and Validation Test using the following input parameters: <h:ul><h:li>RSA Private key format [Basic, Prime Factor, Chinese Remainder Theorem]</h:li> <h:li>Modulo value [3072, 4096, 6144, 8192]</h:li> <h:li>Role [initiator, responder]</h:li></h:ul> <h:p/>The evaluator shall generate a test group (i.e. set of tests) for each parameter value of the above parameter type with the largest number of supported values. For example, if the TOE supports all five Modulo values, then the evaluator shall generate five test groups. Each of the above supported parameter values must be included in at least one test group. <h:p/>Regardless of how many parameter values are supported, there must be at least two test groups. <h:p/>Half of the test groups are designated as Algorithm Functional Tests (AFT) and the remainder are designated as Validation Tests (VAT). If there is an odd number of groups, then the extra group is designated randomly as either AFT or VAT. <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each test group designated as AFT, the evaluator shall generate 10 test cases using random data (except for a fixed public exponent, if supported). The resulting shared secrets shall be compared with those generated by a known-good implementation using the same inputs. <h:p/> <h:br/> <h:i><h:b>Validation Test</h:b></h:i> <h:br/>For each test group designated as VAT, the evaluator shall generate 25 test cases are using random data (except for a fixed public exponent, if supported). Of the 25 test cases: <h:ul><h:li>Two test cases must have a shared secret with a leading nibble of 0s,</h:li> <h:li>Two test cases have modified derived key material,</h:li> <h:li>Two test cases have modified tags, if key confirmation is supported,</h:li> <h:li>Two test cases have modified MACs, if key confirmation is supported, and</h:li> <h:li>The remaining test cases are not modified.</h:li></h:ul> <h:p/>To determine correctness, the evaluator shall confirm that the resulting 25 shared secrets correspond as expected for both the modified and unmodified values. <h:p/> <h:br/> <h:b>FFC Diffie-Hellman Key Agreement</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">DH</h:td><h:td valign="top">Finite Field Cryptography Diffie-Hellman</h:td><h:td valign="top">Static domain parameters approved for [<h:b>selection:</h:b>
                      IKE groups [<h:b>selection:</h:b> MODP-3072, MODP-4096,
                      MODP-6144, MODP-8192], TLS groups [<h:b>selection:</h:b> 
                      ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192]]]</h:td><h:td valign="top">NIST SP 800-56A Revision 3 (Section 5.7.1.1) [DH]<h:p/>
                      [<h:b>selection:</h:b> RFC 3526 [IKE Groups], RFC 7919 [TLS Groups]]</h:td></h:tr></h:table> <h:p/>To test the TOE’s implementation of FFC Diffie-Hellman Key Agreement, the evaluator shall perform the Algorithm Functional Test and Validation Test using the following input parameters: <h:ul><h:li>Domain Parameter Group [MODP-3072, MODP-4096, MODP-6144, MODP-8192, 
                    ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each supported domain parameter group, the evaluator shall generate 10 test cases by generating the initiator and responder secret keys using random data, calculating the responder public key, and creating the shared secret. The resulting shared secrets shall be compared with those generated by a known-good implementation using the same inputs. <h:p/> <h:br/> <h:i><h:b>Validation Test</h:b></h:i> <h:br/>For each supported combination of the above parameters the evaluator shall generate 15 Diffie Hellman initiator/responder key pairs using the key generation function of a known-good implementation. For each set of key pairs, the evaluator shall modify five initiator private key values. The remaining key values are left unchanged (i.e., correct). To determine correctness, the evaluator shall confirm that the 15 shared secrets correspond as expected for both the modified and unmodified inputs. <h:p/> <h:br/> <h:b>Elliptic Curve Diffie-Hellman Key Agreement</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ECDH</h:td><h:td valign="top">Elliptic Curve Diffie-Hellman</h:td><h:td valign="top">Elliptic Curve [<h:b>selection:</h:b> P-384, P-521</h:td><h:td valign="top">NIST SP 800-56A Revision 3 (Section 5.7.1.2) [ECDH]<h:p/>
                      NIST SP 800-186 (Section 3.2.1) [NIST Curves]</h:td></h:tr></h:table> <h:p/>To test the TOE’s implementation of Elliptic Curve Diffie-Hellman Key Agreement, the evaluator shall perform the Algorithm Functional Test and Validation Test using the following input parameters: <h:ul><h:li>Elliptic Curve [P-384, P-521]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each supported Elliptic Curve the evaluator shall generate 10 test cases by generating the initiator and responder secret keys using random data, calculating the responder public key, and creating the shared secret. The resulting shared secrets shall be compared with those generated by a known-good implementation using the same inputs. <h:p/> <h:br/> <h:i><h:b>Validation Test</h:b></h:i> <h:br/>For each supported Elliptic Curve the evaluator shall generate 15 Diffie Hellman initiator/responder key pairs using the key generation function of a known-good implementation. For each set of key pairs, the evaluator shall modify five initiator private key values. The remaining key values are left unchanged (i.e., correct). To determine correctness, the evaluator shall confirm that the 15 shared secrets correspond as expected for the modified and unmodified values. <h:p/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM_EXT.8 Password-Based Key Derivation -->
        <f-component cc-id="fcs_ckm_ext.8" id="sfr-fcs-ckm-ext-8" name="Password-Based Key Derivation">
          <comp-lev>requires that password-based key derivation be performed in accordance with specified standards.</comp-lev>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is
            included in the PP, PP-Module, functional package or ST:
            <h:br/>
            <h:ul>
              <h:li>minimal: Success and failure of the activity;</h:li>
              <h:li>basic: The object attribute(s), and object value(s) excluding any sensitive information.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            <h:br/>
            <h:br/>
            [FCS_CKM.2 Cryptographic Key Distribution, or
            <h:br/>
            FCS_COP.1 Cryptographic Operation]
            <h:br/>
            FCS_CKM_EXT.7 Cryptographic Key Establishment],
            <h:br/>
            FCS_CKM.6 Timing and Event of Cryptographic Key Destruction
          </dependencies>
          <f-element id="fcs-ckm-ext-8-1">
            <title>
              The TSF shall perform password-based key derivation functions in accordance with a specified 
              cryptographic algorithm [HMAC-
              <selectables>
                <selectable id="fcs_ckm_ext.8.1_1">SHA-384</selectable>
                <selectable id="fcs_ckm_ext.8.1_2">SHA-512</selectable>
              </selectables>, with iteration count of
              <assignable>number of iterations</assignable>
              using a randomly generated salt of length
              <assignable>equal to or greater than 128</assignable>
              and output cryptographic key sizes
              <selectables>
                <selectable id="fcs_ckm_ext.8.1_5">256</selectable>
                <selectable id="fcs_ckm_ext.8.1_6">384</selectable>
                <selectable id="fcs_ckm_ext.8.1_7">512</selectable>
              </selectables>
              bits that meet the following standard: [NIST SP 800-132 (Section 5.3) [PBKDF2]].
            </title>
            <note role="application">
              NIST recommends a minimum “number of iterations” of 1000 but prefers the largest number feasible
              given performance constraints.
              <h:p/>
              NIST recommends that the randomly generated portion of the salt have length of at least 128 bits 
              and must be derived from Random Bit Generation.
              <h:p/>
              If this SFR is claimed, then FCS_COP.1/KeyedHash and FCS_RBG.1 must also be claimed.
              <h:p/>
              For CNSA 1.0 and 2.0 compliance, only SHA-384 or SHA-512 may be used.
            </note>
            <aactivity>
              <TSS>
                The evaluator must verify that the TSS documents that the selection of the keyed hash
                algorithm, iteration count, length of salt, and other mitigations are sufficient for the
                security strength of the key derived.
                <h:p/>
                The evaluator shall examine the TSS to verify that the salt is generated in accordance with the
                relevant specification.
                <h:p/>
                The evaluator shall examine the TSS to determine whether the TOE implements other 
                mitigations against password-exhaustion attacks. Examples include the use of 
                interface-based mitigations and secret salts.
              </TSS>
              <Guidance/>
              <Tests>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/>To test the TOE’s ability to derive cryptographic keys from a password using PBKDF2 the evaluator shall perform the Algorithm Functional Test using the following input parameters: <h:ul><h:li>HMAC algorithms [SHA-384, SHA-512]</h:li> <h:li>Iteration count [1-10000000]</h:li> <h:li>Derived Key size [256, 384, 512] bits</h:li> <h:li>Password length [8-128] bytes</h:li> <h:li>Salt length [128-4096] bits in multiples of 8.</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>For each supported HMAC algorithm, the evaluator shall generate 50 test cases using supported values for the above parameters such that <h:ul><h:li>All supported derived key sizes are tested at least 10 times, </h:li> <h:li>Iteration counts are random values between the supported minimum and maximum
                    values, with the supported minimum and maximum tested at least once each, </h:li> <h:li>Passwords are random byte strings representing upper- and lower-case letters of random
                    supported lengths such that the minimum and maximum lengths are tested at least once, and </h:li> <h:li>Salts are random values between the supported minimum and maximum lengths such that
                    the supported minimum and maximum lengths are both tested at least once. </h:li></h:ul> <h:p/>The evaluator shall compare the resulting keys from each test case with keys derived using a known-good implementation with the same input parameters.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/AEAD Cryptographic Operation – Authenticated Encryption with Associated Data -->
        <f-component cc-id="fcs_cop.1" id="sfr-fcs-cop-1-aead" name="Cryptographic Operation – Authenticated Encryption with Associated Data" iteration="AEAD">
          <f-element id="fcs-cop-1e1-aead">
            <title>
              The TSF shall perform [<h:i>authenticated encryption with associated data</h:i>] in accordance with a specified 
              cryptographic algorithm
              <selectables>
                <tabularize id="fcs-cop-aead-sels" title="Allowable choices for FCS_COP.1/AEAD">
                  <textcol>Identifier</textcol>
                  <reqtext/>
                  <selectcol>Cryptographic algorithm</selectcol>
                  <reqtext>and cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic key sizes</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_COP.1/AEAD.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-aead-aes-ccm">
                  <col>AES-CCM</col>
                  <col>AES in CCM mode with unpredictable, non-repeating nonce, minimum size of 64 bits</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_AEAD_1">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_AEAD_2">FIPS PUB 197</selectable></selectables> [AES]<h:p/> <selectables><selectable id="fcs_cop.1.1_AEAD_3">ISO/IEC 19772:2020 (Clause 7)</selectable><selectable id="fcs_cop.1.1_AEAD_4">NIST SP 800-38C</selectable></selectables> [CCM]</col>
                </selectable>
                <selectable id="sel-fcs-cop-aead-aes-gcm">
                  <col>AES-GCM</col>
                  <col>AES in GCM mode with non-repeating IVs using <selectables><selectable id="fcs_cop.1.1_AEAD_5">deterministic</selectable><selectable id="fcs_cop.1.1_AEAD_6">RBG-based</selectable></selectables>, IV construction; the tag must be of length <selectables><selectable id="fcs_cop.1.1_AEAD_7">96</selectable><selectable id="fcs_cop.1.1_AEAD_8">104</selectable><selectable id="fcs_cop.1.1_AEAD_9">112</selectable><selectable id="fcs_cop.1.1_AEAD_10">120</selectable><selectable id="fcs_cop.1.1_AEAD_11">128</selectable></selectables> bits.</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_AEAD_12">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_AEAD_13">FIPS PUB 197</selectable></selectables> [AES]<h:p/> <selectables><selectable id="fcs_cop.1.1_AEAD_14">ISO/IEC 19772:2020 (Clause 10)</selectable><selectable id="fcs_cop.1.1_AEAD_15">NIST SP 800-38D</selectable></selectables> [GCM]</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">
              <h:p/>
              The use of 256-bit keys for AES encryption is required by CNSA 1.0 and 2.0.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to ensure that it describes the construction of any IVs,
                nonces, and tags in conformance with the relevant specifications.
                <h:p/>
                If a CCM mode algorithm is selected, then the evaluator shall examine the TOE summary
                specification to confirm that it describes how the nonce is generated and that the same nonce is
                never reused to encrypt different plaintext pairs under the same key.
                <h:p/>
                If a GCM mode algorithm is selected, then the evaluator shall examine the TOE summary
                specification to confirm that it describes how the IV is generated and that the same IV is never
                reused to encrypt different plaintext pairs under the same key. The evaluator shall also confirm
                that for each invocation of GCM, the length of the plaintext is at most (2
                <h:sup>32</h:sup>)-2 blocks.
              </TSS>
              <Guidance/>
              <Tests>The following tests may require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products. <h:p/>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>AES-CCM</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">AES-CCM </h:td><h:td valign="top">AES in CCM mode with nonrepeating nonce, minimum size
                      of 64 bits</h:td><h:td valign="top">256 bits</h:td><h:td valign="top">
                      [<h:b>selection:</h:b> ISO/IEC 18033-3:2010 (Subclause 5.2),
                      FIPS PUB 197] [AES]<h:p/>
                      [<h:b>selection:</h:b>  ISO/IEC 19772:2020 (Clause 7), NIST SP 800-38C] [CCM]</h:td></h:tr></h:table> <h:p/>To test the TOE’s implementation of AES-CCM authenticated encryption functionality the evaluator shall perform the Algorithm Functional Tests described below using the following input parameters: <h:ul><h:li>Key Size [256] bits</h:li> <h:li>Associated data size [0-65536] bits in increments of 8</h:li> <h:li>Payload size [0-256] bits in increments of 8</h:li> <h:li>IV/Nonce size [64-104] bits in increments of 8</h:li> <h:li>Tag size [32-128] bits in increments of 16</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Tests</h:b> <h:p/>Unless otherwise specified, the following tests should use random data, a tag size of 128 bits, IV/Nonce size of 104 bits, payload size of 256 bits, and associated data size of 256 bits. If any of these values are not supported, any supported value may be used. The evaluator shall compare the output from each test case against results generated by a known-good implementation with the same input parameters. <h:p/> <h:br/> <h:b><h:i>Variable Associated Data Test</h:i></h:b> <h:p/>For each claimed key size, and for each supported associated data size from 0 through 256 bits in increments of 8 bits, the TOE must be tested by encrypting 10 test cases using all random data. In addition, for each key size, the TOE must be tested by encrypting 10 cases with associated data lengths of 65536 bits, if supported. <h:p/> <h:br/> <h:b><h:i>Variable Payload Test</h:i></h:b> <h:p/>For each claimed key size, and for each supported payload size from 0 through 256 bits in increments of 8 bits, the TOE must be tested by encrypting 10 test cases using all random data. <h:p/> <h:br/> <h:b><h:i>Variable Nonce Test</h:i></h:b> <h:p/>For each claimed key size, and for each supported IV/Nonce size from 64 through 104 bits in increments of 8 bits, the TOE must be tested by encrypting 10 test cases using all random data. <h:p/> <h:br/> <h:b><h:i>Variable Tag Test</h:i></h:b> <h:p/>For each claimed key size, and for each supported tag size from 32 through 128 bits in increments of 16 bits, the TOE must be tested by encrypting 10 test cases using all random data. <h:p/> <h:br/> <h:b><h:i>Decryption Verification Test</h:i></h:b> <h:p/>For each claimed key size, for each supported associated data size from 0 through 256 bits in increments of 8 bits, for each supported payload size from 0 through 256 bits in increments of 8 bits, for each supported IV/Nonce size from 64 through 104 bits in increments of 8 bits, and for each supported tag size from 32 through 128 bits in increments of 16 bits, the TOE must be tested by decrypting 10 test cases using all random data. <h:p/> <h:br/> <h:b>AES-GCM</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">AES-GCM </h:td><h:td valign="top">AES in GCM mode with nonrepeating IVs using 
                      [<h:b>selection:</h:b> deterministic, RBG-based] IV construction; 
                      the tag must be of length [<h:b>selection:</h:b> 96, 104, 112, 120, or 128] bits.</h:td><h:td valign="top">256 bits</h:td><h:td valign="top">
                      [<h:b>selection:</h:b> ISO/IEC 18033-3:2010 (Subclause 5.2),
                      FIPS PUB 197] [AES]<h:p/>
                      [<h:b>selection:</h:b>  ISO/IEC 19772:2020 (Clause 10), NIST SP 800-38D] [GCM]</h:td></h:tr></h:table> <h:p/>To test the TOE’s implementation of AES-GCM authenticated encryption functionality the evaluator shall perform the Encryption Algorithm Functional Tests and Decryption Algorithm Functional Tests as described below using the following input parameters: <h:ul><h:li>Key Size [256] bits</h:li> <h:li>Associated data size [0-65536] bits</h:li> <h:li>Payload size [0-65536] bits</h:li> <h:li>IV size [96] bits</h:li> <h:li>Tag size [96, 104, 112, 120, 128] bits</h:li></h:ul> <h:p/> <h:br/> <h:b>Encryption Algorithm Functional Tests</h:b> <h:p/>The evaluator shall generate 15 test cases using random data for each combination of the above parameters as follows: <h:p/> <h:ul><h:li>Each claimed key size,</h:li> <h:li>Each supported tag size,</h:li> <h:li>Four supported non-zero payload sizes, such that two are multiples of 128 bits
                    and two are not multiples of 128 bits,</h:li> <h:li>Four supported non-zero associated data sizes, such that two are multiples of 
                    128 bits and two are not multiples of 128 bits, and</h:li> <h:li>An associated data size of zero, if supported.</h:li></h:ul> <h:p/>Note that the IV size is always 96 bits. <h:p/>The evaluator shall compare the output from each test case against results generated by a known- good implementation with the same input parameters. <h:p/> <h:br/> <h:b><h:i>Decryption Algorithm Functional Tests</h:i></h:b> <h:p/>The evaluator shall test the authenticated decrypt functionality of AES-GCM by supplying 15 test cases for the supported combinations of the parameters as described above. For each parameter combination the evaluator shall introduce an error into either the Ciphertext or the Tag such that approximately half of the cases are correct and half the cases contain errors.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/Hash Cryptographic Operation - Hashing -->
        <f-component cc-id="fcs_cop.1" id="fcs-cop-1-hash" name="Cryptographic Operation - Hashing" iteration="Hash">
          <f-element id="fel-hash-how">
            <title>
              The TSF shall perform [<h:i>cryptographic hashing</h:i>] in accordance with a specified 
              cryptographic algorithm
              <selectables>
                <selectable id="sel-cop1-sha256">SHA-256</selectable>
                <selectable id="sel-cop1-sha384">SHA-384</selectable>
                <selectable id="sel-cop1-sha512">SHA-512</selectable>
                <selectable id="sel-cop1-sha3-384">SHA3-384</selectable>
                <selectable id="sel-cop1-sha3-512">SHA3-512</selectable>
              </selectables>
              that meet the following:
              <selectables>
                <selectable id="fcs_cop.1.1_Hash_1">ISO/IEC 10118-3:2018 [SHA, SHA3]</selectable>
                <selectable id="fcs_cop.1.1_Hash_2">FIPS PUB 180-4 [SHA]</selectable>
                <selectable id="fcs_cop.1.1_Hash_3">FIPS PUB 202 [SHA3]</selectable>
              </selectables>.
            </title>
            <note role="application">
              <h:p>
                In accordance with CNSA 1.0 and 2.0:
                <h:ul>
                  <h:li>SHA-1 hash is no longer permitted to be used as a hash function, </h:li>
                  <h:li>SHA3 hashes may be used only for internal hardware functionality such as
	            boot integrity checks, and</h:li>
                  <h:li>SHA-256 is permitted only for use as a PRF or MAC as part of a key derivation function,
	            or as part of LMS or XMSS.</h:li>
                </h:ul>
                <h:p/>
                The hash selection should be consistent with the overall strength of the 
	        algorithm used for signature generation. For example, the TOE should choose SHA-384 for 3072-bit RSA, 
	        4096-bit RSA, or ECC with P-384; and SHA-512 for ECC with P-521.
              </h:p>
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to verify that if SHA-256 is selected, that it is being 
                used only as a PRF or MAC step in a key derivation function or as part of LMS, and not as a hash algorithm.</TSS>
              <Guidance/>
              <Tests>The following tests may require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products. <h:p/>The following tests are conditional, based on the selections made in the SFR. The evaluator shall perform the following tests or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>SHA-256, SHA-384, SHA-512</h:b> <h:p/>To test the TOE’s ability to generate hash digests using SHA2, the evaluator shall perform the Algorithm Functional Test, Monte Carlo Test, and Large Data Test for each claimed SHA2 algorithm. <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>The evaluator shall generate a number of test cases equal to the block size of the hash (512 for SHA2-256; 1024 for the other SHA2 algorithms). <h:p/>Each test case is to consist of random data of a random length between 0 and 65536 bits, or the largest size supported. <h:p/> <h:br/> <h:b>Monte Carlo Test</h:b> <h:p/>Monte Carlo tests begin with a single seed and run 100 iterations of the chained computation. <h:p/>There are two versions of the Monte Carlo Test for SHA-1 and SHA-2. Either one is acceptable. For the standard Monte Carlo test the message hashed is always three times the length of the initial seed. <h:p/> <h:pre>
                  For j = 0 to 99
                  A = B = C = SEED
                  For i = 0 to 999
                  MSG = A || B || C
                  MD = SHA(MSG)
                  A = B
                  B = C
                  C = MD
                  Output MD
                  SEED = MD
                </h:pre> <h:p/>For the alternate version of the Monte Carlo Test, the hashed message is always the same length as the seed. <h:p/> <h:pre>
                  INITIAL_SEED_LENGTH = LEN(SEED)
                  For j = 0 to 99
                  A = B = C = SEED
                  For i = 0 to 999
                  MSG = A || B || C
                  if LEN(MSG) &gt;= INITIAL_SEED_LENGTH:
                  MSG = leftmost INITIAL_SEED_LENGTH bits of MSG
                  else:
                  MSG = MSG || INITIAL_SEED_LENGTH - LEN(MSG) 0 bits
                  MD = SHA(MSG)
                  A = B
                  B = C
                  C = MD
                  Output MD
                  SEED = MD	
                </h:pre> <h:p/>The evaluator shall compare the output against results generated by a known good implementation with the same input. <h:p/> <h:br/> <h:b>Large Data Test</h:b> <h:p/>The implementation must be tested against one test case each on large data messages of 1GB, 2GB, 4GB, and 8GB of data as supported. The data need not be random. It may, for example, consist of a repeated pattern of 64 bits. <h:p/>The evaluator shall compare the output against results generated by a known good implementation with the same input. <h:p/> <h:br/> <h:b>SHA3-384, SHA3-512</h:b> <h:p/>To test the TOE’s ability to generate hash digests using SHA3 the evaluator shall perform the Algorithm Functional Test, Monte Carlo Test, and Large Data Tests for each claimed SHA3 algorithm. <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>Generate a test case consisting of random data for every message length from 0 bits (or the smallest supported message size) to rate bits, where rate equals <h:ul><h:li>832 for SHA3-384 and</h:li> <h:li>576 for SHA3-512.</h:li></h:ul> <h:p/>Additionally, generate tests cases of random data for messages of every multiple of (rate+1) bits starting at length rate, and continuing until 65535 is exceeded. <h:p/>The evaluator shall compare the output against results generated by a known good implementation with the same input. <h:p/> <h:br/> <h:b>Monte Carlo Test</h:b> <h:p/>Monte Carlo tests begin with a single seed and run 100 iterations of the chained computation. <h:p/>For this Monte Carlo Test, the hashed message is always the same length as the seed. <h:p/> <h:pre>
                  MD[0] = SEED
                  INITIAL_SEED_LENGTH = LEN(SEED)
                  For 100 iterations
                  For i = 1 to 1000
                  MSG = MD[i-1];
                  if LEN(MSG) &gt;= INITIAL_SEED_LENGTH:
                  MSG = leftmost INITIAL_SEED_LENGTH bits of MSG
                  else:
                  MSG = MSG || INITIAL_SEED_LENGTH - LEN(MSG) 0 bits
                  MD[i] = SHA3(MSG)
                  MD[0] = MD[1000]
                  Output MD[0]
                </h:pre> <h:p/>The evaluator shall compare the output against results generated by a known good implementation with the same input. <h:p/> <h:br/> <h:b>Large Data Test</h:b> <h:p/>The implementation must be tested against one test case each on large data messages of 1GB, 2GB, 4GB, and 8GB of data as supported. The data need not be random. It may, for example, consist of a repeated pattern of 64 bits. <h:p/>The evaluator shall compare the output against results generated by a known good implementation with the same input.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/KeyedHash Cryptographic Operation - Keyed Hash -->
        <f-component cc-id="fcs_cop.1" id="fcs-cop-1-keyedhash" name="Cryptographic Operation - Keyed Hash" iteration="KeyedHash">
          <f-element id="fel-keyed-hash-how">
            <title>
              The TSF shall perform [<h:i>keyed hash message authentication</h:i>] in accordance
              with a specified cryptographic algorithm
              <selectables>
                <tabularize id="tab-fcs-cop-keyedhash-sels" title="Allowable choices for FCS_COP.1/KeyedHash">
                  <selectcol>Keyed Hash Algorithm</selectcol>
                  <reqtext>and cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic Key Sizes</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_COP.1/KeyedHash.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-keyedhash-hmac-sha-256">
                  <col>HMAC-SHA-256</col>
                  <col>256 bits</col>
                  <col>
                    <selectables>
                      <selectable id="fcs_cop.1.1_KeyedHash_1">
                        <h:i>ISO/IEC 9797-2:2021 (Section 7 “MAC Algorithm 2”)</h:i>
                      </selectable>
                      <selectable id="fcs_cop.1.1_KeyedHash_2">
                        <h:i>FIPS PUB 198-1</h:i>
                      </selectable>
                    </selectables>
                  </col>
                </selectable>
                <selectable id="sel-fcs-cop-keyedhash-hmac-sha-384">
                  <col>HMAC-SHA-384</col>
                  <col><selectables><selectable id="fcs_cop.1.1_KeyedHash_3"><h:i>384 (ISO, FIPS)</h:i></selectable><selectable id="fcs_cop.1.1_KeyedHash_4"><h:i>256 (FIPS)</h:i></selectable></selectables> bits</col>
                  <col>
                    <selectables>
                      <selectable id="fcs_cop.1.1_KeyedHash_5">
                        <h:i>ISO/IEC 9797-2:2021 (Section 7 “MAC Algorithm 2”)</h:i>
                      </selectable>
                      <selectable id="fcs_cop.1.1_KeyedHash_6">
                        <h:i>FIPS PUB 198-1</h:i>
                      </selectable>
                    </selectables>
                  </col>
                </selectable>
                <selectable id="sel-fcs-cop-keyedhash-hmac-sha-512">
                  <col>HMAC-SHA-512</col>
                  <col><selectables><selectable id="fcs_cop.1.1_KeyedHash_7"><h:i>512 (ISO, FIPS)</h:i></selectable><selectable id="fcs_cop.1.1_KeyedHash_8"><h:i>384 (FIPS)</h:i></selectable><selectable id="fcs_cop.1.1_KeyedHash_9"><h:i>256 (FIPS)</h:i></selectable></selectables> bits</col>
                  <col>
                    <selectables>
                      <selectable id="fcs_cop.1.1_KeyedHash_10">
                        <h:i>ISO/IEC 9797-2:2021 (Section 7 “MAC Algorithm 2”)</h:i>
                      </selectable>
                      <selectable id="fcs_cop.1.1_KeyedHash_11">
                        <h:i>FIPS PUB 198-1</h:i>
                      </selectable>
                    </selectables>
                  </col>
                </selectable>
              </selectables>
            </title>
            <note role="application">
              <h:p>The intent of this requirement is to specify the keyed-hash
                message authentication function used for key establishment purposes for the various
                cryptographic protocols used by the OS (e.g., trusted channel).
                The hash selection must support the message digest size selection.
                The hash selection should be consistent with the overall strength of the
                algorithm used for FCS_COP.1/Hash.</h:p>
              <h:p>In accordance with CNSA 1.0 and 2.0, HMAC-SHA-256 may be used only as a PRF or MAC step in a key derivation function.</h:p>
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to ensure that the size of the key is sufficient for the desired
                security strength of the output.
                <h:p/>
                The evaluator shall examine the TSS to verify that if HMAC-SHA-256 is selected, that it is being 
                used only as a PRF or MAC step in a key derivation function.
              </TSS>
              <Guidance/>
              <Tests>The following tests are conditional based on the selections made in the SFR. The evaluator shall perform the following tests or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>HMAC</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Keyed Hash Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">HMAC-SHA-256</h:td><h:td valign="top">256 bits</h:td><h:td valign="top">
                      [<h:b>selection:</h:b> <h:i>ISO/IEC 9797-2:2021 (Section 7 “MAC Algorithm 2”), FIPS PUB 198-1</h:i>] </h:td></h:tr><h:tr><h:td valign="top">HMAC-SHA-384</h:td><h:td valign="top">[<h:i><h:b>selection:</h:b> (ISO, FIPS) 384, (FIPS) 256] bits</h:i></h:td><h:td valign="top">
                      [<h:b>selection:</h:b> <h:i>ISO/IEC 9797-2:2021 (Section 7 “MAC Algorithm 2”), FIPS PUB 198-1</h:i>] </h:td></h:tr><h:tr><h:td valign="top">HMAC-SHA-512</h:td><h:td valign="top">[<h:b>selection:</h:b> <h:i>(ISO, FIPS) 512, (FIPS) 384, 256] bits</h:i></h:td><h:td valign="top">
                      [<h:b>selection:</h:b> <h:i>ISO/IEC 9797-2:2021 (Section 7 “MAC Algorithm 2”), FIPS PUB 198-1</h:i>] </h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to generate keyed hashes using HMAC the evaluator shall perform the Algorithm Functional Test for each combination of claimed HMAC algorithm the following parameters: <h:ul><h:li>Hash function [SHA-256, SHA-384, SHA-512]</h:li> <h:li>Key length [8-65536] bits by 8s</h:li> <h:li>MAC length [32-[digest size of hash function (256, 384, 512)]] bits</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>For each supported Hash function the evaluator shall generate 150 test cases using random input messages of 128 bits, random supported key lengths, random keys, and random supported MAC lengths such that across the 150 test cases: <h:ul><h:li>The key length includes the minimum, the maximum, a key length equal to the block
                    size, and key lengths that are both larger and smaller than the block size.</h:li> <h:li>The MAC size includes the minimum, the maximum, and two other random values.</h:li></h:ul> <h:p/>The evaluator shall compare the output against results generated by a known good implementation with the same input.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/KeyEncap Cryptographic Operation - Key Encapsulation -->
        <f-component cc-id="fcs_cop.1" id="sfr-fcs-cop-1-keyencap" name="Cryptographic Operation - Key Encapsulation" iteration="KeyEncap" status="sel-based">
          <depends on-sel="sel-ckm-2-encap"/>
          <f-element id="fcs-cop-1e1-keyencap">
            <title>
              The TSF shall perform [key encapsulation] in accordance with a specified cryptographic algorithm
              <selectables>
                <tabularize id="tab-fcs-cop-keyencap-sels" title="Allowable choices for FCS_COP.1/KeyEncap">
                  <textcol>Identifier</textcol>
                  <reqtext/>
                  <selectcol>Cryptographic Algorithm</selectcol>
                  <reqtext>and cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic Key Sizes</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
										completion of the selection operations of FCS_COP.1/KeyEncap.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-keyencap-mlkem">
                  <col>ML-KEM</col>
                  <col>ML-KEM</col>
                  <col>Parameter set = ML-KEM-1024</col>
                  <col>NIST FIPS 203</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">For this PP, the only anticipated use of key encapsulation is the use of ML-KEM as part of key establishment for trusted communications.</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS documents that the selection of the key size is
						sufficient for the security strength of the key encapsulated.
                <h:p/>
                The evaluator shall examine the TSS to verify that any one-time values such as nonces or masks
						are constructed and used in accordance with the relevant standards.
              </TSS>
              <Guidance/>
              <Tests>The following test may require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products. <h:p/>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>ML-KEM Key Encapsulation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ML-KEM</h:td><h:td valign="top">ML-KEM</h:td><h:td valign="top">Parameter set = ML-KEM-1024</h:td><h:td valign="top">NIST FIPS PUB 203</h:td></h:tr></h:table> <h:p/>To test the TOE’s implementation of ML-KEM key encapsulation/decapsulation, the evaluator shall perform the Encapsulation Test and the Decapsulation Test using the following input parameters: <h:ul><h:li>Encapsulation Parameters:<h:ul><h:li>Parameter set [ML-KEM-1024]</h:li> <h:li>Previously generated encapsulation key (<h:i>ek</h:i>)</h:li> <h:li>Random value (<h:i>m</h:i>) [32 bytes]</h:li></h:ul></h:li> <h:li>Decapsulation Parameters:<h:ul><h:li>Parameter set [ML-KEM-1024]</h:li> <h:li>Previously generated decapsulation key (<h:i>dk</h:i>)</h:li> <h:li>Previously generated ciphertext (<h:i>c</h:i>) [32 bytes]</h:li></h:ul></h:li></h:ul> <h:p/> <h:br/> <h:b>Encapsulation Test</h:b> <h:p/>For each supported parameter set the evaluator shall generate 25 test cases consisting of an encapsulation key ek and random value m. For each test case the valuator shall require the implementation under test to generate the corresponding shared secret k and ciphertext c. To determine correctness, the evaluator shall compare the resulting values with those generated using a known-good implementation using the same inputs. <h:p/> <h:br/> <h:b>Encapsulation Key Check (if supported)</h:b> <h:p/>The evaluator shall generate 10 encapsulation keys such that: <h:ul><h:li>Five of the encapsulation keys are valid, and</h:li> <h:li>Five of the encapsulation keys are modified such that a value in the noisy linear 
						system is encoded into the key as a value greater than Q.</h:li></h:ul> <h:p/>The evaluator shall invoke the TOE’s Encapsulation Key Check functionality to determine the validity of the 10 keys. The unmodified keys should be determined valid, and the modified keys should be determined invalid. <h:p/> <h:br/> <h:b>Decapsulation Key Check (if supported)</h:b> <h:p/>The evaluator shall generate 10 decapsulation keys such that: <h:ul><h:li>Five of the decapsulation keys are valid, and</h:li> <h:li>Five of the decapsulation keys are modified such that the concatenated
						values ek||H(ek) will no longer match by modifying H(ek) to be a different value.</h:li></h:ul> <h:p/>The evaluator shall invoke the TOE’s Decapsulation Key Check functionality to determine the validity of the 10 keys. The unmodified keys should be determined valid, and the modified keys should be determined invalid. <h:p/> <h:br/> <h:b>Decapsulation Test</h:b> <h:p/>For each supported parameter set the evaluator shall use a single previously generated decapsulation key <h:i>dk</h:i>and generate 10 test cases consisting of valid and invalid ciphertexts c. For each test case the evaluator shall require the implementation under test to generate the corresponding shared secret <h:i>k</h:i>whether or not the ciphertext is valid. To determine correctness, the evaluator shall compare the resulting values with those generated using a known-good implementation using the same inputs. <h:p/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/KeyWrap Cryptographic Operation - Key Wrapping -->
        <f-component cc-id="fcs_cop.1" id="sfr-fcs-cop-1-kw" name="Cryptographic Operation - Key Wrapping" iteration="KeyWrap">
          <f-element id="fcs-cop-1e1-kw">
            <title>
              The TSF shall perform [<h:i>key wrapping</h:i>] in accordance with a specified cryptographic algorithm
              <selectables>
                <tabularize id="fcs-cop-kw-sels" title="Allowable choices for FCS_COP.1/KeyWrap">
                  <textcol>Identifier</textcol>
                  <reqtext/>
                  <selectcol>Cryptographic Algorithm</selectcol>
                  <reqtext>and cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic Key Sizes</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
								completion of the selection operations of FCS_COP.1/KeyWrap.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-kw-aes-kw">
                  <col>AES-KW</col>
                  <col>AES in KW mode</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_KeyWrap_1">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_KeyWrap_2">FIPS PUB 197</selectable></selectables> [AES]<h:p/> <selectables><selectable id="fcs_cop.1.1_KeyWrap_3">ISO/IEC 19772:2020 (clause 6)</selectable><selectable id="fcs_cop.1.1_KeyWrap_4">NIST SP 800-38F (Section 6.2)</selectable></selectables> [KW mode]</col>
                </selectable>
                <selectable id="sel-fcs-cop-kw-aes-kwp">
                  <col>AES-KWP</col>
                  <col>AES in KWP mode</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_KeyWrap_5">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_KeyWrap_6">FIPS PUB 197</selectable></selectables> [AES]<h:p/>NIST SP 800-38F (Section 6.3) [KWP mode]</col>
                </selectable>
                <selectable id="sel-fcs-cop-kw-aes-ccm">
                  <col>AES-CCM</col>
                  <col>AES in CCM mode with unpredictable, non-repeating nonce, minimum size of 64 bits</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_KeyWrap_7">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_KeyWrap_8">FIPS PUB 197</selectable></selectables> [AES]<h:p/> <selectables><selectable id="fcs_cop.1.1_KeyWrap_9">ISO/IEC 19772:2020 (Clause 7)</selectable><selectable id="fcs_cop.1.1_KeyWrap_10">NIST SP 800-38C</selectable></selectables> [CCM]</col>
                </selectable>
                <selectable id="sel-fcs-cop-kw-aes-gcm">
                  <col>AES-GCM</col>
                  <col>AES in GCM mode with non-repeating IVs using <selectables><selectable id="fcs_cop.1.1_KeyWrap_11">deterministic</selectable><selectable id="fcs_cop.1.1_KeyWrap_12">RBG-based</selectable></selectables>, IV construction; the tag must be of length <selectables><selectable id="fcs_cop.1.1_KeyWrap_13">96</selectable><selectable id="fcs_cop.1.1_KeyWrap_14">104</selectable><selectable id="fcs_cop.1.1_KeyWrap_15">112</selectable><selectable id="fcs_cop.1.1_KeyWrap_16">120</selectable><selectable id="fcs_cop.1.1_KeyWrap_17">128</selectable></selectables> bits.</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_KeyWrap_18">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_KeyWrap_19">FIPS PUB 197</selectable></selectables> [AES]<h:p/> <selectables><selectable id="fcs_cop.1.1_KeyWrap_20">ISO/IEC 19772:2020 (Clause 10)</selectable><selectable id="fcs_cop.1.1_KeyWrap_21">NIST SP 800-38D</selectable></selectables> [GCM]</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">NIST 800-57p1rev5 sec. 5.6.2 specifies that the size of key used to protect the key being 
					transported should be at least the security strength of the key it is protecting.</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS documents that the selection of the key size is
						sufficient for the security strength of the key wrapped.
                <h:p/>
                The evaluator shall examine the TSS to ensure that it describes the construction of any IVs,
						nonces, and MACs in conformance with the relevant specifications.
              </TSS>
              <Guidance/>
              <Tests>For tests of AES-GCM and AES-CCM, see testing for FCS_COP.1/AEAD. <h:p/>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>AES-KW</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">AES-KW</h:td><h:td valign="top">AES in KW mode</h:td><h:td valign="top">256 bits</h:td><h:td valign="top">[<h:b>selection:</h:b> ISO/IEC 18033-3:2010 (Subclause 5.2),
														FIPS PUB 197] [AES]<h:p/>
													[<h:b>selection:</h:b> ISO/IEC 19772:2020 (clause 6), 
														NIST SP 800-38F (Section 6.2)] [KW mode] </h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to wrap keys using AES in Key Wrap mode the evaluator shall perform the Algorithm Functional Tests using the following input parameters: <h:ul><h:li>Key size [256] bits</h:li> <h:li>Keyword cipher type [cipher, inverse]</h:li> <h:li>Payload sizes [128-4096] bits by 64s</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>The evaluator shall generate 100 encryption test cases using random data for each combination of claimed key size, keyword cipher type, and six supported payload sizes such that the payload sizes include the minimum, the maximum, two that are divisible by 128, and two that are not divisible by 128. <h:p/>The results shall be compared with those generated by a known-good implementation using the same inputs. <h:p/>The evaluator shall generate 100 decryption test cases using the same parameters as above, but with 20 of each 100 test cases having modified ciphertext to produce an incorrect result. To determine correctness, the evaluator shall confirm that the results correspond as expected for both the modified and unmodified values. <h:p/> <h:br/> <h:b>AES-KWP</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">AES-KWP</h:td><h:td valign="top">AES in KWP mode</h:td><h:td valign="top">256 bits</h:td><h:td valign="top">[<h:b>selection:</h:b> ISO/IEC 18033-3:2010 (Subclause 5.2),
														FIPS PUB 197] [AES]<h:p/>
													NIST SP 800-38F (Section 6.3) [KWP mode] </h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to wrap keys using AES in Key Wrap with Padding mode with padding the evaluator shall perform the Algorithm Functional Tests using the following input parameters: <h:ul><h:li>Key size [256] bits</h:li> <h:li>Keyword cipher type [cipher, inverse]</h:li> <h:li>Payload sizes [8-4096] bits by 8s</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>The evaluator shall generate 100 encryption test cases using random data for each combination of claimed key size, keyword cipher type, and six supported payload sizes such that the payload sizes include the minimum, the maximum, two that are divisible by 128, and two that are not divisible by 128. <h:p/>The results shall be compared with those generated by a known-good implementation using the same inputs. <h:p/>The evaluator shall generate 100 decryption test cases using the same parameters as above, but with 20 of each 100 test cases having modified ciphertext to produce an incorrect result. To determine correctness, the evaluator shall confirm that the results correspond as expected for both the modified and unmodified values. <h:p/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/SigGen Cryptographic Operation -
                  Signature Generation -->
        <f-component cc-id="fcs_cop.1" id="fcs-cop-1-siggen" name="Cryptographic Operation -                   Signature Generation" iteration="SigGen">
          <f-element id="fel-sign-how">
            <title>
              The TSF shall perform [<h:i>digital signature generation</h:i>] in accordance with a specified 
              cryptographic algorithm
              <selectables>
                <tabularize id="tab-fcs-cop-siggen-sels" title="Allowable choices for FCS_COP.1/SigGen">
                  <textcol>Identifier</textcol>
                  <reqtext/>
                  <selectcol>Cryptographic Algorithm</selectcol>
                  <reqtext>and cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic Key Sizes</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations in FCS_COP.1/SigGen.
                    <h:p/>
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-siggen-rsa-pkcs">
                  <col>RSA-PKCS</col>
                  <col>RSASSA-PKCS1-v1_5</col>
                  <col>Modulus of size <selectables><selectable id="fcs_cop.1.1_SigGen_1"><h:i>3072</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_2"><h:i>4096</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_3"><h:i>6144</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_4"><h:i>8192</h:i></selectable></selectables> bits, hash <selectables><selectable id="fcs_cop.1.1_SigGen_5"><h:i>SHA-384</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_6"><h:i>SHA-512</h:i></selectable></selectables></col>
                  <col>RFC 8017 (Section 8.2) [PKCS #1 v2.2]<h:p/>FIPS PUB 186-5 (Section 5.4) [RSASSA-PKCS1-v1_5]</col>
                </selectable>
                <selectable id="sel-fcs-cop-siggen-rsa-pss">
                  <col>RSA-PSS</col>
                  <col>RSASSA-PSS</col>
                  <col>Modulus of size <selectables><selectable id="fcs_cop.1.1_SigGen_7"><h:i>3072</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_8"><h:i>4096</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_9"><h:i>6144</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_10"><h:i>8192</h:i></selectable></selectables> bits, hash <selectables><selectable id="fcs_cop.1.1_SigGen_11"><h:i>SHA-384</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_12"><h:i>SHA-512</h:i></selectable></selectables>, Salt Length () such that <assignable>0 ≤ sLen ≤ hLen (Hash Output Length)</assignable> and Mask Generation Function = MGF1</col>
                  <col>RFC 8017 (Section 8.1) [PKCS#1 v2.2]<h:p/>FIPS PUB 186-5 (Section 5.4) [RSASSA-PSS]</col>
                </selectable>
                <selectable id="sel-fcs-cop-siggen-ecdsa">
                  <col>ECDSA</col>
                  <col>ECDSA</col>
                  <col>Elliptic Curve <selectables><selectable id="fcs_cop.1.1_SigGen_13"><h:i>P-384</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_14"><h:i>P-521</h:i></selectable></selectables>, per-message secret number generation <selectables><selectable id="fcs_cop.1.1_SigGen_15"><h:i>extra random bits</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_16"><h:i>rejection sampling</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_17"><h:i>deterministic</h:i></selectable></selectables> and hash function using <selectables><selectable id="fcs_cop.1.1_SigGen_18"><h:i>SHA-384</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_19"><h:i>SHA-512</h:i></selectable></selectables></col>
                  <col><selectables><selectable id="fcs_cop.1.1_SigGen_20"><h:i>ISO/IEC 14888-3:2018 (Subclause 6.6)</h:i></selectable><selectable id="fcs_cop.1.1_SigGen_21"><h:i>FIPS PUB 186-5 (Sections 6.3.1, 6.4.1</h:i></selectable></selectables> [ECDSA]<h:p/>NIST SP-800 186 (Section 4) [NIST Curves]</col>
                </selectable>
                <selectable id="sel-fcs-cop-siggen-lms">
                  <col>LMS</col>
                  <col>LMS</col>
                  <col>Private key size =undefined<h:p/>Winternitz parameter =undefined<h:p/>Tree height = <selectables><selectable id="fcs_cop.1.1_SigGen_32">5</selectable><selectable id="fcs_cop.1.1_SigGen_33">10</selectable><selectable id="fcs_cop.1.1_SigGen_34">15</selectable><selectable id="fcs_cop.1.1_SigGen_35">20</selectable><selectable id="fcs_cop.1.1_SigGen_36">25</selectable></selectables></col>
                  <col>RFC 8554 [LMS]<h:p/>NIST SP 800-208 [parameters]</col>
                </selectable>
                <selectable id="sel-fcs-cop-siggen-mldsa">
                  <col>ML-DSA</col>
                  <col>ML-DSA Signature Generation</col>
                  <col>Parameter set = ML-DSA-87</col>
                  <col>NIST FIPS 204 (Section 5.2)</col>
                </selectable>
                <selectable id="sel-fcs-cop-siggen-xmss">
                  <col>XMSS</col>
                  <col>XMSS</col>
                  <col>Private key size =undefined<h:p/>Tree height = <selectables><selectable id="fcs_cop.1.1_SigGen_43">10</selectable><selectable id="fcs_cop.1.1_SigGen_44">16</selectable><selectable id="fcs_cop.1.1_SigGen_45">20</selectable></selectables></col>
                  <col>RFC 8391 [XMSS]<h:p/>NIST SP 800-208 [parameters]</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">The ST author should choose the algorithm implemented to
              perform digital signatures; if more than one algorithm is available, this requirement
              should be iterated to specify the functionality. For the algorithm chosen, the ST
              author should make the appropriate assignments and selections to specify the parameters
              that are implemented for that algorithm.</note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS and verify that any hash function is the appropriate security
						strength for the signing algorithm.
                <h:p/>
                The evaluator shall examine the TSS to verify that any one-time values such as nonces or masks
						are constructed and used in accordance with the relevant standards.
                <h:p/>
                The evaluator shall examine the TSS to verify that the TOE has appropriate measures in place to
						ensure that hash-based signature algorithms do not reuse private keys.
              </TSS>
              <Guidance/>
              <Tests>The following tests are conditional based on the selections made in the SFR. The evaluator shall perform the following tests or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>RSA-PKCS Signature Generation </h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">RSA-PKCS </h:td><h:td valign="top">RSASSA-PKCS1-v1_5</h:td><h:td valign="top">Modulus of size [<h:b>selection:</h:b> <h:i>3072, 4096, 6144, 8192</h:i>] bits,
									hash [<h:b>selection:</h:b> <h:i>SHA-384, SHA-512</h:i>]</h:td><h:td valign="top">RFC 8017 (Section 8.2) [PKCS #1 v2.2]<h:p/>
													NIST FIPS PUB 186-5 (Section 5.4) [RSASSA-PKCS1-v1_5]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to perform RSA Digital Signature Generation using PKCS1-v1,5 signature type, the evaluator shall perform the Generated Data Test using the following input parameters: <h:ul><h:li>Modulus size [3072, 4096, 6144, 8192] bits</h:li> <h:li>Hash algorithm [SHA-384, SHA-512]</h:li></h:ul> <h:br/> <h:b>Generated Data Test</h:b> <h:p/>For each supported combination of the above parameters, the evaluator shall cause the TOE to generate three test cases using random data. The evaluator shall compare the results against those from a known good implementation. <h:p/> <h:br/> <h:b>RSA-PSS Signature Generation </h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">RSA-PSS</h:td><h:td valign="top">RSASSA-PSS</h:td><h:td valign="top">Modulus of size [<h:b>selection:</h:b> <h:i>3072, 4096, 6144, 8192</h:i>] bits,
									hash [<h:b>selection:</h:b> <h:i>SHA-384, SHA-512</h:i>], Salt Length (<h:i>sLen</h:i>)
												such that [<h:b>assignment:</h:b> <h:i>0 ≤ <h:i>sLen</h:i> ≤ <h:i>hLen</h:i> (Hash Output Length)</h:i>]
												and Mask Generation Function = MGF1
												</h:td><h:td valign="top">RFC 8017 (Section 8.2) [PKCS #1 v2.2]<h:p/>
													NIST FIPS PUB 186-5 (Section 5.4) [RSASSA-PSS]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to perform RSA Digital Signature Generation using PSS signature type, the evaluator shall perform the Generated Data Test using the following input parameters: <h:ul><h:li>Modulus size [3072, 4096, 6144, 8192] bits</h:li> <h:li>Hash algorithm [SHA-384, SHA-512]</h:li> <h:li>Salt length [Fixed based on implementation]</h:li> <h:li>Mask function [MGF1]</h:li></h:ul> <h:p/> <h:br/> <h:b>Generated Data Test</h:b> <h:p/>For each supported combination of the above parameters, the evaluator shall cause the TOE to generate three test cases using random data. The evaluator shall compare the results against those from a known good implementation. <h:p/> <h:br/> <h:b>ECDSA Signature Generation </h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ECDSA</h:td><h:td valign="top">ECDSA</h:td><h:td valign="top">Elliptic Curve [<h:b>selection:</h:b> <h:i>P-384, P-521</h:i>], 
									per-message secret number generation
									[<h:b>selection:</h:b> <h:i>extra random bits, rejection sampling, deterministic</h:i>] 
									and hash function using [<h:b>selection:</h:b> <h:i>SHA-384, SHA-512</h:i>] </h:td><h:td valign="top">[<h:b>selection:</h:b> <h:i>ISO/IEC 14888-3:2018 (Subclause 6.6),
									NIST FIPS PUB 186-5 (Sections 6.3.1, 6.4.1</h:i>] [ECDSA]<h:p/>
									NIST SP-800 186 (Section 4) [NIST Curves] </h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to perform ECDSA Digital Signature Generation using extra random bits or rejection sampling for secret number generation, the evaluator shall perform the Algorithm Functional Test using the following input parameters: <h:ul><h:li>Elliptic Curve [P-384, P-521]</h:li> <h:li>Hash algorithm [SHA-384, SHA-512]</h:li></h:ul> <h:p/>To test the TOE’s ability to perform ECDSA Digital Signature Generation using deterministic secret number generation, the evaluator shall perform the Algorithm Functional Test using the following input parameters: <h:ul><h:li>Elliptic Curve [P-384, P-521]</h:li> <h:li>Hash algorithm [SHA-384, SHA-512]</h:li></h:ul> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>For each supported combination of the above parameters, the evaluator shall cause the TOE to generate 10 test cases using random data. The evaluator shall compare the results against those from a known good implementation. <h:p/> <h:br/> <h:b>LMS Signature Generation </h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">LMS</h:td><h:td valign="top">LMS</h:td><h:td valign="top">Private key size = [<h:b>selection:</h:b>
					        192 bits with [<h:b>selection:</h:b> SHA256/192, SHAKE256/192], 
					        256 bits with [<h:b>selection:</h:b> SHA-256, SHAKE256]], 
					        Winternitz parameter = [<h:b>selection:</h:b> 1, 2, 4, 8], 
					        and tree height = [<h:b>selection:</h:b> 5, 10, 15, 20, 25]</h:td><h:td valign="top">RFC 8554 [LMS]<h:p/>
					        NIST SP 800-208 [parameters] </h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to generate cryptographic digital signature using LMS, the evaluator shall perform the Algorithm Functional Test using the following input parameters: <h:ul><h:li>Hash algorithm [SHA-256/192, SHAKE256/192, SHA-256, SHAKE256]</h:li> <h:li>Winternitz [1, 2, 4, 8]</h:li> <h:li>Tree height [5, 10, 15, 20, 25]</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>For each supported combination of the above parameters, the evaluator shall generate 10 signatures. The evaluator shall verify the correctness of the implementation by comparing values generated by the TOE with those generated by a known good implementation using the same input parameters. <h:p/> <h:br/> <h:b>ML-DSA Signature Generation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ML-DSA</h:td><h:td valign="top">ML-DSA SigGen</h:td><h:td valign="top">Parameter set = ML-DSA-87</h:td><h:td valign="top">NIST FIPS PUB 204 (Section 5.2)</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to generate digital signatures using ML-DSA, the evaluator shall perform the Algorithm Functional Test using the following input parameters: <h:ul><h:li>Parameter set [ML-DSA-87]</h:li> <h:li>Seed [32 random bytes] (for non-deterministic signature testing), or</h:li> <h:li>Seed [32 zero bytes] (for deterministic signature testing)</h:li> <h:li>Message to sign [8-65535] bytes</h:li> <h:li><h:i>Mu</h:i> value (if generated externally)</h:li> <h:li>Previously generated private key (<h:i>sk</h:i>)</h:li> <h:li>Context (for external interface testing)</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>For each combination of supported parameter set and capabilities, the evaluator shall require the implementation under test to generate 15 signatures pairs using 15 different randomly generated 32-byte seed values. To determine correctness, the evaluator shall compare the resulting key pairs with those generated using a known good implementation using the same inputs. <h:p/> <h:br/> <h:b>Known Answer Test for Rejection Cases</h:b> <h:p/>For each supported parameter set, the evaluator shall cause the TOE to generate signatures using the data below and a deterministic seed of all 0’s. Correctness is determined by comparing the hash of the resulting signature with the hash in the fourth row for each corresponding test case below. <h:p/>The test values are defined as follows: <h:ul><h:li><h:i>Seed</h:i> is the seed to generate the key pair (<h:i>pk, sk</h:i>)</h:li> <h:li><h:i>Hash of keys</h:i> is computed by SHA-256(<h:i>pk</h:i>||<h:i>sk</h:i>)</h:li> <h:li><h:i>Message</h:i> is the message to be signed</h:li> <h:li><h:i>Hash of sig</h:i> is computed by SHA-256(<h:i>sig</h:i>)</h:li></h:ul> <h:p/> <h:p/> <h:b>ML-DSA-87 Test Cases for Rejection Cases</h:b> <h:p/> <h:pre>
		Test case 87-RC-01
		Seed: 			E4F5AFCF697E0EC3C1BDEB66FAA903221E803902F9C3F716E1056A63D77DC250
		Hash of Keys: 	61618E8DDA6998072C8EB36974E03880D741CAF0BD523356DFC161E7C9E63934
		Message: 		F4F1C05004D5B946F69EAFE104C4020519086ADDB9582A20FDE887D13DFC36B1
		Hash of sig: 	B584E38FA442FC3C81A147D4BDBF058D73C822CAF5CA4C06B0110867F60A8001
						
		Test case 87-RC-02
		Seed: 			8B828D871254D6C57384A8E7025AA3F7160CAD1D2C754499DF3844426062C3DD
		Hash of Keys: 	BB64481317D6C0DBAD20C0C7EF11078AD54E5D574F4A07652115A95F77C655FA
		Message: 		0F9409C5A4930C25B83FC5B77FDB5BB49C75372DE724D9C1A77DB700CF0CF154
		Hash of sig: 	F86B49BE9DEB2B209BDEB4E922E5939E92D38E562C44BB09AFBD67323C345192
						
		Test case 87-RC-03
		Seed: 			E693D282CACB8CE65FD4D108DA7A373F097F0AA9713550BE242AAD5BD3E2E452
		Hash of Keys: 	B0BEAF56713A69BD4AB2CBEE006FA5001E7B41F3AE541E05F088933AA0CC78DF
		Message: 		24DABB9D57ADEBD560ED65D9451C5106D437061708F849BA53F3543CDF9AAAE0
		Hash of sig: 	DBF65CEFF9F96A74AAF6F3AB27B043231BE6AA04FBA2EEC987A24A00BDD6A08E
						
		Test case 87-RC-04
		Seed: 			4002163EB8EED01A8E0919BA8C07D291341EDCAE25B02B9779A2CFFE50561AF0
		Hash of Keys: 	FED1BE685C20ECB322FC40D41DEE7E0E98D0409FBF989CAE71B8AD2D58AD645E
		Message: 		EE316BB5EBED53325B4A55571C60657B53E353B51B831F4A0BBB28107EBA4BA8
		Hash of sig: 	3BE9B5545FDCED92547B3409C83B3312CCB5792A8EC3A4DA63BA692C79BEF17C
						
		Test case 87-RC-05
		Seed: 			9C7AD524F65854C27E565BCEDF8E86D650F13A40D0448F9AE10C05F10F777120
		Hash of Keys: 	0EA872CA5A4BEA94F4E8EF7ED31800727899A51059FDEE111E5CB15F0233B534
		Message: 		CE09831294AA96CAF684B9E667947B021C57B24C138EC7D4DA270694C82F2E08
		Hash of sig: 	3B9526CEE6587F2418BFE603ADB0F7DF0D69EBA31C9F9F005C60C993945EBD33
						
		Test case 87-RC-06
		Seed: 			2EB7676D4A28700DA7772A7A035EB495CAA6F842352A74824EF5FD891BC38B2A
		Hash of Keys: 	D5B73703A1DDC5BCB0D14AE39B193A25D6ADA6535827973181ADB0BE70435A5B
		Message: 		C2B3A0AC483A5517682285C205974B2A506946448A8F7D3E1934C155EFDFE922
		Hash of sig: 	375D598704B722C8A1FEF1626FD7738A532C06329AA4217357460E3B729660F8
						
		Test case 87-RC-07
		Seed: 			E4E80CCE8B26DF1B02B99949851EE2F907FE4F0CC34790352C76D5D91634D073
		Hash of Keys: 	84B7E61684A12698400B09EA332EA3C4FBCFA47FE37FD6AE725CBC5FA8A99D3F
		Message: 		89E6AB43C9CB1CC59C3986D53217A558357E62102A26F666F2B64CD1DBB7A536
		Hash of sig: 	7C4AABD163CAEF8F6EBFDA3E3EEBC0A9604675B0E991ABAFD284F1AE8BA07B2A
						
		Test case 87-RC-08
		Seed: 			5787262B803499223D4E5A8C1EE572E89F7A69B359B3F8505355B0BDEAB95E5C
		Hash of Keys: 	85AE1DE605A7B479C02730BF4B7DD6D0FD8FFE5C980893CA6DAD00BD8BD1CE68
		Message: 		D3230C4E061964BBFB17702432D5D36FC1EB3D1068F8CCAA84044776E3B5CC55
		Hash of sig: 	D3ABE460EE2DD9595F413CFE2780A319E4E4DFD6592995298A7AB0B82A5E2815
						
		Test case 87-RC-09
		Seed: 			CE099B99330537DD153052243FC32ACAD509A126AB982410258858567D410D79
		Hash of Keys: 	E04A9F15EDF8F078EB336CE624249EF2A8EDF2CDBF6A8276E9F5E92ED9B0BAE8
		Message: 		0035931762665F561A1B22176567E3B10FDE2441521F77030733A8E39312EEEE
		Hash of sig: 	3EEF413CB5EB179896ECA172D0DBFB9B251545DC561D61580BD5BBC8B6D734E1

		Test case 87-RC-10
		Seed: 			FC8F2929878CBD81E1CCC23913F290380120C043A4A8A251AEEBF09705B8E590
		Hash of Keys: 	7E2ECCA86F532E8E8092FEBB6E0007F92E7909AD2BCBE2E02AB375DAC9969E5E
		Message: 		D3C28875D2671C0EF23BFDC8869E8ECF8868D3F0561C3134D254F7479D0CE0E5
		Hash of sig: 	EB69A908EDCC04320A0B61AD57E21B044465F2037698636B64229CF2DB259789
						</h:pre> <h:br/> <h:b>XMSS Signature Generation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">XMSS</h:td><h:td valign="top">XMSS</h:td><h:td valign="top">Private key size = [<h:b>selection:</h:b>
					        192 bits with [<h:b>selection:</h:b> SHA256/192, SHAKE256/192], 
					        256 bits with [<h:b>selection:</h:b> SHA-256, SHAKE256]], 
					        and tree height = [<h:b>selection:</h:b> 10, 16, 20] </h:td><h:td valign="top">RFC 8391 [XMSS] <h:p/>
					        NIST SP 800-208 [parameters]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to generate digital signatures using XMSS, the evaluator shall perform the XMSS Key Generation Test using the following input parameters: <h:ul><h:li>Hash algorithm [SHA-256/192, SHAKE256/192, SHA-256, SHAKE256]</h:li> <h:li>Tree height [10, 16, 20]</h:li></h:ul> <h:p/> <h:br/> <h:b>XMSS Key Generation Test</h:b> <h:p/>For each supported combination of the above parameters, the evaluator shall generate 10 signatures. The evaluator shall verify the correctness of the implementation by comparing values generated by the TOE with those generated by a known-good implementation using the same input parameters. <h:p/> <h:br/> <h:b>Known Answer Test for Large Number of Rejection Cases (Total Rejection Count)</h:b> <h:p/>For each supported parameter set, the evaluator shall cause the TOE to generate signatures using the data below and a deterministic seed of all 0’s. Correctness is determined by comparing the hash of the resulting signature with the hash in the fourth row of the corresponding test case below. <h:p/> <h:p/> <h:b>ML-DSA-87 Test Cases for Total Rejection Count</h:b> <h:p/> <h:pre>
		Test case 87-LN-01
		Seed: 			98B6298051D92BF37293C93C97370747BF527B87B71F6C4264182F45155ADE4C
		Hash of Keys: 	04A135B5C9B7020332C7B16E7108E8FF7FC1EAE1C23C5FA0B5D5CED0FEEE7424
		Message: 		D7B0341269259083ABF3C8DC47559A19D57669B4486E0224F376DC43E577A3D8
		Hash of sig: 	58D72D76EC0FB65BFB9893C4479366B79DD7B8B7577E4291D13514FCC76C26DD

		Test case 87-LN-02
		Seed: 			DFB5BDD90F58571DCA962426C623F13D046BBE814D183886AC90D143EAD725A7
		Hash of Keys: 	2B6AB8CFCCCC41F759CAF01932E9413F5DC6D949BC827F739866929683FB155E
		Message: 		21005DB2B583CC826A9684BFFD0EE00AB97E0479FE4A1D266699337540145778
		Hash of sig: 	C93EA34E00FFFFC3ECEA072D5FB038A83B5539CAF7B831AEDCFA785E50B3CA5E

		Test case 87-LN-03
		Seed: 			5AD414E0DD0EF2FE685F342871875FDF06F503717A86C3B3466565ADD2096417
		Hash of Keys: 	BD9C2D52F3FC78DB17E682DA2E78947ECFC0898333838D60C892700B2B0DDA9F
		Message: 		29139C279816B25F2D6BB52C8247D163544F7BA332C3CF63359B9E23FBC56515
		Hash of sig:	DB4BE2DE19FB40437BDB7E9B6578D665DB05B4E88C16907DF4546EBA9BE03AEA

		Test case 87-LN-04
		Seed: 			484DD2F406A4D15F49A91AD5FC3BDC1D0FF253622EB68F83D6E1C870D0E89E29
		Hash of Keys: 	A719DC9A77C91C46295555C2353BA0CBEA513DA9A92A5C34D2E949EFF46A12D8
		Message: 		6AD6E959F0EA60126364FB7C95FA71133F246A9265A11B4965EE78AB0CB5AF0E
		Hash of sig: 	5050D7A665074EC63D9F3966C1F01A1BFB18F9E83AE0B09F838BC1E2342ED6F4

		Test case 87-LN-05
		Seed: 			B25C1816F82D59940D5CB829BAC364AAD013C4C16415CE1CF6DCC2F15199B391
		Hash of Keys: 	ADBB2CD43F222640BD9FF4E61C80E63853E8DC1F759C581B7447C9C166EAA38E
		Message: 		824E47322895BFFE37B6B4AFC41CF6115C07EEC0C24EB81076C87A1B01AE8617
		Hash of sig: 	667ADA46073BC69D64DC47BB9A76DD0D78302E7415D87D5E816B05FB95F9E84D

		Test case 87-LN-06
		Seed: 			B2CE72B3560AF07E06465881F56ADA00262BA708D87B73F39E04E310F3B8A3E9
		Hash of Keys: 	FD9C4AC53AE803242A62DF933B8E8BAD6CE5207AC4A73683B6D9383B5E70B17A
		Message: 		A1501CC84C917E0D2D7C27C2AC382220BD8FFFE807DB38E37A9E429EC2781911
		Hash of sig: 	779553B195E11558EE59EF3942F5F6B446A2144600D1F4F50B300C6C56504760

		Test case 87-LN-07
		Seed: 			AB01D0E591B7DDCD3C03395AED808FA2763C0A486D44119D621BE0FD0B022B25
		Hash of Keys: 	93B6ADE34F78A4ADB36B2F6D2C51DB793E659E1243E80488AE1C03B65125D6D7
		Message: 		8DE8122D89D15FE84A4C34F6B59B2C4B11F33B6A053154D199B634F557FDF5F6
		Hash of sig: 	0483045999A79B583F403DB96A736F0F0B24E2DFBC4E5CFA9B50E3D910786F07

		Test case 87-LN-08
		Seed: 			15D60D3693762F82C9AC1DCB0576936651AC81D863842EDB91109C8EE83AE705
		Hash of Keys: 	2DF544E2E939AA717741C2437288FAEB308DEB8FF37A2652FAE34BAE8B84D779
		Message: 		F05946A6113905C34163AEF2246FD69016CE24A7BA40F8E7E42EDAC2D0A44605
		Hash of sig: 	F8383917AF79C8E540D2356AB05F08B465BF32DFEC444B787CE31BF48CC6C3DD

		Test case 87-LN-09
		Seed: 			21212285BED53B3411705DAF5F3BDDB6F0618EB571B36EE11A74053407A269F5
		Hash of Keys: 	737061155A9A03F11F9FEBBB940BED4DD54542C4A6212F89A5EB4EC2BE542782
		Message: 		FFE38246BF3DEFD9CAD15CC17CEA511C067D582E04227B479E32F9197CF91482
		Hash of sig: 	C4C12C58032052FB2D21F0C6A7388A63154FB85B74287D2859DE6C1C6F7F277B

		Test case 87-LN-10
		Seed: 			A2744470587C71BA43EC26DC390CE3531978F315993C653E5D3EFD2849D5D9F1
		Hash of Keys: 	B1BF37BFFB11531B6ADD697870D7DB2E2462D0A97A63F09C1D0038457C6D795A
		Message: 		9831A830231A160B9847203341A5F30BF3E87A2A482AEEA6886315C92B5C4E4C
		Hash of sig: 	46C669D2FEB643A38E54FF87B790CC33F44043A1B6B31DB9474D301328CA2A7F
						</h:pre></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/SigVer Cryptographic Operation - Signature Verification -->
        <f-component cc-id="fcs_cop.1" id="fcs-cop-1-sigver" name="Cryptographic Operation - Signature Verification" iteration="SigVer">
          <f-element id="fel-sign-how">
            <title>
              The TSF shall perform [<h:i>digital signature verification</h:i>] in accordance with a specified 
              cryptographic algorithm
              <selectables>
                <tabularize id="tab-fcs-cop-sigver-sels" title="Allowable choices for FCS_COP.1/SigVer">
                  <textcol>Identifier</textcol>
                  <reqtext/>
                  <selectcol>Cryptographic Algorithm</selectcol>
                  <reqtext>and cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic Key Sizes</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations in FCS_COP.1/SigVer.
                    <h:p/>
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-sigver-rsa-pkcs">
                  <col>RSA-PKCS</col>
                  <col>RSASSA-PKCS1-v1_5</col>
                  <col>Modulus of size <selectables><selectable id="fcs_cop.1.1_SigVer_1"><h:i>3072</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_2"><h:i>4096</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_3"><h:i>6144</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_4"><h:i>8192</h:i></selectable></selectables> bits and hash <selectables><selectable id="fcs_cop.1.1_SigVer_5"><h:i>SHA-384</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_6"><h:i>SHA-512</h:i></selectable></selectables></col>
                  <col>RFC 8017 (Section 8.2) [PKCS #1 v2.2]<h:p/>FIPS PUB 186-5 (Section 5.4) [RSASSA-PKCS1-v1_5]</col>
                </selectable>
                <selectable id="sel-fcs-cop-sigver-rsa-pss">
                  <col>RSA-PSS</col>
                  <col>RSASSA-PSS</col>
                  <col>Modulus of size <selectables><selectable id="fcs_cop.1.1_SigVer_7"><h:i>3072</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_8"><h:i>4096</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_9"><h:i>6144</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_10"><h:i>8192</h:i></selectable></selectables> bits and hash <selectables><selectable id="fcs_cop.1.1_SigVer_11"><h:i>SHA-384</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_12"><h:i>SHA-512</h:i></selectable></selectables></col>
                  <col>RFC 8017 (Section 8.1) [PKCS#1 v2.2]<h:p/>FIPS PUB 186-5 (Section 5.4) [RSASSA-PSS]</col>
                </selectable>
                <selectable id="sel-fcs-cop-sigver-ecdsa">
                  <col>ECDSA</col>
                  <col>ECDSA</col>
                  <col>Elliptic Curve <selectables><selectable id="fcs_cop.1.1_SigVer_13"><h:i>P-384</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_14"><h:i>P-521</h:i></selectable></selectables> using hash <selectables><selectable id="fcs_cop.1.1_SigVer_15"><h:i>SHA-384</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_16"><h:i>SHA-512</h:i></selectable></selectables></col>
                  <col><selectables><selectable id="fcs_cop.1.1_SigVer_17"><h:i>ISO/IEC 14888-3:2018 (Subclause 6.6)</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_18"><h:i>FIPS PUB 186-5 (Section 6.4.2)</h:i></selectable></selectables> [ECDSA]<h:p/>NIST SP-800 186 (Section 4) [NIST Curves]</col>
                </selectable>
                <selectable id="sel-fcs-cop-sigver-lms">
                  <col>LMS</col>
                  <col>LMS</col>
                  <col>Private key size =undefined<h:p/>Winternitz parameter =undefined<h:p/>Tree height = <selectables><selectable id="fcs_cop.1.1_SigVer_29"><h:i>5</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_30"><h:i>10</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_31"><h:i>15</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_32"><h:i>20</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_33"><h:i>25</h:i></selectable></selectables></col>
                  <col>RFC 8554 [LMS]<h:p/>NIST SP 800-208 [parameters]</col>
                </selectable>
                <selectable id="sel-fcs-cop-sigver-xmss">
                  <col>XMSS</col>
                  <col>XMSS</col>
                  <col>Private key size =undefined<h:p/>Tree height = <selectables><selectable id="fcs_cop.1.1_SigVer_40"><h:i>10</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_41"><h:i>16</h:i></selectable><selectable id="fcs_cop.1.1_SigVer_42"><h:i>20</h:i></selectable></selectables></col>
                  <col>RFC 8391 [XMSS]<h:p/>NIST SP 800-208 [parameters]</col>
                </selectable>
                <selectable id="sel-fcs-cop-sigver-mldsa">
                  <col>ML-DSA</col>
                  <col>ML-DSA Signature Verification</col>
                  <col>Parameter set = ML-DSA-87</col>
                  <col>NIST FIPS 204 (Section 5.3)</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">The ST author should choose the algorithm implemented to
              perform digital signatures; if more than one algorithm is available, this requirement
              should be iterated to specify the functionality. For the algorithm chosen, the ST
              author should make the appropriate assignments and selections to specify the parameters
              that are implemented for that algorithm.</note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to verify that any one-time values such as nonces or masks
           are constructed and used in accordance with the relevant standards.</TSS>
              <Guidance/>
              <Tests>The following tests are conditional based on the selections made in the SFR. The evaluator shall perform the following tests or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>RSA-PKCS Signature Verification</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">RSA-PKCS </h:td><h:td valign="top">RSASSA-PKCS1-v1_5</h:td><h:td valign="top">Modulus of size [<h:b>selection:</h:b> <h:i>3072, 4096, 6144, 8192</h:i>] bits,
                 hash [<h:b>selection:</h:b> <h:i>SHA-384, SHA-512</h:i>]</h:td><h:td valign="top">RFC 8017 (Section 8.2) [PKCS #1 v2.2]<h:p/>
                 NIST FIPS PUB 186-5 (Section 5.4) [RSASSA-PKCS1-v1_5]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to perform RSA Digital Signature Verification using PKCS1-v1,5 signature type, the evaluator shall perform Generated Data Test using the following input parameters: <h:ul><h:li>Modulus size [3072, 4096, 6144, 8192] bits</h:li> <h:li>Hash algorithm [SHA-384, SHA-512]</h:li></h:ul> <h:p/> <h:br/> <h:b>Generated Data Test</h:b> <h:p/>For each supported combination of the above parameters, the evaluator shall cause the TOE to generate six test cases using a random message and its signature such that the test cases are modified as follows: <h:p/> <h:ul><h:li>One test case is left unmodified</h:li> <h:li>For one test case the Message is modified</h:li> <h:li>For one test case the Signature is modified</h:li> <h:li>For one test case the exponent (<h:i>e</h:i>) is modified</h:li> <h:li>For one test case the IR is moved</h:li> <h:li>For one test case the Trailer is moved</h:li></h:ul> <h:p/>The TOE must correctly verify the unmodified signatures and fail to verify the modified signatures. <h:p/> <h:br/> <h:b>RSA-PSS Signature Verification </h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">RSA-PSS</h:td><h:td valign="top">RSASSA-PSS</h:td><h:td valign="top">Modulus of size [<h:b>selection:</h:b> <h:i>3072, 4096, 6144, 8192</h:i>] bits,
                 hash [<h:b>selection:</h:b> <h:i>SHA-384, SHA-512</h:i>]</h:td><h:td valign="top">RFC 8017 (Section 8.2) [PKCS #1 v2.2]<h:p/>
                 NIST FIPS PUB 186-5 (Section 5.4) [RSASSA-PSS]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to perform RSA Digital Signature Verification using PSS signature type, the evaluator shall perform the Generated Data Test using the following input parameters: <h:ul><h:li>Modulus size [3072, 4096, 6144, 8192] bits</h:li> <h:li>Hash algorithm [SHA-384, SHA-512]</h:li> <h:li>Salt length [0-hash length]</h:li> <h:li>Mask function [MGF1]</h:li></h:ul> <h:p/> <h:br/> <h:b>Generated Data Test</h:b> <h:p/>For each supported combination of the above parameters, the evaluator shall cause the TOE to generate six test cases using random data such that the test cases are modified as follows: <h:p/> <h:ul><h:li>One test case is left unmodified</h:li> <h:li>For one test case the Message is modified</h:li> <h:li>For one test case the Signature is modified</h:li> <h:li>For one test case the exponent (<h:i>e</h:i>) is modified</h:li> <h:li>For one test case the IR is moved</h:li> <h:li>For one test case the Trailer is moved</h:li></h:ul> <h:p/>The TOE must correctly verify the unmodified signatures and fail to verify the modified signatures. <h:p/> <h:br/> <h:b>ECDSA Signature Verification </h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ECDSA</h:td><h:td valign="top">ECDSA</h:td><h:td valign="top">Elliptic Curve [<h:b>selection:</h:b> <h:i>P-384, P-521</h:i>] and hash function using 
                 [<h:b>selection:</h:b> <h:i>SHA-384, SHA-512</h:i>] </h:td><h:td valign="top">[<h:b>selection:</h:b> <h:i>ISO/IEC 14888-3:2018 (Subclause 6.6),
                 NIST FIPS PUB 186-5 (Sections 6.3.1, 6.4.1</h:i>] [ECDSA]<h:p/>
                 NIST SP-800 186 (Section 4) [NIST Curves] </h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to perform ECDSA Digital Signature Verification, the evaluator shall perform the Algorithm Functional Test using the following input parameters: <h:ul><h:li>Elliptic Curve [P-384, P-521]</h:li> <h:li>Hash algorithm [SHA-384, SHA-512]</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>For each supported combination of the above parameters, the evaluator shall cause the TOE to generate test cases consisting of messages and signatures such that the 21 test cases are modified as follows: <h:p/> <h:ul><h:li>Three test cases are left unmodified</h:li> <h:li>For three test cases the Message is modified</h:li> <h:li>For three test cases the key is modified</h:li> <h:li>For three test cases the <h:i>r</h:i> value is modified</h:li> <h:li>For three test cases the <h:i>s</h:i> value is modified</h:li> <h:li>For three test cases the value <h:i>r</h:i> is zeroed</h:li> <h:li>For three test cases the value <h:i>s</h:i> is zeroed</h:li></h:ul> <h:p/>The TOE must correctly verify the unmodified signatures and fail to verify the modified signatures. <h:p/> <h:br/> <h:b>LMS Signature Verification </h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">LMS</h:td><h:td valign="top">LMS</h:td><h:td valign="top">Private key size = [<h:b>selection:</h:b> <h:i>192 bits with [<h:b>selection:</h:b> SHA256/192, SHAKE256/192], 
                 256 bits with [<h:b>selection:</h:b> SHA-256, SHAKE256]</h:i>], 
                 Winternitz parameter = [<h:b>selection:</h:b> <h:i>1, 2, 4, 8</h:i>], 
                 and tree height = [<h:b>selection:</h:b> <h:i>5, 10, 15, 20, 25</h:i>] </h:td><h:td valign="top">RFC 8554 [LMS]<h:p/>
                 NIST SP 800-208 [parameters] </h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to verify cryptographic digital signature using LMS, the evaluator shall perform the Algorithm Functional Test using the following input parameters: <h:ul><h:li>Hash algorithm [SHA-256/192, SHAKE256/192, SHA-256, SHAKE256]</h:li> <h:li>Winternitz [1, 2, 4, 8]</h:li> <h:li>Tree height [5, 10, 15, 20, 25]</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>For each supported combination of the above parameters, the evaluator shall generate four test cases consisting of signed messages and keys, such that <h:ul><h:li>One test case is unmodified (i.e. correct)</h:li> <h:li>For one test case modify the message, i.e. the message is different</h:li> <h:li>For one test case modify the signature, i.e. signature is different</h:li> <h:li>For one test case modify the signature header so that it is a valid header for a different
               LMS parameter set.</h:li></h:ul> <h:p/>The TOE must correctly verify the unmodified test case and fail to verify the modified test cases. <h:p/> <h:br/> <h:b>XMSS Signature Verification</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">XMSS</h:td><h:td valign="top">XMSS</h:td><h:td valign="top">Private key size = [<h:b>selection:</h:b> <h:i>192 bits with [<h:b>selection:</h:b> SHA256/192, SHAKE256/192], 
                   256 bits with [<h:b>selection:</h:b> SHA-256, SHAKE256]</h:i>], 
                 and tree height = [<h:b>selection:</h:b> <h:i>10, 16, 20</h:i>] </h:td><h:td valign="top">RFC 8391 [XMSS] <h:p/>
                 NIST SP 800-208 [parameters]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to verify digital signatures using XMSS or XMSS MT, the evaluator shall perform the XMSS digital signature verification test using the following input parameters: <h:ul><h:li>Hash algorithm [SHA-256/192, SHAKE256/192, SHA-256, SHAKE256]</h:li> <h:li>Tree height [10, 16, 20]</h:li></h:ul> <h:p/> <h:br/> <h:b>XMSS Digital Signature Verification Test</h:b> <h:p/>For each supported combination of the above parameters, the evaluator shall generate four test cases consisting of signed messages and keys, such that <h:ul><h:li>One test case is unmodified (i.e. correct)</h:li> <h:li>For one test case modify the message, i.e. the message is different</h:li> <h:li>For one test case modify the signature, i.e. signature is different</h:li> <h:li>For one test case modify the signature header so that it is a valid header 
               for a different XMSS parameter set</h:li></h:ul> <h:p/>The evaluator shall verify the correctness of the implementation by verifying that the TOE correctly verifies the unmodified test case and fails to verify the modified test cases. <h:p/> <h:br/> <h:b>ML-DSA Signature Verification</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm Parameters</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ML-DSA</h:td><h:td valign="top">ML-DSA SigVer</h:td><h:td valign="top">Parameter set = ML-DSA-87</h:td><h:td valign="top">NIST FIPS PUB 204 (Section 5.2)</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to validate digital signatures using ML-DSA, the evaluator shall perform the Algorithm Functional Test using the following input parameters: <h:ul><h:li>Parameter set [ML-DSA-87]</h:li> <h:li>Previously generated signed Message [8-65535] bytes</h:li> <h:li><h:i>Mu</h:i> value (if generated externally)</h:li> <h:li>Context (for external interface testing)</h:li> <h:li>Previously generated public key (<h:i>pk</h:i>)</h:li> <h:li>Previously generated Signature</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>For each combination of supported parameter set and capabilities, the evaluator shall require the implementation under test to validate 15 signatures. Each group of 15 test cases is modified as follows: <h:ul><h:li>Three test cases are left unmodified</h:li> <h:li>For three test cases the Signed message is modified</h:li> <h:li>For three test cases the component of the signature that commits the signer to the message is
               modified</h:li> <h:li>For three test cases the component of the signature that allows the verifier to construct the vector z is
               modified</h:li> <h:li>For three test cases the component of the signature that allows the verifier to construct the hint array
               is modified</h:li></h:ul> <h:p/>The TOE must correctly verify the unmodified signatures and fail to verify the modified signatures.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/SKC Cryptographic Operation - Encryption/Decryption -->
        <f-component cc-id="fcs_cop.1" id="fcs-cop-1-skc" name="Cryptographic Operation - Encryption/Decryption" iteration="SKC" status="sel-based">
          <depends on-sel="fel-dar-how-cbc"/>
          <depends on-sel="fel-dar-how-xts"/>
          <depends on-sel="fcs_tlsc_ext.1.2_7"/>
          <depends on-sel="fcs_tlsc_ext.1.2_8"/>
          <depends on-sel="fcs_tlsc_ext.1.2_14"/>
          <depends on-sel="fcs_tlsc_ext.1.2_15"/>
          <depends on-sel="fcs_tlsc_ext.1.2_18"/>
          <depends on-sel="fcs_tlsc_ext.1.2_19"/>
          <depends on-sel="fcs_tlsc_ext.1.2_20"/>
          <depends on-sel="fcs_tlsc_ext.1.2_21"/>
          <depends on-sel="fcs_tlsc_ext.1.2_22"/>
          <depends on-sel="fcs_dtlsc_ext.1.2_7"/>
          <depends on-sel="fcs_dtlsc_ext.1.2_8"/>
          <depends on-sel="fcs_dtlsc_ext.1.2_14"/>
          <depends on-sel="fcs_dtlsc_ext.1.2_15"/>
          <depends on-sel="fcs_dtlsc_ext.1.2_18"/>
          <depends on-sel="fcs_dtlsc_ext.1.2_19"/>
          <depends on-sel="fcs_dtlsc_ext.1.2_20"/>
          <depends on-sel="fcs_dtlsc_ext.1.2_21"/>
          <depends on-sel="fcs_dtlsc_ext.1.2_22"/>
          <f-element id="fel-encrypt-how">
            <title>
              The TSF shall perform [<h:i>symmetric-key encryption and decryption</h:i>] in accordance with a 
              specified cryptographic algorithm
              <selectables>
                <tabularize id="fcs-cop-skc-sels" title="Allowable choices for FCS_COP.1/SKC">
                  <textcol>Identifier</textcol>
                  <reqtext/>
                  <selectcol>Cryptographic Algorithm</selectcol>
                  <reqtext>and cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic Key Sizes</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations in FCS_COP.1/SKC.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-skc-aes-cbc">
                  <col>AES-CBC</col>
                  <col>AES in CBC mode with non-repeating and unpredictable IVs</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_SKC_1"><h:i>ISO/IEC 18033-3:2010 (Subclause 5.2)</h:i></selectable><selectable id="fcs_cop.1.1_SKC_2"><h:i>FIPS PUB 197</h:i></selectable></selectables> [AES]<h:p/> <selectables><selectable id="fcs_cop.1.1_SKC_3"><h:i>ISO/IEC 10116:2017 (Clause 7)</h:i></selectable><selectable id="fcs_cop.1.1_SKC_4"><h:i>NIST SP 800-38A</h:i></selectable></selectables> [CBC]</col>
                </selectable>
                <selectable id="sel-fcs-cop-skc-aes-xts">
                  <col>XTS-AES</col>
                  <col>AES in XTS mode with unique tweak values that are consecutive non-negative integers starting at an arbitrary non-negative integer</col>
                  <col>512 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_SKC_5"><h:i>ISO/IEC 18033-3:2010 (Subclause 5.2)</h:i></selectable><selectable id="fcs_cop.1.1_SKC_6"><h:i>FIPS PUB 197</h:i></selectable></selectables> [AES]<h:p/> <selectables><selectable id="fcs_cop.1.1_SKC_7">IEEE Std. 1619-2018</selectable><selectable id="fcs_cop.1.1_SKC_8">NIST SP 800-38E</selectable></selectables> [XTS]</col>
                </selectable>
              </selectables>
            </title>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to ensure that it describes the construction of any IVs,
                tweak values, and counters in conformance with the relevant specifications.
                <h:p/>
                If XTS-AES is claimed then the evaluator shall examine the TSS to verify that the TOE creates
                full-length keys by methods that ensure that the two key halves are different and independent.
              </TSS>
              <Guidance/>
              <Tests>The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products. <h:p/>The following tests are conditional based on the selections made in the SFR. The evaluator shall perform the following tests or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:br/> <h:b>AES-CBC</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">AES-CBC</h:td><h:td valign="top">AES in CBC mode with non-repeating and unpredictable IVs</h:td><h:td valign="top">256 bits</h:td><h:td valign="top">
                      [<h:b>selection:</h:b> <h:i>ISO/IEC 18033-3:2010 (Subclause 5.2),
                      FIPS PUB 197</h:i>] [AES]<h:p/>
                      [<h:b>selection:</h:b> <h:i>ISO/IEC 10116:2017 (Clause 7), 
                      NIST SP 800-38A</h:i>] [CBC]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to encrypt and decrypt data using AES in CBC mode, the evaluator shall perform Algorithm Functional Tests and Monte Carlo Tests using the following input parameters: <h:ul><h:li>Key size [256] bits</h:li> <h:li>Direction [encryption, decryption]</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Tests</h:b> <h:p/>Algorithm Functional Tests are designed to verify the correct operation of the logical components of the algorithm implementation under normal operation using different block sizes. For AES-CBC, there are two types of AFTs: <h:p/> <h:br/> <h:b><h:i>Known-Answer Tests</h:i></h:b> <h:p/>For each combination of direction and claimed key size, the TOE must be tested using the GFSBox, KeySbox, VarTxt, and VarKey test cases listed in Appendixes B through E of <h:i>The
                  Advanced Encryption Standard Algorithm Validation Suite (AESAVS)</h:i>, NIST, 15 November 2002. <h:p/> <h:br/> <h:b><h:i>Multi-Block Message Tests</h:i></h:b> <h:p/>For each combination of direction and claimed key size, the TOE must be tested against 10 test cases consisting of a random IV, random key, and random plaintext or ciphertext. The plaintext or ciphertext starts with a length of 16 bytes and increases by 16 bytes for each test case until reaching 160 bytes. <h:p/> <h:br/> <h:b><h:i>Monte Carlo Tests</h:i></h:b> <h:p/>Monte Carlo tests are intended to test the implementation under strenuous conditions. The TOE must process the test cases according to the following algorithm once for each combination of direction and key size: <h:p/> <h:pre>
                  Key[0] = Key
                  IV[0] = IV
                  PT[0] = PT
                  for i = 0 to 99 {
                  Output Key[i], IV[i], PT[0]
                  for j = 0 to 999 {
                  if (j == 0) {
                  CT[j] = AES-CBC-Encrypt(Key[i], IV[i], PT[j])
                  PT[j+1] = IV[i]
                  } else {
                  CT[j] = AES-CBC-Encrypt(Key[i], PT[j])
                  PT[j+1] = CT[j-1]
                  }
                  }
                  Output CT[j]
                  AES_KEY_SHUFFLE(Key, CT)
                  IV[i+1] = CT[j]
                  PT[0] = CT[j-1]
                  }
                </h:pre> <h:p/>where <h:pre>AES_KEY_SHUFFLE</h:pre>is defined as: <h:p/> <h:pre>
                  If ( keylen = 128 )
                  Key[i+1] = Key[i] xor MSB(CT[j], 128)
                  If ( keylen = 192 )
                  Key[i+1] = Key[i] xor (LSB(CT[j-1], 64) || MSB(CT[j], 128))
                  If ( keylen = 256 )
                  Key[i+1] = Key[i] xor (MSB(CT[j-1], 128) || MSB(CT[j], 128))
                </h:pre> <h:p/>The above pseudocode is for encryption. For decryption, swap all instances of CT and PT. <h:p/>The initial IV, key, and plaintext or ciphertext should be random. <h:p/>The evaluator shall test the decrypt functionality using the same test as above, exchanging CT and PT, and replacing AES-CBC-Encrypt with AES-CBC-Decrypt. <h:p/> <h:br/> <h:b>XTS-AES</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">XTS-AES</h:td><h:td valign="top">AES in XTS mode with unique tweak values that are consecutive
                      non-negative integers starting at an arbitrary non-negative integer</h:td><h:td valign="top">512 bits</h:td><h:td valign="top">
                      [<h:b>selection:</h:b> <h:i>ISO/IEC 18033-3:2010 (Subclause 5.2),
                      FIPS PUB 197</h:i>] [AES]<h:p/>
                      [<h:b>selection:</h:b> <h:i>IEEE Std. 1619-2018, 
                      NIST SP 800-38E</h:i>] [XTS]</h:td></h:tr></h:table> <h:p/>To test the TOE’s ability to encrypt and decrypt data using AES in XTS mode, the evaluator shall perform the Single Data Unit Test and the Multiple Data Unit Test using the following input parameters: <h:ul><h:li>Direction [encryption, decryption]</h:li> <h:li>Key size [512] bits</h:li> <h:li>Tweak value format [128-bit hex string, data unit sequence number]</h:li></h:ul> <h:p/> <h:br/> <h:b>Single Data Unit Test</h:b> <h:p/>For each combination of claimed key size, direction, and supported tweak value format, the evaluator shall generate 50 test cases consisting of random payload data. The payload data size is determined randomly for each test case from supported values within the range [128-65536] bits. The payload size and data unit size must be equal. <h:p/> <h:br/> <h:b>Multiple Data Unit Test</h:b> <h:p/>For each combination of claimed key size, direction, and supported tweak value format, the evaluator shall generate 50 test cases consisting of random payload data. The payload data size is determined randomly for each test case from supported values within the range [128-65536] bits. Likewise, the data unit size is determined randomly for each test case from supported values within the range [128-65535] bits. The payload size and data unit size must not be equal. <h:p/>The evaluator shall verify the correctness of the TSF’s implementation by comparing values generated by the TSF with those generated by a known good implementation using the same input parameters.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/XOF Cryptographic Operation - Extendable-Output Function -->
        <f-component cc-id="fcs_cop.1" id="sfr-fcs-cop-1-xof" name="Cryptographic Operation - Extendable-Output Function" iteration="XOF" status="sel-based">
          <depends on-sel="sel-fcs-ckm-ak-lms"/>
          <depends on-sel="sel-fcs-ckm-ak-xmss"/>
          <depends on-sel="sel-fcs-cop-sigver-lms"/>
          <depends on-sel="sel-fcs-cop-sigver-xmss"/>
          <f-element id="fcs-cop-1e1-xof">
            <title>
              The TSF shall perform [<h:i>extendable-output function</h:i>] in accordance with a specified cryptographic algorithm
              <selectables>
                <tabularize id="fcs-cop-xof-sels" title="Allowable choices for FCS_COP.1/XOF">
                  <selectcol>Cryptographic Algorithm</selectcol>
                  <reqtext>and parameters</reqtext>
                  <selectcol>Parameters</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_COP.1/XOF.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-xof-shake">
                  <col>SHAKE</col>
                  <col>Functions = [SHAKE128, SHAKE256]</col>
                  <col>NIST FIPS PUB 202 Section 6.2 [SHAKE]</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">
              In accordance with CNSA 2.0, SHAKE is permitted to be used only as a component of LMS or XMSS. 
              Therefore this component is claimed only if LMS or XMSS is claimed in FCS_COP.1/SigVer.
              <h:p/>
              Since LMS and XMSS use both SHAKE128 and SHAKE256 internally, claiming and testing of both
              functions is mandatory.
            </note>
            <aactivity>
              <TSS/>
              <Guidance/>
              <Tests>The following tests are conditional based on the selections made in the SFR. The evaluator shall perform the following tests or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>SHAKE</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">SHAKE</h:td><h:td valign="top">Function = [SHAKE128, SHAKE256]</h:td><h:td valign="top">NIST FIPS PUB 202 Section 6.2 [SHAKE]</h:td></h:tr></h:table> <h:p/>To test the TOE’s implementation of the SHAKE Extendable Output Function the evaluator shall perform the Algorithm Functional Test, Monte Carlo Test, and Variable Output Test using the following input parameters: <h:ul><h:li>Function [SHAKE128, SHAKE256]</h:li> <h:li>Output length [16-65536] bits</h:li></h:ul> <h:p/> <h:br/> <h:b><h:i>Algorithm Functional Test</h:i></h:b> <h:p/>For each supported function, generate test cases consisting of random data for every message length from 0 bits (if supported) to <h:i>rate</h:i>-1 bits, where <h:i>rate</h:i>equals <h:p/> <h:ul><h:li>1344 for SHAKE128, and</h:li> <h:li>1088 for SHAKE256.</h:li></h:ul> <h:p/>Additionally, generate tests cases of random data for messages of every multiple of (rate+1) bits starting at length rate, and continuing until 65535 is exceeded. For SHAKE128, this should result in a total of 1391 test cases. <h:p/> <h:br/> <h:b><h:i>Monte Carlo Test</h:i></h:b> <h:p/>The Monte Carlos test takes in a single 128-bit message (SEED) and desired output length in bits, and runs 100 iterations of the chained computation. MaxOutBytes and MinOutBytes are the largest and smallest supported input and output sizes in bytes, respectively. <h:p/> <h:pre>
                  Range = maxOutBytes - minOutBytes + 1
                  OutputLen = maxOutBytes
                  For j = 0 to 99
                  MD[0] = SEED
                  For i = 1 to 1000
                  MSG[i] = 128 leftmost bits of MD[i-1]
                  if (MSG[i] &lt; 128 bits)
                  Append 0 bits on rightmost side of MSG[i] til MSG[i] is 128 bits
                  MD[i] = SHAKE(MSG[i], OutputLen * 8)
                  
                  RightmostOutputBits = 16 rightmost bits of MD[i] as an integer
                  OutputLen = minOutBytes + (RightmostOutputBits % Range)
                  Output MD[1000], OutputLen
                  SEED = MD[1000]
                </h:pre> <h:p/> <h:br/> <h:b><h:i>Variable Output Test</h:i></h:b> <h:p/>This test measures the ability of the TOE to generate output digests of varying sizes. <h:p/>The evaluator shall generate 512 test cases such that the input for each test case consists of 128- bits of random data, and the output length includes the minimum supported value, the maximum supported value, and 510 random values between the minimum and maximum digest sizes supported by the implementation. <h:p/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_HTTPS_EXT.1 HTTPS Protocol -->
        <f-component cc-id="fcs_https_ext.1" id="fcs-https-ext-1" name="HTTPS Protocol">
          <comp-lev> requires the TSF to implement the HTTPS protocol in accordance with the specified standard, using TLS, and notifying the application if invalid.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Configuring whether to allow or disallow establishment of a trusted channel if the peer or server certificate is deemed invalid.</h:li>
            </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Failure of the certificate validity check.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            FCS_TLS_EXT.1 TLS Protocol
            <h:br/>
            FIA_X509_EXT.1 X.509 Validation of Certificates
          </dependencies>
          <f-element id="fel-https-how">
            <title>The TSF shall implement the HTTPS protocol that complies with RFC 2818. </title>
          </f-element>
          <f-element id="fel-https-tls">
            <title>The TSF shall implement HTTPS using TLS as defined in [<h:i>the <xref to="tls"/></h:i>].</title>
            <ext-comp-def-title>
              <title>
                The TSF shall implement HTTPS using TLS as defined in
                <assignable>specification that defines TLS implementation requirements</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              The
              <xref to="tls"/>
              must be included in the ST, with the following selections made:
              <h:ul>
                <h:li>FCS_TLS_EXT.1:</h:li>
                <h:ul>
                  <h:li>TLS must be selected</h:li>
                  <h:li>Client must be selected</h:li>
                </h:ul>
              </h:ul>
            </note>
          </f-element>
          <f-element id="fel-conn-notify">
            <title>The TSF shall notify the application and  <selectables><selectable id="s-not-estab">not establish the connection</selectable><selectable id="s-req-app-auth">request application authorization to establish the connection</selectable><selectable id="s-no-other-action" exclusive="yes">no other action</selectable></selectables>  if the peer certificate is deemed invalid. </title>
            <ext-comp-def-title>
              <title>The TSF shall notify the application and <assignable>a response</assignable> if the peer certificate is deemed invalid.</title>
            </ext-comp-def-title>
            <note role="application">
              Validity is determined by the certificate path, the expiration
            date, and the revocation status in accordance with RFC 5280.
              <h:br/>
              <h:br/>
              The selection made for FCS_HTTPS_EXT.1.3 must be consistent with the claims made in FCS_TLSC_EXT.1.6 of
              <xref to="tls"/>, e.g. if the TLS rejects all invalid certificates with no exceptions, then "not establish the connection" will be selected here.
              
	    FMT_SMF_EXT.1 Function
              <xref to="mf-certInvalid"/>
              configures whether to allow or disallow the establishment of a
              trusted channel if the peer certificate is deemed invalid.
            </note>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <testlist>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall attempt to establish an HTTPS connection with a webserver, observe the traffic with a packet analyzer, and verify that the connection succeeds and that the traffic is identified as TLS or HTTPS. <h:br/>  <h:br/> Other tests are performed in conjunction with testing in the <xref to="tls"/>. <h:br/>  <h:br/> Certificate validity shall be tested in accordance with testing performed for FIA_X509_EXT.1 as defined in <xref to="X509"/>, and the evaluator shall perform the following test:</test>
                  <test>The evaluator shall demonstrate that using a certificate without a valid certification path results in an application notification. Using the administrative guidance, the evaluator shall then load a certificate or certificates to the Trust Anchor Database needed to validate the certificate to be used in the function, and demonstrate that the function succeeds. The evaluator then shall delete one of the certificates, and show that the application is notified of the validation failure.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Failure of the certificate validity check.</audit-event-descr>
            <audit-event-info>Issuer Name and Subject Name of certificate</audit-event-info>
            <audit-event-info>
              <selectables onlyone="yes">
                <selectable>User’s authorization decision</selectable>
                <selectable>No additional information</selectable>
              </selectables>
            </audit-event-info>
          </audit-event>
        </f-component>
        <!-- FCS_IV_EXT.1 Initialization Vector Generation -->
        <f-component cc-id="fcs_iv_ext.1" id="fcs-iv-ext-1" name="Initialization Vector Generation">
          <comp-lev> requires the TSF to generate IVs in accordance with a set of approved modes. </comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-ivs-how">
            <title>The TSF shall generate IVs in accordance with [<h:i><xref to="ivtable"/>:
              References and IV Requirements for NIST-approved Cipher Modes</h:i>]. </title>
            <ext-comp-def-title>
              <title>The TSF shall generate IVs in accordance with <assignable>standard or specification for IV generation</assignable>. </title>
            </ext-comp-def-title>
            <note role="application">
              <xref to="ivtable"/>
              lists the requirements for composition of IVs according to
              the NIST Special Publications for each cipher mode. The composition of IVs generated
              for encryption according to a cryptographic protocol is addressed by the protocol.
              Thus, this requirement addresses only IVs generated for key storage and data storage
              encryption.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the key hierarchy section of the TSS to ensure that
                the encryption of all keys is described and the formation of the IVs for each key
                encrypted by the same KEK meets FCS_IV_EXT.1.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG.1 Random Bit Generation (RBG) -->
        <f-component cc-id="fcs_rbg.1" id="fcs-rbg-1" name="Random Bit Generation (RBG)">
          <f-element id="fel-rbg-init-seed">
            <title>
              The TSF shall perform deterministic random bit generation services using
              <selectables linebreak="yes">
                <selectable id="fcs_rbg.1.1_1">Hash_DRBG (any)</selectable>
                <selectable id="fcs_rbg.1.1_2">HMAC_DRBG (any)</selectable>
                <selectable id="fcs_rbg.1.1_3">CTR_DRBG (AES)</selectable>
              </selectables>
              in accordance
              with [<h:i>NIST SP 800-90A</h:i>] after initialization with a seed.
            </title>
            <note role="application">NIST SP 800-90A contains three different methods of generating random numbers;
              each of these, in turn, depends on underlying cryptographic primitives (hash functions/ciphers).
              The ST author will select the function used and include the specific underlying cryptographic primitives used in the requirement or in the TSS.
              Only the hash function SHA-384 is allowed for Hash_DRBG or HMAC_DRBG,
              only AES-based implementations for CTR_DRBG are allowed.</note>
            <aactivity level="element">
              <TSS>The evaluator shall verify that the TSS identifies the DRBGs used by the TOE.</TSS>
              <Guidance>If the DRBG functionality is configurable, the evaluator shall verify that the operational guidance includes instructions on how to configure this behavior.</Guidance>
              <Tests>
                <h:p>The evaluator shall perform the following tests:</h:p>
                <h:p>The evaluator shall perform 15 trials for the RNG implementation. If the RNG
                  is configurable, the evaluator shall perform 15 trials for each configuration. The
                  evaluator shall also confirm that the operational guidance contains appropriate
                  instructions for configuring the RNG functionality.</h:p>
                <h:p>If the RNG has  prediction resistance enabled, each trial consists of (1) instantiate DRBG, (2)
                  generate the first block of random bits (3) generate a second block of random bits
                  (4) uninstantiate. The evaluator verifies that the second block of random bits is
                  the expected value. The evaluator shall generate eight input values for each
                  trial. The first is a count (0 – 14). The next three are entropy input, nonce, and
                  personalization string for the instantiate operation. The next two are additional
                  input and entropy input for the first call to generate. The final two are
                  additional input and entropy input for the second call to generate. These values
                  are randomly generated. "generate one block of random bits" means to generate
                  random bits with number of returned bits equal to the Output Block Length (as
                  defined in NIST SP 800-90A).</h:p>
                <h:p>If the RNG does not have prediction resistance,
                  each trial consists of (1) instantiate DRBG, (2) generate the first block of
                  random bits (3) reseed, (4) generate a second block of random bits (5)
                  uninstantiate. The evaluator verifies that the second block of random bits is the
                  expected value. The evaluator shall generate eight input values for each trial.
                  The first is a count (0 – 14). The next three are entropy input, nonce, and
                  personalization string for the instantiate operation. The fifth value is
                  additional input to the first call to generate. The sixth and seventh are
                  additional input and entropy input to the call to reseed. The final value is
                  additional input to the second generate call.</h:p>
                <h:p>
                  The following list contains more information on some of the input values to be generated/selected by the evaluator.
                  <h:ul>
                    <h:li>
                      <h:b>Entropy input:</h:b>
                      The length of the entropy input value must equal the seed
                      length.
                    </h:li>
                    <h:li>
                      <h:b>Nonce:</h:b>
                      If a nonce is supported (CTR_DRBG with no Derivation Function does
                      not use a nonce), the nonce bit length is one-half the seed length.
                    </h:li>
                    <h:li>
                      <h:b>Personalization string:</h:b>
                      The length of the personalization string must be
                      less than or equal to seed length. If the implementation only supports one
                      personalization string length, then the same length can be used for both values.
                      If more than one string length is support, the evaluator shall use personalization
                      strings of two different lengths. If the implementation does not use a
                      personalization string, no value needs to be supplied.
                    </h:li>
                    <h:li>
                      <h:b>Additional input:</h:b>
                      The additional input bit lengths have the same defaults
                      and restrictions as the personalization string lengths.
                    </h:li>
                  </h:ul>
                </h:p>
              </Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-rbg-init-seed-how">
            <title>
              The TSF shall use a
              <selectables>
                <selectable id="internal-seed">TSF noise source <assignable>name of noise source</assignable></selectable>
                <selectable id="internal-seeds">
                  <h:b>multiple TSF noise sources <assignable>names of noise sources</assignable></h:b>
                </selectable>
                <selectable id="external-seed">TSF interface for seeding</selectable>
              </selectables>
              for initialized seeding.
            </title>
            <note role="application">
              <h:p>For the 
                selection in this requirement, the ST author selects "TSF noise source" if
                a single noise source is used as input to the DRBG. The ST author selects "multiple TSF noise sources" if a seed is formed from a combination of two or more noise sources within the TOE boundary. If the TSF implements two or more separate DRBGs that are seeded in separate manners, this SFR should be iterated for each DRBG. It multiple distinct noise sources exist such that each DRBG only uses one of them, then each iteration would select "TSF noise source"; "multiple TSF noise sources" is only selected if a single DRBG uses multiple noise sources for its seed. The ST author selects "TSF interface for seeding" if noise source data is generated outside the TOE boundary.</h:p>
              <h:p>If "TSF noise source" is selected, FCS_RBG.3 must be claimed.</h:p>
              <h:p>If "multiple TSF noise sources" is selected, FCS_RBG.4 and FCS_RBG.5 must be claimed.</h:p>
              <h:p>If "TSF interface for seeding" is selected, FCS_RBG.2 must be claimed.</h:p>
            </note>
            <aactivity level="element">
              <no-tests>
                Documentation will be produced - and the evaluator shall perform the
                activities - in accordance with
                <xref to="entropyappendix"/>
                and
                the
                <h:a href="https://niap-ccevs.org/Documents_and_Guidance/ccevs/Entropy%20Documentation%20and%20Assessment%20Clarification.pdf">Clarification to the Entropy Documentation and Assessment Annex</h:a>.
              </no-tests>
            </aactivity>
          </f-element>
          <f-element id="fel-rbg-init-seed-when">
            <title>
              The TSF shall update the RBG state by
              <selectables>
                <selectable id="fcs_rbg.1.3_1">reseeding</selectable>
                <selectable id="fcs_rbg.1.3_2">uninstantiating and reinstantiating</selectable>
              </selectables>
              using a
              <selectables>
                <selectable id="fcs_rbg.1.3_3">TSF noise source <assignable>name of noise source</assignable></selectable>
                <selectable id="fcs_rbg.1.3_5">TSF interface for seeding</selectable>
              </selectables>
              in the following situations:
              <selectables linebreak="yes">
                <selectable id="fcs_rbg.1.3_6">never</selectable>
                <selectable id="fcs_rbg.1.3_7">on demand</selectable>
                <selectable id="fcs_rbg.1.3_8">on the condition: <assignable>condition</assignable></selectable>
                <selectable id="fcs_rbg.1.3_10">after <assignable>time</assignable></selectable>
              </selectables>
              in accordance with
              <assignable>list of standards</assignable>.
            </title>
            <aactivity level="element">
              <TSS>The evaluator shall verify that the TSS identifies how the DRBG state is updated, and the situations under which this may occur.</TSS>
              <Guidance>If the ST claims that the DRBG state can be updated on demand, the evaluator shall verify that the operational guidance has instructions for how to perform this operation.</Guidance>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Failure of the randomization process</audit-event-descr>
            <audit-event-info>None.</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FCS_RBG.2 Random Bit Generation (External Seeding) -->
        <f-component cc-id="fcs_rbg.2" id="fcs-rbg-2" name="Random Bit Generation (External Seeding)" status="sel-based">
          <depends on-sel="external-seed"/>
          <f-element id="fe1-rbg-seed">
            <title>
              The TSF shall be able to accept a minimum input of
              <assignable>minimum input length greater than zero</assignable>
              from a TSF interface for the purpose of seeding.
            </title>
            <note role="application">This requirement is claimed when a DRBG is seeded with entropy from one or more noise source that is outside the TOE boundary. In the case of a mobile device this would likely only occur when the entropy source is a Dedicated Security Component that is integrated with the TOE. Typically the entropy produced by an environmental noise source is conditioned such that the input length has full entropy and is therefore usable as the seed. However, if this is not the case, it should be noted what the minimum entropy rate of the noise source is so that the TSF can collect a sufficiently large sample of noise data to be conditioned into a seed value.</note>
            <aactivity>
              <h:p>The evaluator shall examine the entropy documentation required by FCS_RBG.1.2 to verify that it identifies, for each DRBG function implemented by the TOE, the TSF external interface used to seed the TOE's DRBG. The evaluator shall verify that this includes the amount of sampled data and the min-entropy rate of the sampled data such that it can be determined that sufficient entropy can be made available for the highest strength keys that the TSF can generate (e.g., 256 bits). If the seed data cannot be assumed to have full entropy (e.g., the min-entropy of the sampled bits is less than 1), the evaluator shall ensure that the entropy documentation describes the method by which the TOE estimates the amount of entropy that has been accumulated to ensure that sufficient data is collected and any conditioning that the TSF applies to the output data to create a seed of sufficient size with full entropy.</h:p>
              <TSS/>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG.3 Random Bit Generation (Internal Seeding - Single Source) -->
        <f-component cc-id="fcs_rbg.3" id="fcs-rbg-3" name="Random Bit Generation (Internal Seeding - Single Source)" status="sel-based">
          <depends on-sel="internal-seed"/>
          <f-element id="fel-rbg-seed-int-sing">
            <title>
              The TSF shall be able to seed the RBG using a
              <selectables onlyone="yes">
                <selectable id="fcs_rbg.3.1_1">TSF software-based noise source</selectable>
                <selectable id="fcs_rbg.3.1_2">TSF hardware-based noise source <assignable>name of noise source</assignable></selectable>
              </selectables>
              with a minimum of
              <assignable>number of bits</assignable>
              bits of min-entropy.
            </title>
            <note role="application">This requirement is claimed when a DRBG is seeded with entropy from a single noise source that is within the TOE boundary. Min-entropy should be expressed as a ratio of entropy bits to sampled bits so that the total amount of data needed to ensure full entropy is known, as well as the conditioning function by which that data is reduced in size to the seed.</note>
            <aactivity>
              <h:p>The evaluator shall examine the entropy documentation required by FCS_RBG.1.2 to verify that it identifies, for each DRBG function implemented by the TOE, the TSF noise source used to seed the TOE's DRBG. The evaluator shall verify that this includes the amount of sampled data and the min-entropy rate of the sampled data such that it can be determined that sufficient entropy can be made available for the highest strength keys that the TSF can generate (e.g., 256 bits). If the seed data cannot be assumed to have full entropy (e.g., the min-entropy of the sampled bits is less than 1), the evaluator shall ensure that the entropy documentation describes the method by which the TOE estimates the amount of entropy that has been accumulated to ensure that sufficient data is collected and any conditioning that the TSF applies to the output data to create a seed of sufficient size with full entropy.</h:p>
              <TSS/>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG.4 Random Bit Generation (Internal Seeding - Multiple Sources) -->
        <f-component cc-id="fcs_rbg.4" id="fcs-rbg-4" name="Random Bit Generation (Internal Seeding - Multiple Sources)" status="sel-based">
          <depends on-sel="internal-seeds"/>
          <f-element id="fel-rbg-seed-int-mult">
            <title>
              The TSF shall be able to seed the RBG using
              <selectables>
                <selectable id="fcs_rbg.4.1_1"><assignable>number</assignable> TSF software-based noise source(s)</selectable>
                <selectable id="fcs_rbg.4.1_3"><assignable>number</assignable> TSF hardware-based noise source(s)</selectable>
              </selectables>.
            </title>
            <note role="application">This requirement is claimed when a DRBG is seeded with entropy from multiple noise sources that are within the TOE boundary. 
              FCS_RBG.5 defines the mechanism by which these sources are combined to ensure sufficient minimum entropy.</note>
            <aactivity>
              <h:p>The evaluator shall examine the entropy documentation required by FCS_RBG.1.2 to verify that it identifies, for each DRBG function implemented by the TOE, each TSF noise source used to seed the TOE's DRBG. The evaluator shall verify that this includes the amount of sampled data and the min-entropy rate of the sampled data from each data source.</h:p>
              <TSS/>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG.5 Random Bit Generation (Combining Noise Sources) -->
        <f-component cc-id="fcs_rbg.5" id="fcs-rbg-5" name="Random Bit Generation (Combining Noise Sources)" status="sel-based">
          <depends on-sel="internal-seeds"/>
          <f-element id="fel-rbg-comb">
            <title>
              The TSF shall
              <assignable>combining operation</assignable>
              <selectables>
                <selectable id="fcs_rbg.5.1_2">output from TSF noise source(s)</selectable>
                <selectable id="fcs_rbg.5.1_3">input from TSF interface(s) for seeding</selectable>
              </selectables>
              to create the entropy input into the derivation function as defined in
              <assignable>list of standards</assignable>, resulting
              in a minimum of
              <assignable>number of bits</assignable>
              bits of min-entropy.
            </title>
            <aactivity>
              <h:p>Using the entropy sources specified in FCS_RBG.4, the evaluator shall examine the entropy documentation required by FCS_RBG.1.2 to verify that it describes the method by which the various entropy sources are combined into a single seed. This should include an estimation of the rate at which each noise source outputs data and whether this is dependent on any system-specific factors so that each source's relative contribution to the overall entropy is understood. The evaluator shall verify that the resulting combination of sampled data and the min-entropy rate of the sampled data is described in sufficient detail to determine that sufficient entropy can be made available for the highest strength keys that the TSF can generate (e.g., 256 bits). If the seed data cannot be assumed to have full entropy (e.g., the min-entropy of the sampled bits is less than 1), the evaluator shall ensure that the entropy documentation describes the method by which the TOE estimates the amount of entropy that has been accumulated to ensure that sufficient data is collected and any conditioning that the TSF applies to the output data to create a seed of sufficient size with full entropy.</h:p>
              <TSS/>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG.6 Random Bit Generation Service -->
        <f-component cc-id="fcs_rbg.6" id="fcs-rbg-6" name="Random Bit Generation Service">
          <f-element id="fel-external-service">
            <title>
              The TSF shall provide a
              <selectables>
                <selectable id="fcs_rbg.6.1_1">hardware</selectable>
                <selectable id="fcs_rbg.6.1_2">software</selectable>
                <selectable id="fcs_rbg.6.1_4">
                  <assignable>other interface type</assignable>
                </selectable>
              </selectables>
              interface to make the RBG output, as specified in FCS_RBG.1 Random bit generation (RBG),
              available as a service to entities outside of the TOE.
            </title>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS identifies the interface that the TSF makes available for calling applications to obtain DRBG output.</TSS>
              <Guidance>The evaluator shall verify that the guidance documentation includes an API specification for the random bit generation service such that it is clear how a calling application is able to obtain DRBG output from the TSF.</Guidance>
              <Tests>The evaluator shall invoke the API specified by the guidance documentation to determine that the TSF provides DRBG output upon proper invocation of the API.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG_EXT.2 Random Bit Generator State Preservation -->
        <f-component cc-id="fcs_rbg_ext.2" id="fcs-rbg-ext-2" name="Random Bit Generator State Preservation" status="objective">
          <comp-lev> requires the TSF to save and restore the state of the RBG when powering off and starting up.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_RBG.1 Random Bit Generation</dependencies>
          <f-element id="fel-rbg-state-preserve">
            <title>The TSF shall save the state of the deterministic RBG at power-off, and shall use
              this state as input to the deterministic RBG at startup.</title>
            <note role="application">The capability to add the state saved at power-off as input to
              the RBG prevents an RBG that is slow to gather entropy from producing the same output
              regularly and across reboots. Since there is no guarantee of the protections provided
              when the state is stored (or a requirement for any such protection), it is assumed
              that the state is 'known', and therefore cannot contribute entropy to the RBG, but can
              introduce enough variation that the initial RBG values are not predictable and
              exploitable.</note>
            <aactivity>
              <TSS>
                The evaluation activity for this requirement is captured in the RBG documentation
                for
                <xref to="entropy"/>. The evaluator shall verify that the documentation
                describes how the state is generated so as to be available for the next startup, how
                the state is used as input to the DRBG, and any protection measures used for the
                state while the TOE is powered off.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG_EXT.3 Support for Personalization String -->
        <f-component cc-id="fcs_rbg_ext.3" id="fcs-rbg-ext-3" name="Support for Personalization String" status="objective">
          <comp-lev> requires the TSF to support a personalization string as a DRBG input parameter.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_RBG.1 Random Bit Generation</dependencies>
          <f-element id="fel-rbg-person-string">
            <title>The TSF shall allow applications to add data to the deterministic RBG using the
              Personalization String as defined in SP 800-90A.</title>
            <note role="application">As specified in SP 800-90A, the TSF must not count data input
              from an application towards the entropy required by FCS_RBG.1. Thus, the TSF must
              not allow the only input to the RBG seed to be from an application.</note>
            <aactivity>
              The evaluator shall verify that this function is included as an interface to
              the RBG in the documentation required by
              <xref to="entropy"/>
              and that the
              behavior of the RBG following a call to this interface is described. The evaluator
              shall also verify that the documentation of the RBG describes the conditions of use
              and possible values for the Personalization String input to the SP 800-90A specified
              DRBG.
              <h:br/>
              <h:br/>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall write, or the developer shall provide, an application that adds data to the RBG via the Personalization String. The evaluator shall verify that the request succeeds.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_SRV_EXT.1 Cryptographic Algorithm Services -->
        <f-component cc-id="fcs_srv_ext.1" id="fcs-srv-ext-1" name="Cryptographic Algorithm Services">
          <comp-lev> requires the TSF to have externally-accessible cryptographic services for making algorithm functions available to applications. </comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FCS_CKM.1 Cryptographic Key Generation
            <h:br/>
            FCS_COP.1 Cryptographic Operation
          </dependencies>
          <f-element id="fel-crypt-service">
            <title>
              The TSF shall provide a mechanism for applications to request the TSF to perform
              the following cryptographic operations: [<h:i>
                <h:ul>
                  <h:li>All mandatory and  <selectables><selectable id="fcs_srv_ext.1.1_1">selected algorithms</selectable><selectable id="fcs_srv_ext.1.1_2">selected algorithms with the exception of ECC over curve 25519-based algorithms</selectable></selectables>  in FCS_CKM_EXT.7/LOCKED</h:li>
                  <h:li>The following algorithms in FCS_COP.1/ENCRYPT: AES-CBC,  <selectables><selectable id="fcs_srv_ext.1.1_3">AES Key Wrap</selectable><selectable id="fcs_srv_ext.1.1_4">AES Key Wrap with Padding</selectable><selectable id="fcs_srv_ext.1.1_5">AES-GCM</selectable><selectable id="fcs_srv_ext.1.1_6">AES-CCM</selectable><selectable id="fcs_srv_ext.1.1_7" exclusive="yes">no other modes</selectable></selectables></h:li>
                  <h:li>All selected algorithms in FCS_COP.1/SIGN</h:li>
                  <h:li>All mandatory and selected algorithms in FCS_COP.1/Hash</h:li>
                  <h:li>All mandatory and selected algorithms in FCS_COP.1/KeyedHash</h:li>
                  <h:li>
                    <selectables linebreak="yes">
                      <selectable id="fcs_srv_ext.1.1_8">All mandatory and <selectables><selectable id="fcs_srv_ext.1.1_9">selected algorithms</selectable><selectable id="fcs_srv_ext.1.1_10">selected algorithms with the exception of ECC over curve 25519-based algorithms</selectable></selectables> in FCS_CKM.1/AKG or FCS_CKM.1/SKG</selectable>
                      <selectable id="fcs_srv_ext.1.1_11">The selected algorithms in FCS_CKM_EXT.8</selectable>
                      <selectable id="fcs_srv_ext.1.1_12" exclusive="yes">No other cryptographic operations</selectable>
                    </selectables></h:li>
                </h:ul>
              </h:i>].
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall provide a mechanism for applications to request the TSF to perform
                the following cryptographic operations:
                <assignable>cryptographic operations defined by the TSF in FCS_CKM.1 or FCS_COP.1</assignable>
              </title>
            </ext-comp-def-title>
            <note role="application">
              For each of the listed FCS components in the bulleted list, the intent is that the TOE will make available all algorithms specified for that component in the ST.
              <h:br/>
              <h:br/>
              The exception is for FCS_COP.1/ENCRYPT. The TOE is not required to make available AES_CCMP, AES_XTS, AES_GCMP-256, or AES_CCMP_256 even though they may be implemented to perform TSF-related functions. It is acceptable for the platform to not provide AES Key Wrap (KW) and AES Key Wrap with Padding (KWP) to applications even if selected in FCS_COP.1/ENCRYPT.  However, the ST author is expected to select AES-GCM or AES-CCM if it is selected in the ST for the FCS_COP.1/ENCRYPT component.
            </note>
            <aactivity>
              The evaluator shall verify that the API documentation provided according to
              <xref to="adv"/>
              includes the security functions (cryptographic algorithms)
              described in these requirements.
              <h:br/>
              <h:br/>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>The evaluator shall write, or the developer shall provide access to, an application that requests cryptographic operations by the TSF. The evaluator shall verify that the results from the operation match the expected results according to the API documentation. This application may be used to assist in verifying the cryptographic operation Evaluation Activities for the other algorithm services requirements.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_SRV_EXT.2 Cryptographic Key Storage Services -->
        <f-component cc-id="fcs_srv_ext.2" id="fcs-srv-ext-2" name="Cryptographic Key Storage Services" status="objective">
          <comp-lev> requires the TSF to support its stored keys being usable by external applications through cryptographic algorithm services. </comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_COP.1 Cryptographic Operation</dependencies>
          <f-element id="fel-crypt-service-extra">
            <title>
              The TSF shall provide a mechanism for applications to request the TSF to perform
              the following cryptographic operations: [<h:i>
                <h:ul>
                  <h:li>Algorithms in FCS_COP.1/ENCRYPT</h:li>
                  <h:li>Algorithms in FCS_COP.1/SIGN</h:li>
                </h:ul>
              </h:i>]
              <h:b>by keys stored in the secure key storage.</h:b>
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall provide a mechanism for applications to request the TSF to perform
                the following cryptographic operations:
                <assignable>cryptographic operations defined by the TSF in FCS_COP.1</assignable>
                by keys stored in the secure key storage.
              </title>
            </ext-comp-def-title>
            <note role="application">The TOE will, therefore, be required to perform cryptographic
              operations on behalf of applications using the keys stored in the TOE’s secure key
              storage.</note>
            <aactivity>
              The evaluator shall verify that the API documentation for the secure key
              storage includes the cryptographic operations by the stored keys.
              <h:br/>
              <h:br/>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>The evaluator shall write, or the developer shall provide access to, an application that requests cryptographic operations of stored keys by the TSF. The evaluator shall verify that the results from the operation match the expected results according to the API documentation. The evaluator shall use these APIs to test the functionality of the secure key storage according to the Evaluation Activities in FCS_STG_EXT.1.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_STG_EXT.1 Cryptographic Key Storage -->
        <f-component cc-id="fcs_stg_ext.1" id="fcs-stg-ext-1" name="Cryptographic Key Storage">
          <comp-lev> requires the TSF to implement a secure key storage and defines the access restrictions to be enforced on this. </comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Importing keys or secrets into the secure key storage.</h:li>
              <h:li>Destroying imported keys or secrets in the secure key storage.</h:li>
              <h:li>Approving exceptions for shared use of keys or secrets by multiple applications.</h:li>
              <h:li>Approving exceptions for destruction of keys or secrets by applications that did not import the key or secret</h:li>
            </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Import or destruction of key.</h:li>
              <h:li>Exceptions to use and destruction rules.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            [FCS_CKM.1 Cryptographic Key Generation, or
            <h:br/>
            FDP_ITC.1 Import of User Data without Security Attributes, or
            <h:br/>
            FDP_ITC.2 Import of User Data with Security Attributes]
            <h:br/>
            FMT_SMF.1 Specification of Management Functions
            <h:br/>
            FMT_SMR.1 Security Roles
          </dependencies>
          <f-element id="fel-key-store">
            <title>The TSF shall provide  <selectables><selectable id="fcs_stg_ext.1.1_1">mutable hardware</selectable><selectable id="s-software-store">software-based</selectable></selectables>  secure key storage for asymmetric private keys and  <selectables><selectable id="fcs_stg_ext.1.1_2">symmetric keys</selectable><selectable id="fcs_stg_ext.1.1_3">persistent secrets</selectable><selectable id="fcs_stg_ext.1.1_4" exclusive="yes">no other keys</selectable></selectables>.</title>
            <ext-comp-def-title>
              <title>
                The TSF shall provide
                <assignable>storage medium</assignable>
                secure key storage for asymmetric private keys and
                <assignable>list of secrets</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              A hardware keystore can be exposed to the TSF through a variety
                of interfaces, including embedded on the motherboard, USB, microSD, and Bluetooth.
              <h:br/>
              <h:br/>
              Immutable hardware is considered outside of this requirement and
                will be covered elsewhere.
              <h:br/>
              <h:br/>
              If the secure key storage is implemented
                in software that is protected as required by FCS_STG_EXT.2, the ST author must select
              <xref to="s-software-store"/>.
		If
              <xref to="s-software-store"/>
              is selected,
		the ST author must select
              <xref to="s-all-software-key-store"/>
              in FCS_STG_EXT.2.1.
              <rule id="r-store">
                <if>
                  <ref-id>s-software-store</ref-id>
                </if>
                <then>
                  <ref-id>s-all-software-key-store</ref-id>
                </then>
              </rule>
              <h:br/>
              <h:br/>
              Support for secure
                key storage for all symmetric keys and persistent secrets will be required in future
                revisions.
            </note>
          </f-element>
          <f-element id="fel-key-import">
            <title>
              The TSF shall be capable of importing keys or secrets into the secure key storage
                upon request of
              <selectables>
                <selectable id="import-user">the user</selectable>
                <selectable id="s-import-admin">the administrator</selectable>
              </selectables>
              and
              <selectables>
                <selectable id="fcs_stg_ext.1.2_1">applications running on the TSF</selectable>
                <selectable id="fcs_stg_ext.1.2_2" exclusive="yes">no other subjects</selectable>
              </selectables>.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall be capable of importing keys or secrets into the secure key storage
                upon request of
                <assignable>list of users</assignable>
                and
                <assignable>list of other subjects</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application"> If the ST selects only <xref to="import-user"/>, the ST author must select function <xref to="mf-keyStorage"/> in FMT_MOF_EXT.1.1. </note>
          </f-element>
          <f-element id="fel-keystore-kill">
            <title>
              The TSF shall be capable of destroying keys or secrets in the secure key storage
                upon request of
              <selectables>
                <selectable id="fcs_stg_ext.1.3_1">the user</selectable>
                <selectable id="fcs_stg_ext.1.3_2">the administrator</selectable>
              </selectables>.
            </title>
            <note role="application">If the ST selects <xref to="import-user"/>, the ST author must select function <xref to="mf-keyWipe"/> in FMT_MOF_EXT.1.1. </note>
          </f-element>
          <f-element id="fel-keystore-who-access">
            <title>
              The TSF shall have the capability to allow only the application that imported the
                key or secret the use of the key or secret. Exceptions may only be explicitly authorized by
              <selectables>
                <selectable id="fcs_stg_ext.1.4_1">the user</selectable>
                <selectable id="fcs_stg_ext.1.4_2">the administrator</selectable>
                <selectable id="fcs_stg_ext.1.4_3">a common application developer</selectable>
              </selectables>.
            </title>
            <note role="application">
              If the ST selects
              <xref to="import-user"/>
              or
              <xref to="s-import-admin"/>,
				the ST author must also select
              <xref to="mf-sharedKeys"/>
              in FMT_SMF_EXT.1.1.
				If the ST selects
              <xref to="import-user"/>, the ST author must select function
              <xref to="mf-sharedKeys"/>
              in FMT_MOF_EXT.1.1.
            </note>
          </f-element>
          <f-element id="fel-keystore-who-kill">
            <title>
              The TSF shall allow only the application that imported the key or secret to request
                that the key or secret be destroyed. Exceptions may only be explicitly authorized by
              <selectables>
                <selectable id="s-killkey-user">the user</selectable>
                <selectable id="s-killkey-admin">the administrator</selectable>
                <selectable id="fcs_stg_ext.1.5_1">a common application developer</selectable>
              </selectables>.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall allow only the application that imported the key or secret to request
                that the key or secret be destroyed. Exceptions may only be explicitly authorized by
                <assignable>list of subjects</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              If the ST selects
              <xref to="s-killkey-user"/>
              or
              <xref to="s-killkey-admin"/>,
				the ST author must also select function
              <xref to="mf-keyWipeRules"/>
              in FMT_SMF_EXT.1.1.
				If the ST selects only
              <xref to="s-killkey-user"/>, 
				the ST author must select function
              <xref to="mf-keyWipeRules"/>
              in FMT_MOF_EXT.1.1.
            </note>
            <aactivity>
              The evaluator shall verify that the API documentation provided according to
              <xref to="adv"/>
              includes the security functions (import, use, and
                destruction) described in these requirements. The API documentation shall include the
                method by which applications restrict access to their keys or secrets in order to meet
                FCS_STG_EXT.1.4.
              <h:br/>
              <h:br/>
              <TSS>
                The evaluator shall review the TSS to determine that the TOE implements the
                  required secure key storage. The evaluator shall ensure that the TSS contains a
                  description of the key storage mechanism that justifies the selection of "mutable
                  hardware" or "software-based".
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall review the AGD guidance to determine that it describes
                  the steps needed to import or destroy keys or secrets.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                The evaluator shall test the functionality of each security function:
                <testlist>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall import keys or secrets of each supported type according to the AGD guidance. The evaluator shall write, or the developer shall provide access to, an application that generates a key or secret of each supported type and calls the import functions. The evaluator shall verify that no errors occur during import.</test>
                  <test>The evaluator shall write, or the developer shall provide access to, an application that uses an imported key or secret: <h:br/>  <h:ul><h:li>For RSA, the secret shall be used to sign data.</h:li> <h:li>For ECDSA, the secret shall be used to sign data.</h:li></h:ul>  <h:br/> In the future additional types will be required to be tested: <h:br/>  <h:ul><h:li>For symmetric algorithms, the secret shall be used to encrypt
                        data.</h:li> <h:li>For persistent secrets, the secret shall be compared to the imported
                        secret. </h:li></h:ul>  <h:br/> The evaluator shall repeat this test with the application-imported keys or secrets and a different application’s imported keys or secrets. The evaluator shall verify that the TOE requires approval before allowing the application to use the key or secret imported by the user or by a different application: <h:br/>  <h:ul><h:li>The evaluator shall deny the approvals to verify that the application
                        is not able to use the key or secret as described. </h:li> <h:li>The evaluator shall repeat the test, allowing the approvals to verify
                        that the application is able to use the key or secret as described.</h:li></h:ul>  <h:br/> If the ST author has selected "common application developer", this test is performed by either using applications from different developers or appropriately (according to API documentation) not authorizing sharing.</test>
                  <test>The evaluator shall destroy keys or secrets of each supported type according to the AGD guidance. The evaluator shall write, or the developer shall provide access to, an application that destroys an imported key or secret. <h:br/>  <h:br/> The evaluator shall repeat this test with the application-imported keys or secrets and a different application’s imported keys or secrets. The evaluator shall verify that the TOE requires approval before allowing the application to destroy the key or secret imported by the administrator or by a different application: <h:br/>  <h:br/>  <h:ul><h:li>The evaluator shall deny the approvals and verify that the application
                        is still able to use the key or secret as described. </h:li> <h:li>The evaluator shall repeat the test, allowing the approvals and
                        verifying that the application is no longer able to use the key or secret as
                        described.</h:li></h:ul>  <h:br/> If the ST author has selected "common application developer", this test is performed by either using applications from different developers or appropriately (according to API documentation) not authorizing sharing.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Import or destruction of key</audit-event-descr>
            <audit-event-info>Identity of key, role and identity of requester</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>
              <selectables onlyone="yes">
                <selectable>Exceptions to use and destruction rules</selectable>
                <selectable>none</selectable>
              </selectables>
            </audit-event-descr>
            <audit-event-info>Identity of key, role and identity of requester</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FCS_STG_EXT.2 Encrypted Cryptographic Key Storage -->
        <f-component cc-id="fcs_stg_ext.2" id="fcs-stg-ext-2" name="Encrypted Cryptographic Key Storage">
          <comp-lev> requires the TSF to implement confidentiality measures to protect the key storage.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FCS_CKM_EXT.3 Cryptographic Key Generation
            <h:br/>
            FCS_COP.1 Cryptographic Operation
            <h:br/>
            FCS_STG_EXT.1 Cryptographic Key Storage
          </dependencies>
          <f-element id="fel-encrypt-key-what">
            <title>The TSF shall encrypt all DEKs, KEKs,  <assignable>any long-term trusted channel key material</assignable>  and  <selectables><selectable id="s-all-software-key-store">all software-based key storage</selectable><selectable id="fcs_stg_ext.2.1_2" exclusive="yes">no other keys</selectable></selectables>  by KEKs that are  <selectables linebreak="yes"><selectable id="fcs_stg_ext.2.1_3">Protected by the REK with <selectables linebreak="yes"><selectable id="fcs_stg_ext.2.1_4">encryption by a REK</selectable><selectable id="fcs_stg_ext.2.1_5">encryption by a KEK chaining from a REK</selectable><selectable id="fcs_stg_ext.2.1_6">encryption by a KEK that is derived from a REK</selectable></selectables> </selectable><selectable id="fcs_stg_ext.2.1_7">Protected by the REK and the password with <selectables linebreak="yes"><selectable id="fcs_stg_ext.2.1_8">encryption by a REK and the password-derived KEK</selectable><selectable id="fcs_stg_ext.2.1_9">encryption by a KEK chaining to a REK and the password-derived or biometric-unlocked KEK</selectable><selectable id="fcs_stg_ext.2.1_10">encryption by a KEK that is derived from a REK and the password-derived or biometric-unlocked KEK</selectable></selectables> </selectable></selectables>.</title>
            <ext-comp-def-title>
              <title>
                The TSF shall encrypt all DEKs, KEKs,
                <assignable>any long-term trusted channel
                key material</assignable>
                and
                <assignable>other secrets</assignable>
                by KEKs that are
                <assignable>protection mechanism</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              The ST author must select
              <xref to="s-all-software-key-store"/>
              if
              <xref to="s-software-store"/>
              is selected in FCS_STG_EXT.1.1.
		If the ST author selects
              <xref to="mutable_hardware"/>
              in FCS_STG_EXT.1.1,
		the secure key storage is not subject to this requirement.
		REKs are not subject to this requirement.
              <h:br/>
              <h:br/>
              A REK and
                the password-derived KEK may be combined to form a combined KEK (as described in
                FCS_CKM_EXT.3) in order to meet this requirement.
              <h:br/>
              <h:br/>
              Software-based key storage must be protected by the password or biometric and
                REK.
              <h:br/>
              <h:br/>
              All keys must ultimately be protected by a REK.  In particular,
              <xref to="Keys"/>
              has KEKs protected according to these requirements: DEK_1 meets the
                "encryption by a REK and the password-derived KEK" case
                and would be appropriate for sensitive data, DEK_2 meets the "encryption by a KEK chaining from a REK" case and would not be
                appropriate for sensitive data, K_1 meets the "encryption by a REK" case and is not considered a sensitive key,
                and K_2 meets the "encryption by a KEK chaining to a REK and the password-derived or biometric-unlocked KEK" case and is considered a sensitive key.
              <h:br/>
              <h:br/>
              Long-term
                trusted channel key material includes Wi-Fi (PSKs), IPsec (PSKs and client
                certificates) and Bluetooth keys. These keys must not be protected by the password,
                as they may be necessary in the locked state. For clarity, the ST author must assign
                any Long-term trusted channel key material supported by the TOE. At a minimum, a TOE
                must support at least Wi-Fi and Bluetooth keys.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall review the TSS to determine that the TSS includes key
                  hierarchy description of the protection of each DEK for data-at-rest, of
                  software-based key storage, of long-term trusted channel keys, and of KEK related to
                  the protection of the DEKs, long-term trusted channel keys, and software-based key
                  storage. This description must include a diagram illustrating the key hierarchy
                  implemented by the TOE in order to demonstrate that the implementation meets
                  FCS_STG_EXT.2. The description shall indicate how the functionality described by
                  FCS_RBG.1 is invoked to generate DEKs (FCS_CKM_EXT.2), the key size
                  (FCS_CKM_EXT.2 and FCS_CKM_EXT.3) for each key, how each KEK is formed (generated,
                  derived, or combined according to FCS_CKM_EXT.3), the integrity protection method
                  for each encrypted key (FCS_STG_EXT.3), and the IV generation for each key encrypted
                  by the same KEK (FCS_IV_EXT.1). More detail for each task follows the corresponding
                  requirement.
                <h:br/>
                <h:br/>
                The evaluator shall also ensure that the documentation of the product's encryption key
                  management is detailed enough that, after reading, the product's key management hierarchy is clear 
                  and that it meets the requirements to ensure the keys are adequately protected. The evaluator shall ensure
                  that the documentation includes both an essay and one or more diagrams. Note that this may also be documented as 
                  separate proprietary evidence rather than being included in the TSS.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <f-element id="fel-encrypt-key-how">
            <title>
              DEKs, KEKs,
              <assignable>any long-term trusted channel key material</assignable>
              and
              <selectables>
                <selectable id="fcs_stg_ext.2.2_2">all software-based key storage</selectable>
                <selectable id="fcs_stg_ext.2.2_3" exclusive="yes">no other keys</selectable>
              </selectables>
              shall be encrypted using one of the following methods:
              <selectables>
                <selectable id="fcs_stg_ext.2.2_4">using a SP800-56B key establishment scheme</selectable>
                <selectable id="fcs_stg_ext.2.2_5">using AES in the <selectables><selectable id="fcs_stg_ext.2.2_6">Key Wrap (KW) mode</selectable><selectable id="fcs_stg_ext.2.2_7">Key Wrap with Padding (KWP) mode</selectable><selectable id="fcs_stg_ext.2.2_8">GCM</selectable><selectable id="fcs_stg_ext.2.2_9">CCM</selectable><selectable id="fcs_stg_ext.2.2_10">CBC mode</selectable></selectables></selectable>
              </selectables>.
            </title>
            <note role="application">The ST author selects which key encryption schemes are used by
                the TOE. This requirement refers only to KEKs as defined this PP and does not refer to
                those KEKs specified in other standards. The ST author must assign the same Long-term
                trusted channel key material assigned in FCS_STG_EXT.2.1.</note>
            <aactivity>
              <TSS>
                The evaluator shall examine the key hierarchy description in the TSS section to
                  verify that each DEK and software-stored key is encrypted according to
                  FCS_STG_EXT.2.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_STG_EXT.3 Integrity of Encrypted Key Storage -->
        <f-component cc-id="fcs_stg_ext.3" id="fcs-stg-ext-3" name="Integrity of Encrypted Key Storage">
          <comp-lev> requires the TSF to implement integrity measures to protect the key storage.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Failure to verify the integrity of stored key.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            FCS_COP.1 Cryptographic Operation
            <h:br/>
            FCS_STG_EXT.2 Encrypted Cryptographic Key Storage
          </dependencies>
          <f-element id="fel-protect-key-what">
            <title>The TSF shall protect the integrity of any encrypted DEKs and KEKs and  <selectables><selectable id="fcs_stg_ext.3.1_1">long-term trusted channel key material</selectable><selectable id="fcs_stg_ext.3.1_2">all software-based key storage</selectable><selectable id="fcs_stg_ext.3.1_3" exclusive="yes">no other keys</selectable></selectables>  by  <selectables linebreak="yes"><selectable id="fcs_stg_ext.3.1_4"> <selectables><selectable id="fcs_stg_ext.3.1_5">GCM</selectable><selectable id="fcs_stg_ext.3.1_6">CCM</selectable><selectable id="fcs_stg_ext.3.1_7">Key Wrap</selectable><selectable id="fcs_stg_ext.3.1_8">Key Wrap with Padding</selectable></selectables> cipher mode for encryption according to FCS_STG_EXT.2</selectable><selectable id="fcs_stg_ext.3.1_9">a hash (FCS_COP.1<h:b>/Hash</h:b>) of the stored key that is encrypted by a key protected by FCS_STG_EXT.2</selectable><selectable id="fcs_stg_ext.3.1_10">a keyed hash (FCS_COP.1<h:b>/KeyedHash</h:b>) using a key protected by a key protected by FCS_STG_EXT.2</selectable><selectable id="fcs_stg_ext.3.1_11">a digital signature of the stored key using an asymmetric key protected according to FCS_STG_EXT.2</selectable><selectable id="fcs_stg_ext.3.1_12">an immediate application of the key for decrypting the protected data followed by a successful verification of the decrypted data with previously known information</selectable></selectables>. </title>
            <ext-comp-def-title>
              <title>The TSF shall protect the integrity of any encrypted DEKs and KEKs and <selectables><selectable>long-term trusted channel key material</selectable><selectable>all software-based key storage</selectable><selectable exclusive="yes">no other keys</selectable></selectables> by <selectables linebreak="yes"><selectable><selectables><selectable>GCM</selectable><selectable>CCM</selectable><selectable>Key Wrap</selectable><selectable>Key Wrap with Padding</selectable></selectables> cipher mode for encryption according to FCS_STG_EXT.2</selectable><selectable>a hash (FCS_COP.1) of the stored key that is encrypted by a key
                    protected by FCS_STG_EXT.2</selectable><selectable>a keyed hash (FCS_COP.1) using a key protected by a key
                    protected by FCS_STG_EXT.2</selectable><selectable>a digital signature of the stored key using an asymmetric key protected
                    according to FCS_STG_EXT.2</selectable><selectable>an immediate application of the key for decrypting the protected data
                    followed by a successful verification of the decrypted data with previously known
                    information</selectable></selectables>. </title>
            </ext-comp-def-title>
            <note role="application">The ST author must assign the same Long-term trusted channel
                key material assigned in FCS_STG_EXT.2.1.</note>
          </f-element>
          <f-element id="fel-integrity-key-how">
            <title>The TSF shall verify the integrity of the  <selectables><selectable id="fcs_stg_ext.3.2_1">hash</selectable><selectable id="fcs_stg_ext.3.2_2">digital signature</selectable><selectable id="fcs_stg_ext.3.2_3">MAC</selectable></selectables>  of the stored key prior to use of the key. </title>
            <note role="application">
              This requirement is not applicable to derived keys that are not
                stored. It is not expected that a single key will be protected from corruption by
                multiple of these methods; however, a product may use one integrity-protection method
                for one type of key and a different method for other types of keys. The explicit
                Evaluation Activities for each of the options will be addressed in each of the
                requirements (FCS_COP.1.1/Hash, FCS_COP.1.1/KeyedHash).
              <h:br/>
              <h:br/>
              Key Wrapping
                must be implemented per SP800-38F.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the key hierarchy description in the TSS section to
                  verify that each encrypted key is integrity protected according to one of the
                  options in FCS_STG_EXT.3.
                <h:br/>
                <h:br/>
                The evaluator shall also ensure that the documentation of the product's encryption key
                  management is detailed enough that, after reading, the product's key management hierarchy is clear 
                  and that it meets the requirements to ensure the keys are adequately protected. The evaluator shall ensure
                  that the documentation includes both an essay and one or more diagrams. Note that this may also be documented as 
                  separate proprietary evidence rather than being included in the TSS.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Failure to verify integrity of stored key</audit-event-descr>
            <audit-event-info>Identity of key being verified</audit-event-info>
          </audit-event>
        </f-component>
      </section>
      <!-- 5.1.3 Class: User Data Protection (FDP) -->
      <section id="fdp" title="Class: User Data Protection (FDP)">
        <h:p>
          A subset of the User Data Protection focuses on protecting Data-At-Rest, namely FDP_DAR_EXT.1 and FDP_DAR_EXT.2.
            Three levels of data-at-rest protection are addressed: TSF data, Protected Data (and keys), and sensitive data.
          <xref to="datalevels"/>
          addresses the level of protection required for each level of data-at-rest.
        </h:p>
        <h:b>
          <ctr id="datalevels" ctr-type="Table">: Protection of Data Levels</ctr>
        </h:b>
        <h:br/>
        <h:br/>
        <h:table>
          <h:tr class="header">
            <h:td>Data Level</h:td>
            <h:td>Protection Required</h:td>
          </h:tr>
          <h:tr>
            <h:td>TSF Data</h:td>
            <h:td>TSF data does not require confidentiality, but does require integrity protection. (FPT_TST_EXT.2/PREKERNEL)</h:td>
          </h:tr>
          <h:tr>
            <h:td>Protected Data</h:td>
            <h:td>Protected data is encrypted while powered off. (FDP_DAR_EXT.1)</h:td>
          </h:tr>
          <h:tr>
            <h:td>Sensitive Data</h:td>
            <h:td>Sensitive data is encrypted while in the locked state, in addition to while powered off. (FDP_DAR_EXT.2)</h:td>
          </h:tr>
        </h:table>
        <h:br/>
        All keys, protected data, and sensitive data must ultimately be protected by the REK. Sensitive data must be protected by the password in addition to the REK. In particular,
        <xref to="Keys"/>
        has KEKs protected according to these requirements: DEK_1 would be appropriate for sensitive data, DEK_2 would not be appropriate for sensitive data, K_1 is not considered a sensitive key, and K_2 is considered a sensitive key.
        <h:br/>
        <h:br/>
        These requirements include a capability for encrypting sensitive data received while in the locked state, which may be considered a separate sub-category of sensitive data. This capability may be met by a key transport scheme (RSA) by using a public key to encrypt the DEK while protecting the corresponding private key with a password-derived or biometric-unlocked KEK.
        <h:br/>
        <h:br/>
        This capability may also be met by a key agreement scheme. To do so, the device generates a device-wide sensitive data asymmetric pair (the private key of which is protected by a password-derived or biometric-unlocked KEK) and an asymmetric pair for the received sensitive data to be stored. In order to store the sensitive data, the device-wide public key and data private key are used to generate a shared secret, which can be used as a KEK or a DEK. The data private key and shared secret are cleared after the data is encrypted and the data public key stored. Thus, no key material is available in the locked state to decrypt the newly stored data. Upon unlock, the device-wide private key is decrypted and is used with each data public key to regenerate the shared secret and decrypt the stored data.
        <xref to="KeysLocked"/>, below, illustrates this scheme.
        <h:br/>
        <h:br/>
        <figure id="KeysLocked" entity="images/figure4.jpg" title="Key Agreement Scheme for Encrypting Received Sensitive Data in the Locked State"/>
        <h:br/>
        <h:br/>
        <ext-comp-def title="Access Control Functions" fam-id="FDP_ACF_EXT">
          <fam-behavior>This family defines the rules for access control functions that are not addressed by the FDP_ACF family in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Application Backup" fam-id="FDP_BCK_EXT">
          <fam-behavior>This family defines requirements for managing device backups.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Limitation of Bluetooth Device Access" fam-id="FDP_BLT_EXT">
          <fam-behavior>This family defines requirements for managing Bluetooth devices.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Data-at-Rest Encryption" fam-id="FDP_DAR_EXT">
          <fam-behavior>This family defines requirements for implementation of data-at-rest protection.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Subset Information Flow Control" fam-id="FDP_IFC_EXT">
          <fam-behavior>This family defines requirements for handling of information flows that are not addressed by FDP_IFC in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="User Data Storage" fam-id="FDP_STG_EXT">
          <fam-behavior>This family defines requirements for managing data storage.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Inter-TSF User Data Transfer Protection" fam-id="FDP_UPC_EXT">
          <fam-behavior>This family defines requirements for the use of trusted channel protocols to protect user data.</fam-behavior>
        </ext-comp-def>
        <!-- FDP_ACF_EXT.1 Access Control for System Services -->
        <f-component cc-id="fdp_acf_ext.1" id="fdp-acf-ext-1" name="Access Control for System Services">
          <comp-lev> requires the TSF to be able to control access to its own services.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Placing applications into application groups based on enterprise configuration settings.</h:li>
              <h:li>Enabling/disabling location services.</h:li>
              <h:li>Enabling/disabling data signaling over externally-accessible hardware ports.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FMT_SMR.1 Security Roles</dependencies>
          <f-element id="fel-restrict-sys-service">
            <title>The TSF shall provide a mechanism to restrict the system services that are
              accessible to an application.</title>
            <note role="application">
              Examples of system services to which this requirement applies
              include:
              <h:br/>
              <h:br/>
              <h:ul>
                <h:li>Obtain data from camera and microphone input devices</h:li>
                <h:li>Obtain current device location</h:li>
                <h:li>Retrieve credentials from system-wide credential store</h:li>
                <h:li>Retrieve contacts list / address book</h:li>
                <h:li>Retrieve stored pictures</h:li>
                <h:li>Retrieve text messages</h:li>
                <h:li>Retrieve emails</h:li>
                <h:li>Retrieve device identifier information</h:li>
                <h:li>Obtain network access</h:li>
              </h:ul>
            </note>
            <aactivity level="element">
              <TSS>
                The evaluator shall ensure the TSS lists all system services available for use by
                an application. The evaluator shall also ensure that the TSS describes how
                applications interface with these system services, and means by which these system
                services are protected by the TSF.
                <h:br/>
                <h:br/>
                The TSS shall describe which
                of the following categories each system service falls in:
                <h:br/>
                <h:ol>
                  <h:li>No applications are allowed access</h:li>
                  <h:li>Privileged applications are allowed access</h:li>
                  <h:li>Applications are allowed access by user authorization</h:li>
                  <h:li>All applications are allowed access</h:li>
                </h:ol>
                Privileged applications include any applications developed by the TSF
                developer. The TSS shall describe how privileges are granted to third-party
                applications. For both types of privileged applications, the TSS shall describe how
                and when the privileges are verified and how the TSF prevents unprivileged
                applications from accessing those services.
                <h:br/>
                <h:br/>
                For any services for
                which the user may grant access, the evaluator shall ensure that the TSS identifies
                whether the user is prompted for authorization when the application is installed, or
                during runtime. The evaluator shall ensure that the operational user guidance
                contains instructions for restricting application access to system services.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following tests require the vendor to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <h:br/>
                <h:br/>
                The evaluator shall write, or the developer shall provide, applications for the purposes of the following tests.
                <h:br/>
                <h:br/>
                <testlist>
                  <test>For each system service to which no applications are allowed access, the evaluator shall attempt to access the system service with a test application and verify that the application is not able to access that system service.</test>
                  <test>For each system service to which only privileged applications are allowed access, the evaluator shall attempt to access the system service with an unprivileged application and verify that the application is not able to access that system service. The evaluator shall attempt to access the system service with a privileged application and verify that the application can access the service.</test>
                  <test>For each system service to which the user may grant access, the evaluator shall attempt to access the system service with a test application. The evaluator shall ensure that either the system blocks such accesses or prompts for user authorization. The prompt for user authorization may occur at runtime or at installation time, and should be consistent with the behavior described in the TSS.</test>
                  <test>For each system service listed in the TSS that is accessible by all applications, the evaluator shall test that an application can access that system service.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-acp">
            <title>The TSF shall provide an access control policy that prevents  <selectables><selectable id="s-fdp-app">application</selectable><selectable id="fdp_group">groups of applications</selectable></selectables>  from accessing  <selectables><selectable id="fdp_acf_ext.1.2_1">all</selectable><selectable id="s-private">private</selectable></selectables>  data stored by other  <selectables><selectable id="fdp_acf_ext.1.2_2">application</selectable><selectable id="fdp_acf_ext.1.2_3">groups of applications</selectable></selectables>. Exceptions may only be explicitly authorized for such sharing by  <selectables><selectable id="s-acl-user">the user</selectable><selectable id="s-acl-admin">the administrator</selectable><selectable id="s-acl-devel">a common application developer</selectable><selectable id="fdp_acf_ext.1.2_4">no one</selectable></selectables>. </title>
            <ext-comp-def-title>
              <title>
                The TSF shall provide an access control policy that prevents
                <assignable>list of subjects</assignable>
                from accessing
                <selectables>
                  <selectable>all</selectable>
                  <selectable>private</selectable>
                </selectables>
                data stored by other
                <assignable>list of subjects</assignable>.
		Exceptions may only be explicitly authorized for such sharing by
                <assignable>list of authorized subjects</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              Application groups may be designated Enterprise or Personal.
              Applications installed by the user default to being in the Personal application group
              unless otherwise designated by the administrator in function
              <xref to="mf-appGroups"/>
              of FMT_SMF_EXT.1.1. Applications installed by the administrator
              default to being in the Enterprise application group (this category includes
              applications that the user requests the administrator install, for instance by
              selecting the application for installation through an enterprise application catalog)
              unless otherwise designated by the administrator in function
              <xref to="mf-appGroups"/>
              of FMT_SMF_EXT.1.1. It is acceptable for the same application to
              have multiple instances installed, each in different application groups. Private data
              is defined as data that is accessible only by the application that wrote it. Private
              data is distinguished from data that an application may, by design, write to shared
              storage areas.
              <h:br/>
              <h:br/>
              If
              <xref to="fdp_group"/>
              is selected, FDP_ACF_EXT.2 must be included in the ST.
            </note>
            <aactivity level="element">
              <TSS>
                The evaluator shall examine the TSS to verify that it describes which data
                sharing is permitted between applications, which data sharing is not permitted, and
                how disallowed sharing is prevented. It is possible to select both "applications" and
                "groups of applications", in which case the TSS is expected to describe the data
                sharing policies that would be applied in each case.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall write, or the developer shall provide, two applications, one that saves data containing a unique string, and the other, which attempts to access that data. If <xref to="fdp_group"/> is selected, the applications shall be placed into different groups. If <xref to="s-fdp-app"/> is selected, the evaluator shall install the two applications. If <xref to="s-private"/> is selected, the application shall not write to a designated shared storage area. The evaluator shall verify that the second application is unable to access the stored unique string. <h:br/>  <h:br/> If <xref to="s-acl-user"/> is selected, the evaluator shall grant access as the user and verify that the second application is able to access the stored unique string. <h:br/>  <h:br/> If <xref to="s-acl-admin"/> is selected, the evaluator shall grant access as the administrator and verify that the second application is able to access the stored unique string. <h:br/>  <h:br/> If <xref to="s-acl-devel"/> is selected, the evaluator shall grant access to an application with a common application developer to the first, and verify that the application is able to access the stored unique string.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FDP_ACF_EXT.2 Access Control for System Resources -->
        <f-component cc-id="fdp_acf_ext.2" id="fc_access_control_system" name="Access Control for System Resources" status="sel-based">
          <depends on-sel="fdp_group"/>
          <comp-lev> requires the TSF to be able to provide separate copies of system resources for different application groups.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Approving exceptions for sharing data between applications or groups of applications.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FDP_ACF_EXT.1 Access Control for System Services
            <h:br/>
            FMT_SMR.1 Security Roles
          </dependencies>
          <f-element id="fel-per-app-resources">
            <title>
              The TSF shall provide a separate
              <selectables>
                <selectable id="fdp_acf_ext.2.1_1">address book</selectable>
                <selectable id="fdp_acf_ext.2.1_2">calendar</selectable>
                <selectable id="fdp_acf_ext.2.1_3">keystore</selectable>
                <selectable id="fdp_acf_ext.2.1_4">account credential database, <assignable>list of additional resources</assignable></selectable>
              </selectables>
              for each application group and only allow applications within that
              process group to access the resource. Exceptions may only be explicitly authorized for
              such sharing by
              <selectables>
                <selectable id="fdp_acf_ext.2.1_6">the user</selectable>
                <selectable id="fdp_acf_ext.2.1_7">the administrator</selectable>
                <selectable id="fdp_acf_ext.2.1_8">no one</selectable>
              </selectables>.
            </title>
            <note role="application">
              If
              <xref to="fdp_group"/>
              is selected in FDP_ACF_EXT.1.2, 
              FDP_ACF_EXT.2 must be included in the ST.
            </note>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>For each selected resource, the evaluator shall cause data to be placed into the Enterprise group’s instance of that shared resource. The evaluator shall install an application into the Personal group that attempts to access the shared resource information and verify that it cannot access the information.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FDP_ACF_EXT.3 Security Attribute Based Access Control -->
        <f-component cc-id="fdp_acf_ext.3" id="fdp-acf-ext-3" name="Security Attribute Based Access Control" status="objective">
          <comp-lev> requires the TSF to enforce policies on applications that prohibit write and execute permissions from being granted simultaneously.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-no-write-exe">
            <title>
              The TSF shall enforce an access control policy that prohibits an application from
              granting both write and execute permission to a file on the device except for
              <selectables>
                <selectable id="fdp_acf_ext.3.1_1">files stored in the application's private data folder</selectable>
                <selectable id="fdp_acf_ext.3.1_2">no exceptions</selectable>
              </selectables>.
            </title>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following tests require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <h:br/>
                <h:br/>
                <testlist>
                  <test>The evaluator shall write, or the developer shall provide, an application that attempts to store a file with both write and execute permissions. If the selection is "no exceptions", then the evaluator shall verify that this action fails and that the permissions on the file are not simultaneously write and execute. If the selection is "application's private data folder", then the evaluator shall ensure that the attempt to store the file is outside of the application's private data folder.</test>
                  <test>The evaluator shall traverse the file system examining the permission on each TSF file to verify that no file has both write and execute permissions set. If the selection is "application's private data folder", then only files outside of this folder need to be examined by the evaluator for this test.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FDP_BCK_EXT.1 Application Backup -->
        <f-component cc-id="fdp_bck_ext.1" id="fdp-bck-ext-1" name="Application Backup" status="objective">
          <comp-lev> requires the TSF to be able to determine which data to include in backup operations.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Enable/disable backup of certain applications to a local or remote system.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-backup-mark">
            <title>The TSF shall provide a mechanism for applications to mark  <selectables><selectable id="s-all-app-data">all application data</selectable><selectable id="s-sel-app-data">selected application data</selectable></selectables>  to be excluded from device backups. </title>
            <ext-comp-def-title>
              <title>The TSF shall provide a mechanism for applications to mark <assignable>list of data categories</assignable> to be excluded from device backups. </title>
            </ext-comp-def-title>
            <note role="application">Device backups include any mechanism built into the TOE that
              allows stored application data to be extracted over a physical port or sent over the
              network, but does not include any functionality implemented by a specific application
              itself if the application is not included in the TOE. The lack of a public/documented
              API for performing backups, when a private/undocumented API exists, is not sufficient
              to meet this requirement.</note>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>If <xref to="s-all-app-data"/> is selected, the evaluator shall install an application that has marked all of its application data to be excluded from backups. The evaluator shall cause data to be placed into the application’s storage area. The evaluator shall attempt to back up the application data and verify that the backup fails or that the application’s data was not included in the backup. <h:br/> <h:br/>If <xref to="s-sel-app-data"/> is selected, the evaluator shall install an application that has marked selected application data to be excluded from backups. The evaluator shall cause data covered by "selected application data" to be placed into the application’s storage area. The evaluator shall attempt to backup that selected application data and verify that either the backup fails or that the selected data is excluded from the backup.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FDP_BLT_EXT.1 Limitation of Bluetooth Device Access -->
        <f-component cc-id="fdp_blt_ext.1" id="fdp-blt-ext-1" name="Limitation of Bluetooth Device Access" status="objective">
          <comp-lev> requires the TSF to manage which applications communicate with Bluetooth devices.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fdp-blt-ext-1e1">
            <title>The TSF shall limit the applications that may communicate with a particular paired Bluetooth device.</title>
            <note role="application">Not every application with privileges to use Bluetooth should be permitted to communicate with every paired Bluetooth device. For example, the TSF may choose to require that only the application that initiated the current connection may communicate with the device, or it may strictly tie the paired device to the first application that makes a socket connection to the device following initial pairing. Additionally, for more flexibility, the TSF may choose to provide the user with a way to select which applications on the device may communicate with or observe communications with each paired Bluetooth device.</note>
            <aactivity>
              <TSS>The evaluator shall ensure that the TSS describes the mechanism used to prevent unrestricted access to paired Bluetooth devices (or their communication data) by every application with access to the Bluetooth system service on the TOE. The evaluator shall verify that this method either restricts access to a single application or provides explicit control of the applications that may communicate with the paired Bluetooth device. <h:br/><h:br/></TSS>
              <Guidance>The evaluator shall verify that the AGD contains the steps to configure which applications are allowed to communicate with a given Bluetooth peripheral.<h:br/><h:br/></Guidance>
              <Tests>The evaluator shall establish a Bluetooth connection with any peripheral. The evaluator shall verify that an application that is allowed to communicate with the Bluetooth peripheral is able to and that an application that is not allowed to communicate with that Bluetooth peripheral is unable to communicate with the peripheral.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FDP_DAR_EXT.1 Protected Data Encryption -->
        <f-component cc-id="fdp_dar_ext.1" id="fdp-dar-ext-1" name="Protected Data Encryption">
          <comp-lev> requires the TSF to be able to protect all data with a chosen method of encryption.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Enabling data-at-rest protection.</h:li>
              <h:li>Enabling removable media’s data-at-rest protection.</h:li>
            </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Failure to encrypt/decrypt data.</h:li>
            </h:ul>
          </audit>
          <dependencies>FCS_COP.1 Cryptographic Operation</dependencies>
          <f-element id="fel-dar-what">
            <title>Encryption shall cover all protected data. </title>
            <note role="application">Protected data is all non-TSF data, including all user or
              enterprise data. Some or all of this data may be considered sensitive data as
              well.</note>
          </f-element>
          <f-element id="fel-dar-how">
            <title>Encryption shall be performed using DEKs with AES in the  <selectables><selectable id="fel-dar-how-cbc">CBC</selectable><selectable id="fel-dar-how-gcm">GCM</selectable><selectable id="fel-dar-how-xts">XTS</selectable></selectables>  mode with key size [<h:i>256</h:i>] bits. </title>
            <ext-comp-def-title>
              <title>
                Encryption shall be performed using DEKs with AES in the
                <assignable>list of AES modes</assignable>
                mode with key size
                <assignable>list of acceptable key sizes</assignable>
                bits.
              </title>
            </ext-comp-def-title>
            <note role="application">IVs must be generated in accordance with
              FCS_IV_EXT.1.1.</note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS section of the ST indicates which data is
                protected by the DAR implementation and what data is considered TSF data. The
                evaluator shall ensure that this data includes all protected data.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall review the AGD guidance to determine that the
                description of the configuration and use of the DAR protection does not require the
                user to perform any actions beyond configuration and providing the authentication
                credential. The evaluator shall also review the AGD guidance to determine that the
                configuration does not require the user to identify encryption on a per-file basis.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following test requires the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <h:br/>
                <h:br/>
                <testlist>
                  <test>The evaluator shall enable encryption according to the AGD guidance. The evaluator shall create user data (non-system) either by creating a file or by using an application. The evaluator shall use a tool provided by the developer to verify that this data is encrypted when the product is powered off, in conjunction with Test 1 for FIA_UAU_EXT.1.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>
              <selectables onlyone="yes">
                <selectable>Failure to encrypt/decrypt data</selectable>
                <selectable>none</selectable>
              </selectables>
            </audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FDP_DAR_EXT.2 Sensitive Data Encryption -->
        <f-component cc-id="fdp_dar_ext.2" id="fdp-dar-ext-2" name="Sensitive Data Encryption">
          <comp-lev> requires the TSF to protect the Trust Anchor Database. </comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul><h:li>Importing X.509v3 certificates into the Trust Anchor Database.</h:li> <h:li>Removing imported X.509v3 certificates from the Trust Anchor Database.</h:li> <h:li>Approving import and removal by applications of X.509v3 certificates in the Trust Anchor Database.</h:li></h:ul></management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Addition or removal of certificate from Trust Anchor Database</h:li>
            </h:ul>
          </audit>
          <dependencies>
            FCS_COP.1 Cryptographic Operation
            <h:br/>
            FCS_CKM_EXT.7 Cryptographic Key Establishment
            <h:br/>
            FCS_STG_EXT.2 Encrypted Cryptographic Key Storage
          </dependencies>
          <f-element id="fel-dar-app-what">
            <title>The TSF shall provide a mechanism for applications to mark data and keys as
              sensitive.</title>
            <note role="application">
              Data and keys that have been marked as sensitive will be
              subject to certain restrictions (through other requirements) in both the locked and
              unlocked states of the Mobile Device. This mechanism allows an application to choose
              those data and keys under its control to be subject to those requirements.
              <h:br/>
              <h:br/>
              In the future, this PP may require that all data and key created by
              applications will default to the "sensitive" marking, requiring an explicit
              "non-sensitive" marking rather than an explicit "sensitive" marking.
            </note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS includes a description of which data
                stored by the TSF (such as by native applications) is treated as sensitive. This
                data may include all or some user or enterprise data and must be specific regarding
                the level of protection of email, contacts, calendar appointments, messages, and
                documents.
                <h:br/>
                <h:br/>
                The evaluator shall examine the TSS to determine that
                it describes the mechanism that is provided for applications to use to mark data and
                keys as sensitive. This description shall also contain information reflecting how
                data and keys marked in this manner are distinguished from data and keys that are
                not (for instance, tagging, segregation in a "special" area of memory or container,
                etc.).
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>The evaluator shall enable encryption of sensitive data and require user authentication according to the AGD guidance. The evaluator shall try to access and create sensitive data (as defined in the ST and either by creating a file or using an application to generate sensitive data) in order to verify that no other user interaction is required. <h:br/> <h:br/></Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-dar-lock">
            <title>The TSF shall use an asymmetric key scheme to encrypt and store sensitive data
              received while the product is locked.</title>
            <note role="application">
              Sensitive data is encrypted according to FDP_DAR_EXT.1.2. The
              asymmetric key scheme must be performed in accordance with FCS_CKM_EXT.7/LOCKED.
              <h:br/>
              <h:br/>
              The intent of this requirement is to allow the device to receive
              sensitive data while locked and to store the received data in such a way as to prevent
              unauthorized parties from decrypting it while in the locked state. If only a subset of
              sensitive data may be received in the locked state, this subset must be described in
              the TSS.
              <h:br/>
              <h:br/>
              Key material must be cleared when no longer needed
              according to FCS_CKM_EXT.6. For keys (or key material used to derive those keys)
              protecting sensitive data received in the locked state, "no longer needed" includes
              "while in the locked state." For example, in the first key scheme, this includes the
              DEK protecting the received data as soon as the data is encrypted. In the second key
              scheme this includes the private key for the data asymmetric pair, the generated
              shared secret, and any generated DEKs. Of course, both schemes require that a private
              key of an asymmetric pair (the RSA private key and the device-wide private key,
              respectively) be cleared when transitioning to the locked state.
            </note>
            <aactivity level="element">
              <TSS>
                The evaluator shall review the TSS section of the ST to determine that the TSS
                includes a description of the process of receiving sensitive data while the device
                is in a locked state. The evaluator shall also verify that the description indicates
                if sensitive data that may be received in the locked state is treated differently
                than sensitive data that cannot be received in the locked state. The description
                shall include the key scheme for encrypting and storing the received data, which
                must involve an asymmetric key and must prevent the sensitive data-at-rest from
                being decrypted by wiping all key material used to derive or encrypt the data (as
                described in the application note). The introduction to this section provides two
                different schemes that meet the requirements, but other solutions may address this
                requirement.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>The evaluator shall perform the tests in FCS_CKM.6 for all key material no longer needed while in the locked state and shall ensure that keys for the asymmetric scheme are addressed in the tests performed when transitioning to the locked state. <h:br/> <h:br/></Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-dar-symkey">
            <title>
              The TSF shall encrypt any stored symmetric key and any stored private key of the
              asymmetric keys used for the protection of sensitive data according to
              [<h:i>FCS_STG_EXT.2.1 selection 2</h:i>].
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall encrypt any stored symmetric key and any stored private key of the
                asymmetric keys used for the protection of sensitive data according to
                <assignable>mechanism for encrypted key storage</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">Symmetric keys used to encrypt sensitive data while the TSF is
              in the unlocked state must be encrypted with (or chain to a KEK encrypted with) the
              REK and password-derived or biometric-unlocked KEK. A stored private key of the
              asymmetric key scheme for encrypting data in the locked state must be encrypted with
              (or chain to a KEK encrypted with) the REK and password-derived or biometric-unlocked
              KEK.</note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the key hierarchy section of the TSS required for
                FCS_STG_EXT.2.1 includes the symmetric encryption keys (DEKs) used to encrypt
                sensitive data. The evaluator shall ensure that these DEKs are encrypted by a key
                encrypted with (or chain to a KEK encrypted with) the REK and password-derived or
                biometric-unlocked KEK.
                <h:br/>
                <h:br/>
                The evaluator shall verify that the TSS
                section of the ST that describes the asymmetric key scheme includes the protection
                of any private keys of the asymmetric pairs. The evaluator shall ensure that any
                private keys that are not wiped and are stored by the TSF are stored encrypted by a
                key encrypted with (or chain to a KEK encrypted with) the REK and password-derived
                or biometric-unlocked KEK.
                <h:br/>
                <h:br/>
                The evaluator shall also ensure that the documentation of the product's encryption key
                management is detailed enough that, after reading, the product's key management hierarchy is clear 
                and that it meets the requirements to ensure the keys are adequately protected. The evaluator shall ensure
                that the documentation includes both an essay and one or more diagrams. Note that this may also be documented as 
                separate proprietary evidence rather than being included in the TSS.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this element. <h:br/> <h:br/></Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-dar-unlock-data">
            <title>The TSF shall decrypt the sensitive data that was received while in the locked
              state upon transitioning to the unlocked state using the asymmetric key scheme and
              shall re-encrypt that sensitive data using the symmetric key scheme.</title>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS section of the ST that describes the
                asymmetric key scheme includes a description of the actions taken by the TSF for the
                purposes of DAR upon transitioning to the unlocked state. These actions shall
                minimally include decrypting all received data using the asymmetric key scheme and
                re-encrypting with the symmetric key scheme used to store data while the device is
                unlocked.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this element. <h:br/> <h:br/></Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>
              <selectables onlyone="yes">
                <selectable>Failure to encrypt/decrypt data</selectable>
                <selectable>none</selectable>
              </selectables>
            </audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FDP_IFC_EXT.1 Subset Information Flow Control -->
        <f-component cc-id="fdp_ifc_ext.1" id="fdp-ifc-ext-1" name="Subset Information Flow Control">
          <comp-lev> requires the TSF to be able to support the use of an IPsec VPN to protect data in transit.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Enabling/disabling VPN protection.</h:li>
              <h:li>Enabling/disabling Always On VPN protection.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FTP_ITC_EXT.1 Trusted Channel Communication</dependencies>
          <f-element id="fel-vpn-service">
            <title>
              The TSF shall
              <selectables linebreak="yes">
                <selectable id="fdp_ifc_ext.1.1_1">provide an interface which allows a VPN client to protect all IP traffic using IPsec</selectable>
                <selectable id="fdp_ifc_ext.1.1_2">provide a VPN client which can protect all IP traffic using IPsec <h:b>as defined in the <xref to="mod-vpnclient"/></h:b></selectable>
              </selectables>
              with the exception of IP traffic needed to manage the VPN
              connection, and
              <selectables>
                <selectable id="fdp_ifc_ext.1.1_4">
                  <assignable>traffic needed for correct functioning of the TOE</assignable>
                </selectable>
                <selectable id="fdp_ifc_ext.1.1_5">no other traffic</selectable>
              </selectables>, when the VPN is enabled.
            </title>
            <note role="application">
              Typically, the traffic needed to manage the VPN connection
              is referred to as "Control Plane" traffic; whereas, the IP traffic protected by the
              IPsec VPN is referred to as "Data Plane" traffic. All "Data Plane" traffic must flow
              through the VPN connection and the VPN must not split-tunnel. “IP traffic needed for correct functioning of the TOE” comprises traffic that would prevent the TOE from proper operation if it was either blocked by or routed through the VPN. Enabling the VPN means that the VPN client has been activated by the user. If the VPN tunnel gets interrupted, then no “Data Plane” traffic should be sent without the VPN tunnel being re-established or the user disabling the VPN client.
              <h:br/>
              <h:br/>
              If no native IPsec client is validated or third-party VPN clients may also implement the
              required Information Flow Control, the first option must be selected. In these cases,
              the TOE provides an API to third-party VPN clients that allow them to configure the
              TOE’s network stack to perform the required Information Flow Control.
              <h:br/>
              <h:br/>
              The ST author must select the second option if the TSF implements
              a native VPN client (<xref to="s-itc-ipsec"/>
              is selected in
              <xref to="fel-wlan"/>). Thus the TSF must be
              validated against the
              <xref to="mod-vpnclient"/>
              and the ST author must also include
              <no-link>FDP_IFC_EXT.1</no-link>
              from the
              <xref to="mod-vpnclient"/>.
              <h:br/>
              <h:br/>
              It is optional for
              the VPN client to be configured to be always-on per FMT_SMF_EXT.1 Function
              <xref to="mf-alwaysOnVPN"/>. Always-on means the establishment of an IPsec trusted channel
              to allow any communication by the TSF.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS section of the ST describes the routing
                of IP traffic through processes on the TSF when a VPN client is enabled. The
                evaluator shall ensure that the description indicates which traffic does not go
                through the VPN and which traffic does. The evaluator shall verify that a configuration exists for each
                baseband protocol in which only the traffic identified by the ST author as necessary
                for establishing the VPN connection (IKE traffic and perhaps HTTPS or DNS traffic) or needed for the correct functioning of the TOE is not encapsulated by the VPN protocol (IPsec). The evaluator shall verify that the
                TSS section describes any differences in the routing of IP traffic when using any
                supported baseband protocols (e.g. Wi-Fi or, LTE).
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall verify that one (or more) of the following options is
                addressed by the documentation:
                <h:br/>
                <h:ul>
                  <h:li>The description above indicates that if a VPN client is enabled, all
                    configurations route all Data Plane traffic through the tunnel interface
                    established by the VPN client.</h:li>
                  <h:li>The AGD guidance describes how the user or administrator can configure
                    the TSF to meet this requirement.</h:li>
                  <h:li>The API documentation includes a security function that allows a VPN
                    client to specify this routing.</h:li>
                </h:ul>
                <h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>If the ST author identifies any differences in the routing between Wi-Fi and cellular protocols, the evaluator shall repeat this test with a base station implementing one of the identified cellular protocols. <h:br/>  <h:br/> Step 1: The evaluator shall enable a Wi-Fi configuration as described in the AGD guidance (as required by FTP_ITC_EXT.1). The evaluator shall use a packet sniffing tool between the wireless access point and an Internet-connected network. The evaluator shall turn on the sniffing tool and perform actions with the device such as navigating to websites, using provided applications, and accessing other Internet resources. The evaluator shall verify that the sniffing tool captures the traffic generated by these actions, turn off the sniffing tool, and save the session data. <h:br/>  <h:br/> Step 2: The evaluator shall configure an IPsec VPN client that supports the routing specified in this requirement, and if necessary, configure the device to perform the routing specified as described in the AGD guidance. The evaluator shall ensure the test network is capable of sending any traffic identified as exceptions. The evaluator shall turn on the sniffing tool, establish the VPN connection, and perform the same actions with the device as performed in the first step, as well as ensuring that all exception traffic is generated. The evaluator shall verify that the sniffing tool captures traffic generated by these actions, turn off the sniffing tool, and save the session data. <h:br/>  <h:br/> Step 3: The evaluator shall examine the traffic from both step one and step two to verify that all Data Plane traffic is encapsulated by IPsec, except for any exceptions identified in the SFR (if applicable). For each exception listed in the SFR, the evaluator shall verify that traffic is allowed outside of the VPN tunnel. The evaluator shall examine the Security Parameter Index (SPI) value present in the encapsulated packets captured in Step two from the TOE to the Gateway and shall verify this value is the same for all actions used to generate traffic through the VPN. Note that it is expected that the SPI value for packets from the Gateway to the TOE is different than the SPI value for packets from the TOE to the Gateway. The evaluator shall be aware that IP traffic on the cellular baseband outside of the IPsec tunnel may be emanating from the baseband processor and shall verify with the manufacturer that any identified traffic is not emanating from the application processor. <h:br/>  <h:br/> Step 4: (Conditional: If ICMP is not listed as part of the IP traffic needed for the correct functioning of the TOE) The evaluator shall perform an ICMP echo from the TOE to the IP address of another device on the local wireless network and shall verify that no packets are sent using the sniffing tool. The evaluator shall attempt to send packets to the TOE outside the VPN tunnel (i.e. not through the VPN gateway), including from the local wireless network, and shall verify that the TOE discards them.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FDP_STG_EXT.1 User Data Storage -->
        <f-component cc-id="fdp_stg_ext.1" id="fdp-stg-ext-1" name="User Data Storage">
          <comp-lev> requires the TSF to be able to label, encrypt, store, and decrypt sensitive data and keys.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Failure to encrypt/decrypt data.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            FCS_COP.1 Cryptographic Operation
            <h:br/>
            FCS_STG_EXT.2 Encrypted Cryptographic Key Storage
          </dependencies>
          <f-element id="fel-trust-anchor">
            <title>The TSF shall provide protected storage for the Trust Anchor Database. </title>
            <aactivity>
              <TSS>
                The evaluator shall ensure the TSS describes the Trust Anchor Database
                implemented that contain certificates used to meet the requirements of this PP. This
                description shall contain information pertaining to how certificates are loaded into
                the store, and how the store is protected from unauthorized access (for example,
                UNIX permissions) in accordance with the permissions established in FMT_SMF_EXT.1
                and FMT_MOF_EXT.1.1.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Addition or removal of certificate from Trust Anchor Database</audit-event-descr>
            <audit-event-info>Subject name of certificate.</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FDP_UPC_EXT.1 Inter-TSF User Data Transfer Protection -->
        <f-component cc-id="fdp_upc_ext.1" id="fdp-upc-ext-1" name="Inter-TSF User Data Transfer Protection" status="invisible">
          <comp-lev> requires the TSF to be able to protect communication channels between products using a chosen secure method.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Application initiation of trusted channel.</h:li>
            </h:ul>
          </audit>
          <dependencies>FTP_ITC_EXT.1 Trusted Channel Communication</dependencies>
          <f-element id="fel-tls-app-stub">
            <title>
              The TSF shall provide a means for non-TSF applications executing on the TOE to use
              <assignable>data transfer protocol</assignable>
              to provide a protected communication channel between the non-TSF application and another IT product 
	        that is logically distinct from other communication channels, 
	        provides assured identification of its end points, protects channel data from disclosure, 
	        and detects modification of the channel data.
            </title>
          </f-element>
          <f-element id="fel-tls-app-init-stub">
            <title>The TSF shall permit the non-TSF applications to initiate communication via the
	        trusted channel.</title>
            <aactivity>
              <no-tests/>
            </aactivity>
          </f-element>
        </f-component>
        <!-- FDP_UPC_EXT.1/APPS Inter-TSF User Data Transfer Protection (Applications) -->
        <f-component cc-id="fdp_upc_ext.1" id="fdp-upc-ext-1-apps" name="Inter-TSF User Data Transfer Protection (Applications)" iteration="APPS">
          <f-element id="fel-tls-app">
            <title>
              The TSF shall provide a means for non-TSF applications executing on the TOE to use [<h:i><h:ul><h:li>Mutually authenticated TLS as defined in the <xref to="tls"/>,</h:li> <h:li>HTTPS,</h:li></h:ul>and  <selectables linebreak="yes"><selectable id="upc_dtls">mutually authenticated DTLS as defined in the <xref to="tls"/></selectable><selectable id="s-upc-ipsec">IPsec as defined in the <xref to="mod-vpnclient"/></selectable><selectable id="fdp_upc_ext.1.1_APPS_1" exclusive="yes">no other protocol</selectable></selectables></h:i>] to provide a protected communication channel between the non-TSF
              application and another IT product that is logically distinct from other communication
              channels, provides assured identification of its end points, protects channel data
              from disclosure, and detects modification of the channel data.
            </title>
            <note role="application">
              The intent of this requirement is that one of the selected protocols is available for use by user applications running on the device for use in connecting to distant-end services that are not necessarily part of the enterprise infrastructure. It should be noted that the FTP_ITC_EXT.1 requires that all TSF communications be protected using the protocols indicated in that requirement, so the protocols required by this component ride "on top of" those listed in FTP_ITC_EXT.1.
              <h:br/>
              <h:br/>
              It should also be noted that some applications are part of the TSF, and FTP_ITC_EXT.1 requires that TSF applications be protected by at least one of the protocols in first selection in FTP_ITC_EXT.1. It is not required to have two different implementations of a protocol, or two different protocols, to satisfy both this requirement (for non-TSF apps) and FTP_ITC_EXT.1 (for TSF apps), as long as the services specified are provided.
              <h:br/>
              <h:br/>
              The ST author must list which trusted channel protocols are implemented by the Mobile Device for use by non-TSF apps.
              <h:br/>
              <h:br/>
              The TSF must be validated against FCS_TLSC_EXT requirements from the
              <xref to="tls"/>, with the claims from that package made for those requirements as specified in
              <xref to="package-ussage"/>.
              <h:br/>
              If
              <xref to="upc_dtls"/>
              is selected, the TSF must be validated against FCS_DTLS_EXT requirements from the
              <xref to="tls"/>, with the claims from that package made for those requirements as specified in
              <xref to="package-ussage"/>.
              <h:br/>
              If the ST author selects
              <xref to="s-upc-ipsec"/>, the TSF must be validated against the PP-Module for Virtual Private Network (VPN) Clients.
            </note>
          </f-element>
          <f-element id="fel-tls-app-init">
            <title>The TSF shall permit the non-TSF applications to initiate communication via the
              trusted channel.</title>
            <aactivity>
              The evaluator shall verify that the API documentation provided according to
              <xref to="adv"/>
              includes the security functions (protection channel)
              described in these requirements, and verify that the APIs implemented to support this
              requirement include the appropriate settings/parameters so that the application can
              both provide and obtain the information needed to assure mutual identification of the
              endpoints of the communication as required by this component.
              <h:br/>
              <h:br/>
              <TSS>
                The evaluator shall examine the TSS to determine that it describes that all
                protocols listed in the TSS are specified and included in the requirements in the
                ST.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall confirm that the operational guidance contains
                instructions necessary for configuring the protocols selected for use by the
                applications.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following test requires the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <h:br/>
                <h:br/>
                The evaluator shall write, or the developer shall provide access to, an application that requests protected channel services by the TSF. The evaluator shall verify that the results from the protected channel match the expected results according to the API documentation. This application may be used to assist in verifying the protected channel Evaluation Activities for the protocol requirements. The evaluator shall also perform the following tests:
                <testlist>
                  <test>The evaluators shall ensure that the application is able to initiate communications with an external IT entity using each protocol specified in the requirement, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>The evaluator shall ensure, for each communication channel with an authorized IT entity, the channel data are not sent in plaintext.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Application initiation of trusted channel</audit-event-descr>
            <audit-event-info>Name of application. Trusted channel protocol. Non-TOE endpoint of connection</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FDP_UPC_EXT.1/BLUETOOTH Inter-TSF User Data Transfer Protection (Bluetooth) -->
        <f-component cc-id="fdp_upc_ext.1" id="fdp-upc-ext-1-bluetooth" name="Inter-TSF User Data Transfer Protection (Bluetooth)" iteration="BLUETOOTH" status="feat-based">
          <depends on="bluetooth"/>
          <f-element id="fel-bluetooth">
            <title>
              The TSF shall provide a means for non-TSF applications executing on the TOE to
              use [<h:i><h:ul><h:li>Bluetooth BR/EDR in accordance with the <xref to="mod-bluetooth"/>,</h:li></h:ul>and  <selectables linebreak="yes"><selectable id="fdp_upc_ext.1.1_BLUETOOTH_1">Bluetooth LE in accordance with the <xref to="mod-bluetooth"/></selectable><selectable id="fdp_upc_ext.1.1_BLUETOOTH_2" exclusive="yes">no other protocol</selectable></selectables></h:i>] to provide a protected communication channel between the non-TSF
              application and another IT product that is logically distinct from other communication
              channels, provides assured identification of its end points, protects channel data
              from disclosure, and detects modification of the channel data.
            </title>
            <note role="application">
              If the TOE includes Bluetooth hardware, 
              this requirement must be included in the ST. The intent of this requirement is that
              Bluetooth BR/EDR and optionally Bluetooth LE is available for use by user applications
              running on the device for use in connecting to distant-end services that are not
              necessarily part of the enterprise infrastructure. The ST author must list which
              trusted channel protocols are implemented by the Mobile Device for use by non-TSF
              apps.
              <h:br/>
              <h:br/>
              The TSF must be validated against requirements from the
              <xref to="mod-bluetooth"/>. It should be noted that the FTP_ITC_EXT.1 requires that all
              TSF communications be protected using the protocols indicated in that requirement, so
              the protocols required by this component ride "on top of" those listed in
              FTP_ITC_EXT.1.
              <h:br/>
              <h:br/>
            </note>
          </f-element>
          <f-element id="fel-bluetooth-chan">
            <title>The TSF shall permit the non-TSF applications to initiate communication via the
              trusted channel.</title>
            <aactivity>
              The evaluator shall verify that the API documentation provided according to
              <xref to="adv"/>
              includes the security functions (protection channel)
              described in these requirements, and verify that the APIs implemented to support this
              requirement include the appropriate settings/parameters so that the application can
              both provide and obtain the information needed to assure mutual identification of the
              endpoints of the communication as required by this component.
              <h:br/>
              <h:br/>
              <TSS>
                The evaluator shall examine the TSS to determine that it describes that all
                protocols listed in the TSS are specified and included in the requirements in the
                ST.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall confirm that the operational guidance contains
                instructions necessary for configuring the protocols selected for use by the
                applications.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following test requires the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <h:br/>
                <h:br/>
                The evaluator shall write, or the developer shall provide access to, an application that requests protected channel services by the TSF. The evaluator shall verify that the results from the protected channel match the expected results according to the API documentation. This application may be used to assist in verifying the protected channel Evaluation Activities for the protocol requirements. The evaluator shall also perform the following tests:
                <testlist>
                  <test>The evaluators shall ensure that the application is able to initiate communications with an external IT entity using each protocol specified in the requirement, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>The evaluator shall ensure, for each communication channel with an authorized IT entity, the channel data are not sent in plaintext.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Application initiation of trusted channel</audit-event-descr>
            <audit-event-info>Name of application. Trusted channel protocol. Non-TOE endpoint of connection</audit-event-info>
          </audit-event>
        </f-component>
      </section>
      <!-- 5.1.4 Class: Identification and Authentication (FIA) -->
      <section id="fia" title="Class: Identification and Authentication (FIA)">
        <ext-comp-def title="Authentication Failures" fam-id="FIA_AFL_EXT">
          <fam-behavior>This family defines requirements for authentication failure handling that are not addressed by the FIA_AFL family in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Password Management" fam-id="FIA_PMG_EXT">
          <fam-behavior>This family defines requirements for the composition of password credentials.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Authentication Throttling" fam-id="FIA_TRT_EXT">
          <fam-behavior>This family defines requirements for prevention of brute-force authentication attempts.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="User Authentication" fam-id="FIA_UAU_EXT">
          <fam-behavior>This family defines requirements for user authentication that are not addressed by FIA_UAU in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="X.509 Certificates" fam-id="FIA_X509_EXT">
          <fam-behavior>This family defines requirements for the management and use of X.509 certificates.</fam-behavior>
        </ext-comp-def>
        <!-- FIA_AFL_EXT.1 Authentication Failure Handling -->
        <f-component cc-id="fia_afl_ext.1" id="fia-afl-ext-1" name="Authentication Failure Handling">
          <comp-lev> requires the TSF be able to manage unsuccessful authentication attempts and limit the number of attempts for each method.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Configuration of authentication failure limit.</h:li>
            </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Exceeding configured authentication failure limit.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            FCS_CKM_EXT.5 TSF Wipe
            <h:br/>
            FIA_UAU.1 Timing of Authentication
            FIA_UAU.5 Multiple Authentication Mechanisms
          </dependencies>
          <f-element id="fel-authfail-what">
            <title>The TSF shall consider password and  <selectables><selectable id="fia_afl_ext.1.1_1">biometric in accordance with the <xref to="mod-biometrics"/></selectable><selectable id="fia_afl_ext.1.1_2">hybrid</selectable><selectable id="s-authfail-noother" exclusive="yes">no other mechanism</selectable></selectables>  as critical authentication mechanisms. </title>
            <ext-comp-def-title>
              <title>
                The TSF shall consider password and
                <assignable>list of acceptable authentication mechanisms</assignable>
                as critical authentication mechanisms.
              </title>
            </ext-comp-def-title>
            <note role="application">
              A critical authentication mechanism is one in which
              countermeasures are triggered (i.e. wipe of the device) when the maximum number of
              unsuccessful authentication attempts is exceeded, rendering the other factors
              unavailable.
              <h:br/>
              <h:br/>
              If no additional authentication mechanisms are
              selected in FIA_UAU.5.1, then
              <xref to="s-authfail-noother"/>
              must be selected.
			  If an additional
              authentication mechanism is selected in FIA_UAU.5.1, then it must only be selected in
              FIA_AFL_EXT.1.1 if surpassing the authentication failure threshold for biometric data
              causes a countermeasure to be triggered regardless of the failure status of the other
              authentication mechanisms.
              <h:br/>
              <h:br/>
              If the TOE implements multiple
              Authentication Factor interfaces (for example, a DAR decryption interface, a
              lock screen interface, an auxiliary boot mode interface), this component applies to all
              available interfaces. For example, a password is a critical authentication mechanism
              regardless of if it is being entered at the DAR decryption interface or at a
              lock screen interface.
            </note>
          </f-element>
          <f-element id="fel-authfail-num">
            <title>
              The TSF shall detect when a configurable positive integer within
              <assignable>range of acceptable values for each authentication mechanism</assignable>
              of
              <selectables>
                <selectable id="s-authfail-num-unique">unique</selectable>
                <selectable id="s-authfail-num-non-unique">non-unique</selectable>
              </selectables>
              unsuccessful authentication attempts occur related to last successful
            authentication for each authentication mechanism.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall detect when a configurable positive integer within
                <assignable>range of acceptable values for each authentication
                mechanism</assignable>
                of
                <selectables>
                  <selectable>unique</selectable>
                  <selectable>non-unique</selectable>
                </selectables>
                unsuccessful authentication attempts occur related to last successful
              authentication for each authentication mechanism.
              </title>
            </ext-comp-def-title>
            <note role="application">
              The positive integers is configured according to
              FMT_SMF_EXT.1.1 function
              <xref to="mf-screenlock"/>.
              <h:br/>
              <h:br/>
              An unique
              authentication attempt is defined as any attempt to verify a password or biometric
              sample, in which the input is different from a previous attempt. "<xref to="s-authfail-num-unique"/>" must be
              selected if the authentication system increments the counter only for unique
              unsuccessful authentication attempts. For example, if the same incorrect password is
              attempted twice the authentication system increments the counter once. "<xref to="s-authfail-num-non-unique"/>" must be selected if the authentication system
			  increments the counter for each
              unsuccessful authentication attempt, regardless of if the input is unique. For
              example, if the same incorrect password is attempted twice the authentication system
              increments the counter twice.
              <h:br/>
              <h:br/>
              If hybrid authentication (i.e. a
              combination of biometric and pin/password) is supported, a failed authentication
              attempt can be counted as a single attempt, even if both the biometric and
              pin/password were incorrect.
              <h:br/>
              <h:br/>
              If the TOE supports multiple
              authentication mechanisms per FIA_UAU.5.1, this component applies to all
              authentication mechanisms. It is acceptable for each authentication mechanism to
              utilize an independent counter or for multiple authentication mechanisms to utilize a
              shared counter. The interaction between the authentication factors in regards to the
              authentication counter must be in accordance with FIA_UAU.5.2.
              <h:br/>
              <h:br/>
              If
              the TOE implements multiple Authentication Factor interfaces (for example, a DAR
              decryption interface, a lock screen interface, an auxiliary boot mode interface), this
              component applies to all available interfaces. However, it is acceptable for each
              Authentication Factor interface to be configurable with a different number of
              unsuccessful authentication attempts.
            </note>
          </f-element>
          <f-element id="fel-authfail-power">
            <title>The TSF shall maintain the number of unsuccessful authentication attempts that
              have occurred upon power off.</title>
            <note role="application">The TOE may implement an Authentication Factor interface that
              precedes another Authentication Factor interface in the boot sequence (for example, a
              volume DAR decryption interface which precedes the lock screen interface) before the
              user can access the device. In this situation, because the user must successfully
              authenticate to the first interface to access the second, the number of unsuccessful
              authentication attempts need not be maintained for the second interface.</note>
          </f-element>
          <f-element id="fel-authfail-reach-max">
            <title>When the defined number of unsuccessful authentication attempts has exceeded the
              maximum allowed for a given authentication mechanism, all future authentication
              attempts will be limited to other available authentication mechanisms, unless the
              given mechanism is designated as a critical authentication mechanism.</title>
            <note role="application">In accordance with FIA_AFL_EXT.1.3, this requirement also
              applies after the TOE is powered off and powered back on.</note>
          </f-element>
          <f-element id="fel-authfail-reach-max-wipe">
            <title>When the defined number of unsuccessful authentication attempts for the last
              available authentication mechanism or single critical authentication mechanism has
              been surpassed, the TSF shall perform a wipe of all protected data.</title>
            <note role="application">
              Wipe is performed in accordance with FCS_CKM_EXT.5. Protected
              data is all non-TSF data, including all user or enterprise data. Some or all of this
              data may be considered sensitive data as well.
              <h:br/>
              <h:br/>
              If the TOE
              implements multiple Authentication Factor interfaces (for example, a DAR decryption
              interface, a lock screen interface, an auxiliary boot mode interface), this component
              applies to all available interfaces.
            </note>
          </f-element>
          <f-element id="fel-authfail-incr">
            <title>The TSF shall increment the number of unsuccessful authentication attempts prior
              to notifying the user that the authentication was unsuccessful.</title>
            <note role="application">This requirement is to ensure that if power is cut to the
              device directly after an authentication attempt, the counter will be incremented to
              reflect that attempt.</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS describes that a value corresponding to
                the number of unsuccessful authentication attempts since the last successful
                authentication is kept for each Authentication Factor interface. The evaluator shall
                ensure that this description also includes if and how this value is maintained when
                the TOE loses power, either through a graceful powered off or an ungraceful loss of
                power. The evaluator shall ensure that if the value is not maintained, the interface
                is after another interface in the boot sequence for which the value is maintained.
                <h:br/>
                <h:br/>
                If the TOE supports multiple authentication mechanisms, the
                evaluator shall ensure that this description also includes how the unsuccessful
                authentication attempts for each mechanism selected in FIA_UAU.5.1 is handled. The
                evaluator shall verify that the TSS describes if each authentication mechanism
                utilizes its own counter or if multiple authentication mechanisms utilize a shared
                counter. If multiple authentication mechanisms utilize a shared counter, the
                evaluator shall verify that the TSS describes this interaction.
                <h:br/>
                <h:br/>
                The evaluator shall confirm that the TSS describes how the process used to determine
                if the authentication attempt was successful. The evaluator shall ensure that the
                counter would be updated even if power to the device is cut immediately following
                notifying the TOE user if the authentication attempt was successful or not.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall verify that the AGD guidance describes how the
                administrator configures the maximum number of unique unsuccessful authentication
                attempts.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall configure the device with all authentication mechanisms selected in FIA_UAU.5.1. The evaluator shall perform the following tests for each available authentication interface: <h:br/>  <h:br/> Test 1a: The evaluator shall configure the TOE, according to the AGD guidance, with a maximum number of unsuccessful authentication attempts. The evaluator shall enter the locked state and enter incorrect passwords until the wipe occurs. The evaluator shall verify that the number of password entries corresponds to the configured maximum and that the wipe is implemented. <h:br/>  <h:br/> Test 1b: [conditional] If the TOE supports multiple authentication mechanisms the previous test shall be repeated using a combination of authentication mechanisms confirming that the critical authentication mechanisms will cause the device to wipe and that when the maximum number of unsuccessful authentication attempts for a non-critical authentication mechanism is exceeded, the device limits authentication attempts to other available authentication mechanisms. If multiple authentication mechanisms utilize a shared counter, then the evaluator shall verify that the maximum number of unsuccessful authentication attempts can be reached by using each individual authentication mechanism and a combination of all authentication mechanisms that share the counter.</test>
                  <test>The evaluator shall repeat test one, but shall power off (by removing the battery, if possible) the TOE between unsuccessful authentication attempts. The evaluator shall verify that the total number of unsuccessful authentication attempts for each authentication mechanism corresponds to the configured maximum and that the critical authentication mechanisms cause the device to wipe. Alternatively, if the number of authentication failures is not maintained for the interface under test, the evaluator shall verify that upon booting the TOE between unsuccessful authentication attempts another authentication factor interface is presented before the interface under test.</test>
                  <h:br/>
                  <h:br/>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Excess of authentication failure limit</audit-event-descr>
            <audit-event-info>Authentication factor used</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FIA_PMG_EXT.1 Password Management -->
        <f-component cc-id="fia_pmg_ext.1" id="fia-pmg-ext-1" name="Password Management">
          <comp-lev> requires the TSF to enforce character length and composition requirements for password credentials.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Configuring password policy.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FIA_UAU.5 Multiple Authentication Mechanisms</dependencies>
          <f-element id="fel-password-manage">
            <title>The TSF shall support the following for the Password Authentication Factor: <h:ol><h:li>Passwords shall be able to be composed of any combination of  <selectables><selectable id="fia_pmg_ext.1.1_1">upper and lower case letters</selectable><selectable id="fia_pmg_ext.1.1_3"><assignable>a character set of at least 52 characters</assignable></selectable></selectables>, numbers, and special characters:  <selectables><selectable id="fia_pmg_ext.1.1_4">"!"</selectable><selectable id="fia_pmg_ext.1.1_5">"@"</selectable><selectable id="fia_pmg_ext.1.1_6">"#"</selectable><selectable id="fia_pmg_ext.1.1_7">"$"</selectable><selectable id="fia_pmg_ext.1.1_8">"%"</selectable><selectable id="fia_pmg_ext.1.1_9">"^"</selectable><selectable id="fia_pmg_ext.1.1_10">"&amp;"</selectable><selectable id="fia_pmg_ext.1.1_11">"*"</selectable><selectable id="fia_pmg_ext.1.1_12">"("</selectable><selectable id="fia_pmg_ext.1.1_13">")"</selectable><selectable id="fia_pmg_ext.1.1_15"><assignable>other characters</assignable></selectable></selectables> ; </h:li> <h:li>Password length up to <assignable>an integer greater than or equal to 14</assignable>  characters shall be supported. </h:li></h:ol></title>
            <note role="application">
              While some corporate policies require passwords of 14
              characters or better, the use of a REK for DAR protection and key storage protection
              and the anti-hammer requirement (FIA_TRT_EXT.1) addresses the threat of attackers with
              physical access using much smaller and less complex passwords.
              <h:br/>
              <h:br/>
              The
              ST author selects the character set: either the upper and lower case Basic Latin
              letters or another assigned character set containing at least 52 characters. The
              assigned character set must be well defined: either according to an international
              encoding standard (such as Unicode) or defined in the assignment by the ST author. The
              ST author also selects the special characters that are supported by the TOE; they may
              optionally list additional special characters supported using the assignment.
            </note>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>The evaluator shall examine the operational guidance to determine that it
                provides guidance to security administrators on the composition of strong passwords,
                and that it provides instructions on setting the minimum password length. The
                evaluator shall also perform the following tests. Note that one or more of these
                tests can be performed with a single test case.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall compose passwords that either meet the requirements, or fail to meet the requirements, in some way. For each password, the evaluator shall verify that the TOE supports the password. While the evaluator is not required (nor is it feasible) to test all possible compositions of passwords, the evaluator shall ensure that all characters, rule characteristics, and a minimum length listed in the requirement are supported, and justify the subset of those characters chosen for testing.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FIA_TRT_EXT.1 Authentication Throttling -->
        <f-component cc-id="fia_trt_ext.1" id="fia-trt-ext-1" name="Authentication Throttling">
          <comp-lev> requires the TSF to limit authentication attempts by number of attempts in a set amount of time.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FIA_UAU.5 Multiple Authentication Mechanisms</dependencies>
          <f-element id="fel-auth-throttle">
            <title>
              The TSF shall limit automated user authentication attempts by
              <selectables>
                <selectable id="fia_trt_ext.1.1_1">preventing authentication via an external port</selectable>
                <selectable id="fia_trt_ext.1.1_2">enforcing a delay between incorrect authentication attempts</selectable>
              </selectables>
              for all authentication mechanisms selected in FIA_UAU.5.1. The minimum
              delay shall be such that no more than 10 attempts can be attempted per 500
              milliseconds.
            </title>
            <note role="application">The authentication throttling applies to all authentication
              mechanisms selected in FIA_UAU.5.1. The user authentication attempts in this
              requirement are attempts to guess the Authentication Factor. The developer can
              implement the timing of the delays in the requirements using unequal or equal timing
              of delays. The minimum delay specified in this requirement provides defense against
              brute forcing.</note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes the method by which
                authentication attempts are not able to be automated. The evaluator shall ensure
                that the TSS describes either how the TSF disables authentication via external
                interfaces (other than the ordinary user interface) or how authentication attempts
                are delayed in order to slow automated entry and shall ensure that this delay totals
                at least 500 milliseconds over 10 attempts for all authentication mechanisms
                selected in FIA_UAU.5.1.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FIA_UAU.5 Multiple Authentication Mechanisms -->
        <f-component cc-id="fia_uau.5" id="fia-uau-5" name="Multiple Authentication Mechanisms">
          <f-element id="fel-uau">
            <title>
              The TSF shall provide
              <h:b>password and</h:b>
              <selectables>
                <selectable id="uau_biometric">biometric in accordance with the <xref to="mod-biometrics"/></selectable>
                <selectable id="uau_hybr">hybrid</selectable>
                <selectable id="fia_uau.5.1_1" exclusive="yes">no other mechanism</selectable>
              </selectables>
              to support user authentication.
            </title>
            <note role="application">
              The TSF must support a Password Authentication Factor and may
              optionally implement a BAF. A hybrid authentication factor is where a user has to submit a
              combination of PIN/password and biometric sample where both have to pass and if either
              fails the user is not made aware of which factor failed.
              <h:br/>
              <h:br/>
              If
              <xref to="uau_biometric"/>
              or
              <xref to="uau_hybr"/>
              is selected,
	      then the TSF must be validated against requirements from the
              <xref to="mod-biometrics"/>.
              <h:br/>
              <h:br/>
              If
              <xref to="uau_hybr"/>
              is selected,
              <xref to="uau_biometric"/>
              does not need to be selected, but should be
              selected if the biometric authentication can be used independent of the hybrid
              authentication, i.e. without having to enter a PIN/password.
              <h:br/>
              <h:br/>
              The Password Authentication Factor is configured according to FIA_PMG_EXT.1.
            </note>
          </f-element>
          <f-element id="fel-auth-claim">
            <title>
              The TSF shall authenticate any user's claimed identity according to the
              <assignable>rules describing how the multiple authentication mechanisms provide authentication</assignable>.
            </title>
            <note role="application">Rules regarding how the authentication
              factors interact in terms of unsuccessful authentication are covered in
              FIA_AFL_EXT.1.</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS describes each mechanism provided to
                support user authentication and the rules describing how the authentication
                mechanisms provide authentication.
                <h:br/>
                <h:br/>
                Specifically, for all authentication mechanisms specified in FIA_UAU.5.1, the
                evaluator shall ensure that the TSS describes the rules as to how each authentication mechanism is used. Example
                rules are how the authentication mechanism authenticates the user (i.e. how does the
                TSF verify that the correct password or biometric sample was entered), the result of a
                successful authentication (i.e. is the user input used to derive or unlock a key) and
                which authentication mechanism can be used at which authentication factor interfaces
                (i.e. if there are times, for example, after a reboot, that only specific
                authentication mechanisms can be used). If multiple BAFs are claimed in FIA_MBV_EXT.1.1 in the
                <xref to="mod-biometrics"/>, the interaction between the BAFs must be described. For example, whether the
                multiple BAFs can be enabled at the same time.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall verify that configuration guidance for each
                authentication mechanism is addressed in the AGD guidance.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>For each authentication mechanism selected in FIA_UAU.5.1, the evaluator shall enable that mechanism and verify that it can be used to authenticate the user at the specified authentication factor interfaces.</test>
                  <test>For each authentication mechanism rule, the evaluator shall ensure that the authentication mechanisms behave accordingly.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FIA_UAU.6/CREDENTIAL Re-Authenticating (Credential Change) -->
        <f-component cc-id="fia_uau.6" id="fia-uau-6-credential" name="Re-Authenticating (Credential Change)" iteration="CREDENTIAL">
          <f-element id="fel-reauth-when">
            <title>The TSF shall re-authenticate the user <h:b>via the Password
              Authentication Factor</h:b> under the conditions [<h:i>attempted change
                to any supported authentication mechanisms</h:i>]. </title>
            <note role="application">The password authentication factor must be entered before
              either the password or biometric authentication factor, if selected in FIA_UAU.5.1,
              can be changed.</note>
            <aactivity level="element">
              <TSS>There are no TSS evaluation activities for this element.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall configure the TSF to use the Password Authentication Factor according to the AGD guidance. The evaluator shall change Password Authentication Factor according to the AGD guidance and verify that the TSF requires the entry of the Password Authentication Factor before allowing the factor to be changed.</test>
                  <test>[conditional] If <xref to="uau_biometric"/> is selected in FIA_UAU.5.1, for each BAF claimed in FIA_MBV_EXT.1.1 in the <xref to="mod-biometrics"/> the evaluator shall configure the TSF to use the BAF, which includes configuring the Password Authentication Factor, according to the AGD guidance. The evaluator shall change the BAF according to the AGD guidance and verify that the TSF requires the entry of the Password Authentication Factor before allowing the BAF to be changed.</test>
                  <test>[conditional] If <xref to="uau_hybr"/> is selected in FIA_UAU.5.1, the evaluator shall configure the TSF to use the BAF and PIN or password, which includes configuring the Password Authentication Factor, according to the AGD guidance. The evaluator shall change the BAF and PIN according to the AGD guidance and verify that the TSF requires the entry of the Password Authentication Factor before allowing the factor to be changed.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FIA_UAU.6/LOCKED Re-Authenticating (TSF Lock) -->
        <f-component cc-id="fia_uau.6" id="fia-uau-6-locked" name="Re-Authenticating (TSF Lock)" iteration="LOCKED">
          <f-element id="fel-reauth-how">
            <title> The TSF shall re-authenticate the user <h:b>via an authentication factor
              defined in FIA_UAU.5.1</h:b> under the conditions  <h:b>TSF-initiated lock, user-initiated lock, <assignable>other conditions</assignable> </h:b>. </title>
            <note role="application">Depending on the selections made in FIA_UAU.5.1, either the
              password (at a minimum), biometric authentication or hybrid authentication mechanisms
              can be used to unlock the device. TSF-initiated and user-initiated locking is described in
              FTA_SSL_EXT.1.</note>
            <aactivity level="element">
              <TSS>There are no TSS evaluation activities for this element.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall configure the TSF to transition to the locked state after a time of inactivity (FMT_SMF_EXT.1) according to the AGD guidance. The evaluator shall wait until the TSF locks and then verify that the TSF requires the entry of the Password Authentication Factor before transitioning to the unlocked state.</test>
                  <test>[conditional] If <xref to="uau_biometric"/> is selected in FIA_UAU.5.1, for each BAF claimed in FIA_MBV_EXT.1.1 in the <xref to="mod-biometrics"/> the evaluator shall repeat Test 1 verifying that the TSF requires the entry of the BAF before transitioning to the unlocked state.</test>
                  <test>[conditional] If <xref to="uau_hybr"/> is selected in FIA_UAU.5.1, the evaluator shall repeat Test 1 verifying that the TSF requires the entry of the BAF and PIN/password before transitioning to the unlocked state.</test>
                  <test id="t-locks">The evaluator shall configure user-initiated locking according to the AGD guidance. The evaluator shall lock the TSF and then verify that the TSF requires the entry of the Password Authentication Factor before transitioning to the unlocked state.</test>
                  <test>[conditional] If <xref to="uau_biometric"/> is selected in FIA_UAU.5.1, for each BAF claimed in FIA_MBV_EXT.1.1 in the <xref to="mod-biometrics"/> the evaluator shall repeat <xref to="t-locks"/> verifying that the TSF requires the entry of the BAF before transitioning to the unlocked state.</test>
                  <test>[conditional] If <xref to="uau_hybr"/> is selected in FIA_UAU.5.1, the evaluator shall repeat <xref to="t-locks"/> verifying that the TSF requires the entry of the BAF and PIN/password before transitioning to the unlocked state.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>User changes Password Authentication Factor</audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FIA_UAU.7 Protected Authentication Feedback  -->
        <f-component cc-id="fia_uau.7" id="fia-uau-7" name="Protected Authentication Feedback ">
          <f-element id="fel-auth-feedback">
            <title>The TSF shall provide only [<h:i>obscured feedback to the device’s
              display</h:i>] to the user while the authentication is in progress. </title>
            <note role="application">
              This applies to all authentication methods specified in
              FIA_UAU.5.1. The TSF may briefly (1 second or less) display each character or provide
              an option to allow the user to unmask the password; however, the password must be
              obscured by default.
              <h:br/>
              <h:br/>
              If
              <xref to="uau_biometric"/>
              is selected in FIA_UAU.5.1, the TSF
              must not display sensitive information regarding any BAF that could aid an
              adversary in identifying or spoofing the respective biometric characteristics of a
              given human user. While it is true that biometric samples, by themselves, are not
              secret, the analysis performed by the respective biometric algorithms, as well as
              output data from these biometric algorithms, is considered sensitive and must be kept
              secret. Where applicable, the TSF must not reveal or make public the reasons for
              authentication failure.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS describes the means of obscuring the
                authentication entry, for all authentication methods specified in FIA_UAU.5.1.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>The evaluator shall verify that any configuration of this requirement is
                addressed in the AGD guidance and that the password is obscured by default.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall enter passwords on the device, including at least the Password Authentication Factor at lock screen, and verify that the password is not displayed on the device.</test>
                  <test>[conditional] If <xref to="uau_biometric"/> is selected in FIA_UAU.5.1, for each BAF claimed in FIA_MBV_EXT.1.1 in the <xref to="mod-biometrics"/> the evaluator shall authenticate by producing a biometric sample at lock screen. As the biometric algorithms are performed, the evaluator shall verify that sensitive images, audio, or other information identifying the user are kept secret and are not revealed to the user. Additionally, the evaluator shall produce a biometric sample that fails to authenticate and verify that the reasons for authentication failure (user mismatch, low sample quality, etc.) are not revealed to the user. It is acceptable for the BAF to state that it was unable to physically read the biometric sample, for example, if the sensor is unclean or the biometric sample was removed too quickly. However, specifics regarding why the presented biometric sample failed authentication shall not be revealed to the user.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FIA_UAU_EXT.1 Authentication for Cryptographic Operation -->
        <f-component cc-id="fia_uau_ext.1" id="fia-uau-ext-1" name="Authentication for Cryptographic Operation">
          <comp-lev> requires the TSF enforce data-at-rest protection until successful authentication has occurred. </comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FDP_DAR_EXT.1 Protected Data Encryption
            <h:br/>
            FDP_DAR_EXT.2 Sensitive Data Encryption
          </dependencies>
          <f-element id="fel-auth-before-decrypt">
            <title>
              The TSF shall require the user to present the Password Authentication Factor
              prior to decryption of protected data and encrypted DEKs, KEKs and
              <selectables>
                <selectable id="fia_uau_ext.1.1_1">long-term trusted channel key material</selectable>
                <selectable id="fia_uau_ext.1.1_2">all software-based key storage</selectable>
                <selectable id="fia_uau_ext.1.1_3" exclusive="yes">no other keys</selectable>
              </selectables>
              at startup.
            </title>
            <note role="application">The intent of this requirement is to prevent decryption of
              protected data before the user has authorized to the device using the Password
              Authentication Factor. The Password Authentication Factor is also required in order
              derive the key used to decrypt sensitive data, which includes software-based secure
              key storage.</note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS section of the ST describes the process
                for decrypting protected data and keys. The evaluator shall ensure that this process
                requires the user to enter a Password Authentication Factor and, in accordance with
                FCS_CKM_EXT.3, derives a KEK, which is used to protect the software-based secure key
                storage and (optionally) DEKs for sensitive data, in accordance with
                FCS_STG_EXT.2.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                The following tests may be performed in conjunction with FDP_DAR_EXT.1 and FDP_DAR_EXT.2.
                <h:br/>
                <h:br/>
                <h:b>Evaluation Activity Note:</h:b>
                The following test require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <h:br/>
                <h:br/>
                <testlist>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall enable encryption of protected data and require user authentication according to the AGD guidance. The evaluator shall write, or the developer shall provide access to, an application that includes a unique string treated as protected data. <h:br/>  <h:br/> The evaluator shall reboot the device, use a tool provided by developer to search for the unique string within the application data, and verify that the unique string cannot be found. The evaluator shall enter the Password Authentication Factor to access full device functionality, use a tool provided by the developer to access the unique string within the application data, and verify that the unique string can be found.</test>
                  <test>[conditional] The evaluator shall require user authentication according to the AGD guidance. The evaluator shall store a key in the software-based secure key storage. <h:br/>  <h:br/> The evaluator shall lock the device, use a tool provided by developer to access the key within the stored data, and verify that the key cannot be retrieved or accessed. The evaluator shall enter the Password Authentication Factor to access full device functionality, use a tool provided by developer to access the key, and verify that the key can be retrieved or accessed.</test>
                  <test>[conditional] The evaluator shall enable encryption of sensitive data and require user authentication according to the AGD guidance. The evaluator shall write, or the developer shall provide access to, an application that includes a unique string treated as sensitive data. <h:br/>  <h:br/> The evaluator shall lock the device, use a tool provided by developer to attempt to access the unique string within the application data, and verify that the unique string cannot be found. The evaluator shall enter the Password Authentication Factor to access full device functionality, use a tool provided by developer to access the unique string within the application data, and verify that the unique string can be retrieved.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FIA_UAU_EXT.2 Timing of Authentication -->
        <f-component cc-id="fia_uau_ext.2" id="fia-uau-ext-2" name="Timing of Authentication">
          <comp-lev> requires the TSF to prevent a subject’s use of TOE until the user is authenticated.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Enabling/disabling display TSF notifications while in the locked state.</h:li>
              <h:li>Enabling/disabling bypass of local user authentication.</h:li>
            </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Action performed before authentication.</h:li>
            </h:ul>
          </audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-before-auth-what">
            <title>
              The TSF shall allow
              <selectables>
                <selectable id="fia_uau_ext.2.1_2">
                  <assignable>list of actions</assignable>
                </selectable>
                <selectable id="fia_uau_ext.2.1_3">no actions</selectable>
              </selectables>
              on behalf of the user to be performed before the user is authenticated.
            </title>
          </f-element>
          <f-element id="fel-auth-before-what">
            <title>The TSF shall require each user to be successfully authenticated before allowing
              any other TSF-mediated actions on behalf of that user.</title>
            <note role="application">
              The security relevant actions allowed by unauthorized users in
              locked state must be listed. At a minimum the actions that correspond to the functions
              available to the user in FMT_SMF_EXT.1 and are allowed by unauthorized users in locked
              state should be listed. For example, if the user can enable/disable the camera per
              function
              <xref to="mf-audioVisual"/>
              of FMT_SMF_EXT.1 and unauthorized users can
              take a picture when the device is in locked state, this action must be listed.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes the actions allowed by
                unauthorized users in the locked state.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>The evaluator shall attempt to perform some actions not listed in the selection while the device is in the locked state and verify that those actions do not succeed.</Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Action performed before authentication.</audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FIA_UAU_EXT.4 Secondary User Authentication -->
        <f-component cc-id="fia_uau_ext.4" id="fc-fia-uau-ext-4" name="Secondary User Authentication" status="optional">
          <comp-lev> requires the TSF to enforce the use of a secondary authentication factor to access certain user data.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FDP_ACF_EXT.2 Access Control for System Resources
            <h:br/>
            FIA_UAU.5 Multiple Authentication Mechanisms
          </dependencies>
          <f-element id="fel-two-auths">
            <title>The TSF shall provide a secondary authentication mechanism for accessing
              Enterprise applications and resources. The secondary authentication mechanism shall
              control access to the Enterprise application and shared resources and shall be
              incorporated into the encryption of protected and sensitive data belonging to
              Enterprise applications and shared resources.</title>
            <note role="application">
              For the BYOD use case, Enterprise applications and data must
              be protected using a different password than the user authentication to gain access to
              the personal applications and data, if configured.
              <h:br/>
              <h:br/>
              This requirement
              must be included in the ST if the TOE implements a container solution, in which there
              is a separate authentication, to separate user and Enterprise applications and
              resources.
            </note>
            <aactivity level="element">
              <TSS>There are no TSS evaluation activities for this element.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>The Evaluation Activities for any selected requirements related to device authentication must be separately performed for the secondary authentication mechanism (in addition to activities performed for the primary authentication mechanism). The requirements are: FIA_UAU.6/CREDENTIAL, FIA_UAU.6/LOCKED, FIA_PMG_EXT.1, FIA_TRT_EXT.1, FIA_UAU.7, FIA_UAU_EXT.2, FTA_SSL_EXT.1, FCS_STG_EXT.2, FMT_SMF_EXT.1/FMT_MOF_EXT.1 #1, #2, #8, #21, and #36. <h:br/> <h:br/>Additionally, FIA_AFL_EXT.1 must be met, except that in FIA_AFL_EXT.1.2 the separate test is performed with the text "wipe of all protected data" changed to "wipe of all Enterprise application data and all Enterprise shared resource data."</Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-two-auth-when">
            <title>The TSF shall require the user to present the secondary authentication factor
              prior to decryption of Enterprise application data and Enterprise shared resource
              data.</title>
            <note role="application">The intent of this requirement is to prevent decryption of protected
              Enterprise application data and Enterprise shared resource data before the user has
              authenticated to the device using the secondary authentication factor. Enterprise
              shared resource data consists of the FDP_ACF_EXT.2.1 selections.</note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS section of the ST describes the process
                for decrypting Enterprise application data and shared resource data. The evaluator
                shall ensure that this process requires the user to enter an Authentication Factor
                and, in accordance with FCS_CKM_EXT.3, derives a KEK which is used to protect the
                software-based secure key storage and (optionally) DEKs for sensitive data, in
                accordance with FCS_STG_EXT.2.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this element. <h:br/> <h:br/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FIA_X509_EXT.6 Request Validation of Certificates -->
        <f-component cc-id="fia_x509_ext.6" id="fia-x509-ext-6" name="Request Validation of Certificates">
          <comp-lev> requires the TSF to make a certificate validation service available to environmental components.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FIA_X509_EXT.1 X.509 Validation of Certificates</dependencies>
          <f-element id="fel-certval-app-service">
            <title>The TSF shall provide a certificate validation service to applications.</title>
          </f-element>
          <f-element id="fel-certval-app-respond">
            <title>The TSF shall respond to the requesting application with the success or failure
              of the validation.</title>
            <note role="application">
              In order to comply with all of the rules in FIA_X509_EXT.1 as defined in
              <xref to="X509"/>,
              multiple API calls may be required; all of these calls should be clearly
              documented.
            </note>
            <aactivity>
              The evaluator shall verify that the API documentation provided according to
              <xref to="adv"/>
              includes the security function (certificate validation)
              described in this requirement. This documentation shall be clear as to which results
              indicate success and failure.
              <h:br/>
              <h:br/>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>The evaluator shall write, or the developer shall provide access to, an application that requests certificate validation by the TSF. The evaluator shall verify that the results from the validation match the expected results according to the API documentation. This application may be used to verify that import, removal, modification, and validation are performed correctly according to the tests required by FDP_STG_EXT.1, FTP_ITC_EXT.1, FMT_SMF_EXT.1, and FIA_X509_EXT.1 as defined in <xref to="X509"/>.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </section>
      <!-- 5.1.5 Class: Security Management (FMT) -->
      <section id="fmt" title="Class: Security Management (FMT)">
        Both the user and the administrator may manage the TOE. This administrator is likely to be acting remotely and could be the Mobile Device Management (MDM) Administrator acting through an MDM Agent.
        <h:br/>
        <h:br/>
        The Administrator is responsible for management activities, including setting the policy that is applied by the enterprise on the Mobile Device. These management functions are likely to be a different set than those management functions provided to the user. Management functions that are provided to the user and not the administrator are listed in FMT_MOF_EXT.1.1. Management functions for which the administrator may adopt a policy that restricts the user from performing that function are listed in FMT_MOF_EXT.1.2.
        <h:br/>
        <h:br/>
        <xref to="fmt_smf"/>
        compares the management functions required by this Protection Profile in the following three requirements (FMT_MOF_EXT.1.1, FMT_MOF_EXT.1.2, and FMT_SMF_EXT.1).
        <ext-comp-def title="Management of Functions in TSF" fam-id="FMT_MOF_EXT">
          <fam-behavior>This family defines requirements for authorization to manage the behavior of the TSF that are not addressed by FMT_MOF in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Specification of Management Functions" fam-id="FMT_SMF_EXT">
          <fam-behavior>This family defines requirements for security-relevant management functions that are not addressed by FMT_SMF in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <!-- FMT_MOF_EXT.1 Management of Security Functions Behavior -->
        <f-component cc-id="fmt_mof_ext.1" id="fmt-mof-ext-1" name="Management of Security Functions Behavior">
          <comp-lev> requires the TSF to apply restrictions to access its management functions to the authorized roles.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Managing the group of roles that can interact with the functions in the TSF.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FMT_SMF.1 Specification of Management Functions
            <h:br/>
            FMT_SMR.1 Security Roles
          </dependencies>
          <f-element id="fel-mof-est">
            <title>The TSF shall restrict the ability to perform the functions [<h:i>in column 4 of
              <xref to="fmt_smf"/></h:i>] to the user. </title>
            <ext-comp-def-title>
              <title>The TSF shall restrict the ability to perform the functions <assignable>reference to list of management functions</assignable> to the user. </title>
            </ext-comp-def-title>
            <note role="application">
              The functions that have an "M" in the fourth column are
              mandatory for this component, thus are restricted to the user, meaning that the
              administrator cannot manage those functions. The functions that have an "O" in the
              fourth column are optional and may be selected; and those functions with a "-" are not applicable and may not be selected. The ST author should select those
              security management functions that only the user may perform (i.e. the ones the
              administrator may not perform).
              <h:br/>
              <h:br/>
              The ST author may not select the
              same function in both FMT_MOF_EXT.1.1 and FMT_MOF_EXT.1.2. A function cannot contain
              an "M" in both column 4 and column 6.
              <h:br/>
              <h:br/>
              The ST author may use a table
              in the ST, indicating with clear demarcations (to be accompanied by an index) those
              functions that are restricted to the user (column 4). The ST author should iterate a
              row to indicate any variations in the selectable sub-functions or assigned values with
              respect to the values in the columns.
              <h:br/>
              <h:br/>
              For functions that are
              mandatory, any sub-functions not in a selection are also mandatory and any assignments
              must contain at least one assigned value. For non-selectable sub-functions in an
              optional function, all sub-functions outside a selection must be implemented in order
              for the function to be listed.
            </note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS describes those management functions that
                may only be performed by the user and confirm that the TSS does not include an
                Administrator API for any of these management functions. This activity will be
                performed in conjunction with FMT_SMF_EXT.1.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this element. <h:br/> <h:br/></Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-mof-restrict">
            <title>
              The TSF shall restrict the ability to perform the functions [<h:i>
                in column 6 of
                <xref to="fmt_smf"/>
              </h:i>] to the administrator when the device is enrolled and
              according to the administrator-configured policy.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall restrict the ability to perform the functions
                <assignable>reference to list of management functions</assignable>
                to the administrator when the device is enrolled and
                according to the administrator-configured policy.
              </title>
            </ext-comp-def-title>
            <note role="application">
              As long as the device is enrolled in management, the
              administrator (of the enterprise) must be guaranteed that minimum security functions
              of the enterprise policy are enforced. Further restrictive policies can be applied at
              any time by the user on behalf of the user or other administrators.
              <h:br/>
              <h:br/>
              The functions that have an "M" in the sixth column are mandatory for this component;
              the functions that have an "O" in the sixth column are optional and may be selected;
              and those functions with a "-" in the sixth are not applicable and may not be
              selected.
              <h:br/>
              <h:br/>
              The ST author may not select the same function in both
              FMT_MOF_EXT.1.1 and FMT_MOF_EXT.1.2.
              <h:br/>
              <h:br/>
              The ST author should select
              those security management functions that the administrator may restrict. The ST author
              may use a table in the ST, indicating with clear demarcations (to be accompanied by an
              index) those functions that are and are not implemented with APIs for the
              administrator (as in column 5). Additionally, the ST author should demarcate which
              functions the user is prevented from accessing or performing (as in column 6). The ST
              author should iterate a row to indicate any variations in the selectable sub-functions
              or assigned values with respect to the values in the columns.
              <h:br/>
              <h:br/>
              For
              functions that are mandatory, any sub-functions not in a selection are also mandatory
              and any assignments must contain at least one assigned value. For non-selectable
              sub-functions in an optional function, all sub-functions outside the selection must be
              implemented in order for the function to be listed.
            </note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS describes those management functions that
                may be performed by the Administrator, to include how the user is prevented from
                accessing, performing, or relaxing the function (if applicable), and how
                applications/APIs are prevented from modifying the Administrator configuration. The
                TSS also describes any functionality that is affected by administrator-configured
                policy and how. This activity will be performed in conjunction with
                FMT_SMF_EXT.1.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this element.<h:br/><h:br/></Guidance>
              <Tests>
                <testlist>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall use the test environment to deploy policies to Mobile Devices.</test>
                  <test>The evaluator shall create policies which collectively include all management functions which are controlled by the (enterprise) administrator and cannot be overridden/relaxed by the user as defined in FMT_MOF_EXT.1.2. The evaluator shall apply these policies to devices, attempt to override/relax each setting both as the user (if a setting is available) and as an application (if an API is available), and ensure that the TSF does not permit it. Note that the user may still apply a more restrictive policy than that of the administrator.</test>
                  <test>Additional testing of functions provided to the administrator are performed in conjunction with the testing activities for FMT_SMF_EXT.1.1.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FMT_SMF_EXT.1 Specification of Management Functions -->
        <f-component cc-id="fmt_smf_ext.1" id="fmt-smf-ext-1" name="Specification of Management Functions">
          <comp-lev> requires the TSF to define the management functions that it implements.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Initiation of policy update.</h:li>
              <h:li>Change of settings.</h:li>
              <h:li>Success or failure of function</h:li>
              <h:li>Initiation of software update.</h:li>
              <h:li>Initiation of application installation or update.</h:li>
            </h:ul>
          </audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-smf-ext">
            <title>
              The TSF shall be capable of performing the following management functions:
              <h:br/>
              <h:br/>
              <h:b>
                <ctr id="fmt_smf" ctr-type="Table">: Management Functions</ctr>
              </h:b>
              <h:br/>
              <h:br/>
              Status Markers:
              <h:br/>
              M - Mandatory
              <h:br/>
              O - Optional/Objective
              <h:br/>
              <management-function-set default="O">
                <manager cid="I">Impl.</manager>
                <manager cid="U">User Only</manager>
                <manager cid="A">Admin</manager>
                <manager cid="AO">Admin Only</manager>
                <management-function id="mf-pwd">
                  <text>configure password policy:  <h:ul><h:li>Minimum password length  </h:li>   <h:li>Minimum password complexity  </h:li>   <h:li>Maximum password lifetime  </h:li>  </h:ul></text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <M ref="AO"/>
                </management-function>
                <management-function id="mf-screenlock">
                  <text>configure session locking policy:  <h:ul><h:li>Screen-lock enabled/disabled  </h:li>   <h:li>Screen lock timeout  </h:li>   <h:li>Number of authentication failures  </h:li>  </h:ul></text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <M ref="AO"/>
                </management-function>
                <management-function id="mf-vpn">
                  <text>enable/disable the VPN protection:  <h:ul><h:li>Across device  </h:li>  </h:ul><selectables linebreak="yes"><selectable id="s-vpn-per-app">on a per-app basis</selectable><selectable id="s-vpn-per-appgroup">on a per-group of applications processes basis</selectable><selectable id="fmt_smf_ext.1.1_1" exclusive="yes">no other method</selectable></selectables></text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    <also ref-id="mf-audioVisual"/>
                    <also ref-id="mf-location"/>
                    <also ref-id="mf-audioVisual"/>
                    <also ref-id="mf-location"/>
                    Functions
                    <_/>
                    must be implemented on a device-wide basis but may also be
		  implemented on a per-app basis or on a per-group of applications basis in which the
		  configuration includes the list of applications or groups of applications to which the
		  enable/disable applies.
                  </app-note>
                  <app-note>
                    Function
                    <_/>
                    addresses
		  enabling and disabling the IPsec VPN only. The configuration of the VPN Client itself
		  (with information such as VPN Gateway, certificates, and algorithms) is addressed by
		  the
                    <xref to="mod-vpnclient"/>. The administrator options should only be listed if the
		  administrator can remotely enable/disable the VPN connection.
                    <h:p>
                      Function
                      <xref to="mf-vpn"/>
                      optionally allows the VPN to be configured per-app or
		  per-groups of apps. If this configuration is selected, it does not void FDP_IFC_EXT.1.
		  Instead FDP_IFC_EXT.1 is applied to the application or group of applications the VPN
		  is applied to. In other words, all traffic destined for the VPN-enabled application or
		  group of applications, must travel through the VPN, but traffic not destined for that
		  application or group of applications can travel outside the VPN. When the VPN is
		  configured across the device FDP_IFC_EXT.1 applies to all traffic and the VPN must not
		  split tunnel.
                    </h:p>
                  </app-note>
                </management-function>
                <management-function id="mf-radios">
                  <text>enable/disable <assignable>list of all radios</assignable></text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    The assignment in function
                    <_/>
                    consists of all radios present on the TSF, such as Wi-Fi, cellular, NFC,
              Bluetooth BR/EDR, and Bluetooth LE, which can be enabled and disabled.
	      In the future,
              if both Bluetooth BR/EDR and Bluetooth LE are supported, they will be required to be
              enabled and disabled separately. Disablement of the cellular radio does not imply that
              the radio may not be enabled in order to place emergency phone calls; however, it is
              not expected that a device in "airplane mode", where all radios are disabled, will
              automatically (without authorization) turn on the cellular radio to place emergency
              calls.
                  </app-note>
                </management-function>
                <management-function id="mf-audioVisual">
                  <text>enable/disable <assignable>list of audio or visual collection devices</assignable> :  <h:ul><h:li>Across device  </h:li>  </h:ul><selectables linebreak="yes"><selectable id="s-audiovisual-per-app">on a per-app basis</selectable><selectable id="s-audiovisual-per-appgroup">on a per-group of applications processes basis</selectable><selectable id="fmt_smf_ext.1.1_2" exclusive="yes">no other method</selectable></selectables></text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    The assignment in function
                    <_/>
                    consists of at least one audio or visual device, such as camera and microphone,
              which can be enabled and disabled by either the user or administrator. Disablement of
              the microphone does not imply that the microphone may not be enabled in order to place
              emergency phone calls. If certain devices are able to be restricted to the enterprise
              (either device-wide, per-app or per-group of applications) and others are able to be
              restricted to users, then this function should be iterated in the table with the
              appropriate table entries.
                    <h:p>
                      Regarding functions
                      <xref to="mf-radios"/>
                      and
                      <xref to="mf-audioVisual"/>,
		disablement of a particular
              radio or audio/visual device must be effective as soon as the TOE has power.
              Disablement must also apply when the TOE is booted into auxiliary boot modes, for
              example, associated with updates or backup. If the TOE supports states in which
              security management policy is inaccessible, for example, due to data-at-rest
              protection, it is acceptable to meet this requirement by ensuring that these devices
              are disabled by default while in these states. That these devices are disabled during
              auxiliary boot modes does not imply that the device (particularly the cellular radio)
              may not be enabled in order to perform emergency phone calls.
                    </h:p>
                  </app-note>
                </management-function>
                <management-function id="mf-lockState">
                  <text>transition to the locked state</text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <NA ref="AO"/>
                </management-function>
                <management-function id="mf-wipe">
                  <text>TSF wipe of protected data</text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <NA ref="AO"/>
                  <app-note>
                    Wipe  of the TSF (function
                    <xref to="mf-wipe"/>) is performed according to
		    FCS_CKM_EXT.5.
		    Protected data is all non-TSF data, including all user or enterprise data. Some or all
		  of this data may be considered sensitive data as well.
                  </app-note>
                </management-function>
                <management-function id="mf-appInstallRules">
                  <text>configure application installation policy by <selectables linebreak="yes"><selectable id="mf-appInstallRules-restrict">restricting the sources of applications</selectable><selectable id="mf-appInstallRules-specify">specifying a set of allowed applications based on <assignable>application characteristics</assignable> (an application allowlist)</selectable><selectable id="mf-appInstallRules-deny">denying installation of applications</selectable></selectables></text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <M ref="AO"/>
                  <app-note>
                    The
		    selection in function
                    <xref to="mf-appInstallRules"/>
                    allows the ST author to
		    select which mechanisms are available to the administrator through the MDM Agent to
		    restrict the applications which the user may install. The ST author must state if
		    application allowlist is applied device-wide or if it can be specified to apply to
		    either the Enterprise or Personal applications.
                    <h:ul>
                      <h:li>
                        If the administrator can restrict the sources from which applications can be
                    installed, the ST author selects "<xref to="mf-appInstallRules-restrict"/>".
                      </h:li>
                      <h:li>
                        If the administrator can specify a allowlist of allowed applications, the ST
                    author selects "<xref to="mf-appInstallRules-specify"/>". The ST author should list any application characteristics
                    (e.g. name, version, or developer) based on which the allowlist can be
                    formed.
                      </h:li>
                      <h:li>
                        If the administrator can prevent the user from installing additional
                    applications, the ST author selects "<xref to="mf-appInstallRules-deny"/>".
                      </h:li>
                    </h:ul>
                  </app-note>
                </management-function>
                <management-function id="mf-keyStorage">
                  <text>import keys or secrets into the secure key storage</text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <NA ref="AO"/>
                </management-function>
                <management-function id="mf-keyWipe">
                  <text>destroy imported keys or secrets and <selectables><selectable id="fmt_smf_ext.1.1_4" exclusive="yes">no other keys or secrets</selectable><selectable id="fmt_smf_ext.1.1_6"><assignable>list of other categories of keys or secrets</assignable></selectable></selectables> in the secure key storage</text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <NA ref="AO"/>
                </management-function>
                <management-function id="mf-certImport">
                  <text>import X.509v3 certificates into the Trust Anchor Database</text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <O ref="AO"/>
                </management-function>
                <management-function id="mf-certWipe">
                  <text>remove imported X.509v3 certificates and <selectables><selectable id="fmt_smf_ext.1.1_7" exclusive="yes">no other X.509v3 certificates</selectable><selectable id="fmt_smf_ext.1.1_9"><assignable>list of other categories of X.509v3 certificates</assignable></selectable></selectables> in the Trust Anchor Database</text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <NA ref="AO"/>
                  <app-note>
                    In the future, function
                    <xref to="mf-certWipe"/>
                    may require
              destruction or disabling of any default trusted CA certificates, excepting those CA
              certificates necessary for continued operation of the TSF, such as the developer’s
              certificate. At this time, the ST author must indicate in the assignment whether
              pre-installed or any other category of X.509v3 certificates may be removed from the
              Trust Anchor Database.
                  </app-note>
                </management-function>
                <management-function id="mf-enroll">
                  <text>enroll the TOE in management</text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    For function
                    <xref to="mf-enroll"/>, the
		      enrollment function may be installing an MDM agent and includes the policies to be
		      applied to the device. It is acceptable for the user approval notice to require the
		      user to intentionally opt to view the policies (for example, by "tapping" on a "View"
		      icon) rather than listing the policies in full in the notice.
                  </app-note>
                </management-function>
                <management-function id="mf-appRemove">
                  <text>remove applications</text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <O ref="AO"/>
                </management-function>
                <management-function id="mf-update">
                  <text>update system software</text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    For function
                    <xref to="mf-update"/>, the administrator capability to update the system
		      software may be limited to causing a prompt to the user to update rather than the
		      ability to initiate the update itself. As the administrator is likely to be acting
		      remotely, he/she would be unaware of inopportune situations, such as low power, which
		      may cause the update to fail and the device to become inoperable. The user can refuse
		      to accept the update in such situations. It is expected that system architects will be
		      cognizant of this limitation and will enforce network access controls in order to
		      enforce enterprise-critical updates.
                  </app-note>
                </management-function>
                <management-function id="mf-appInstall">
                  <text>install applications</text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-appInstall"/>
                    addresses both installation and update. This protection profile
              does not distinguish between installation and update of applications because mobile
              devices typically completely overwrite the previous installation with a new
              installation during an application update.
                  </app-note>
                </management-function>
                <management-function id="mf-entAppRemove">
                  <text>remove Enterprise applications</text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <NA ref="AO"/>
                  <app-note>
                    For function
                    <xref to="mf-entAppRemove"/>, "Enterprise applications" are those applications that belong
              to the Enterprise application group. Applications installed by the enterprise
              administrator (including automatic installation by the administrator after being
              requested by the user from a catalog of enterprise applications) are by default placed
              in the Enterprise application group unless an exception has been made in function
                    <xref to="mf-appGroups"/>
                    of FMT_SMF_EXT.1.1.
                  </app-note>
                </management-function>
                <management-function id="mf-notifications">
                  <text>enable/disable display notification in the locked state of: <selectables linebreak="yes"><selectable id="fmt_smf_ext.1.1_10">email notifications</selectable><selectable id="fmt_smf_ext.1.1_11">calendar appointments</selectable><selectable id="fmt_smf_ext.1.1_12">contact associated with phone call notification</selectable><selectable id="fmt_smf_ext.1.1_13">text message notification</selectable><selectable id="fmt_smf_ext.1.1_15"><assignable>other application-based notifications</assignable></selectable><selectable id="fmt_smf_ext.1.1_16">all notifications</selectable></selectables></text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    If the display
              of notifications in the locked state is supported, the configuration of these
              notifications (function
                    <xref to="mf-notifications"/>) must be included in the
              selection.
                  </app-note>
                </management-function>
                <management-function id="mf-dar">
                  <text>enable data-at rest protection</text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-dar"/>
                    must be included in the
		      selection if data-at-rest protection is not natively enabled.
                  </app-note>
                </management-function>
                <management-function id="mf-rmediaDar">
                  <text>enable removable media’s data-at-rest protection</text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-rmediaDar"/>
                    is implicitly met if the TSF does not support
		      removable media.
                  </app-note>
                </management-function>
                <management-function id="mf-location">
                  <text>enable/disable location services:  <h:ul><h:li>Across device  </h:li>  </h:ul><selectables linebreak="yes"><selectable id="mf-location-per_app">on a per-app basis</selectable><selectable id="fmt_smf_ext.1.1_17">on a per-group of applications processes basis</selectable><selectable id="fmt_smf_ext.1.1_18" exclusive="yes">no other method</selectable></selectables></text>
                  <M ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    For function
                    <xref to="mf-location"/>, location
              services include location information gathered from GPS, cellular, and Wi-Fi.
                  </app-note>
                </management-function>
                <management-function id="mf-authFactors">
                  <text>enable/disable the use of <selectables><selectable id="fmt_smf_ext.1.1_19">Biometric Authentication Factor</selectable><selectable id="fmt_smf_ext.1.1_20">Hybrid Authentication Factor</selectable></selectables></text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-authFactors"/>
                    must be included in the ST if the TOE contains a BAF. This selection must correspond with the selection made in
              FIA_UAU.5.1. If
                    <xref to="uau_biometric"/>
                    is selected in FIA_UAU.5.1, "Biometric Authentication Factor"
              must be selected and the user or admin must have the option to disable the use of
              it. If multiple BAFs are claimed in FIA_MBV_EXT.1.1 in the
                    <xref to="mod-biometrics"/>, this applies to all different
              modalities. If
                    <xref to="uau_hybr"/>
                    is selected in FIA_UAU.5.1 it must be selected and the user
              or admin must have the option to disable the use of it.
                  </app-note>
                </management-function>
                <management-function id="mf-certInvalid">
                  <text>configure whether to allow or disallow establishment of <assignable>configurable trusted channel in FTP_ITC_EXT.1.1 or FDP_UPC_EXT.1.1/APPS</assignable> if the peer or server certificate is deemed invalid.</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-certInvalid"/>
                    must be included in the ST if the function is configurable on the TOE for any of the trusted channels either mandated or selected in
                    <xref to="fel-wlan"/>
                    or
                    <xref to="fel-tls-app"/>. The configuration can be different depending on the specific trusted channel(s) and they must be filled in for the assignment.
                  </app-note>
                </management-function>
                <management-function id="mf-externalPorts">
                  <text>enable/disable all data signaling over <assignable>list of externally accessible hardware ports</assignable></text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    The assignment in function
                    <xref to="mf-externalPorts"/>
                    consists of all externally accessible hardware
              ports, such as USB, the SD card, and HDMI, whose data transfer capabilities can be
              enabled and disabled by either the user or administrator. Disablement of data transfer
              over an external port must be effective during and after boot into the normal
              operative mode of the device. If the TOE supports states in which configured security
              management policy is inaccessible, for example, due to data-at-rest protection, it is
              acceptable to meet this requirement by ensuring that data transfer is disabled by
              default while in these states. Each of the ports may be enabled or disabled
              separately. The configuration policy need not disable all ports together. In the case
              of USB, charging is still allowed if data transfer capabilities have been disabled.
                  </app-note>
                </management-function>
                <management-function id="mf-serverProtocols">
                  <text>enable/disable <assignable>list of protocols where the device acts as a server</assignable></text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    The assignment in function
                    <xref to="mf-serverProtocols"/>
                    consists of all protocols where the TSF acts as a server, which can be enabled and
              disabled by either the user or administrator.
                  </app-note>
                </management-function>
                <management-function id="mf-devModes">
                  <text>enable/disable developer modes</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-devModes"/>
                    must be included in the selection if developer modes are
		    supported by the TSF.
                  </app-note>
                </management-function>
                <management-function id="mf-authBypass">
                  <text>enable/disable bypass of local user authentication</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-authBypass"/>
                    must
              be included in the selection if bypass of local user authentication, such as a "Forgot
              Password", password hint, or remote authentication feature, is supported.
                  </app-note>
                </management-function>
                <management-function id="mf-wipeEntData">
                  <text>wipe Enterprise data</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <NA ref="AO"/>
                </management-function>
                <management-function id="mf-appCert">
                  <text>approve <selectables><selectable id="fmt_smf_ext.1.1_23">import</selectable><selectable id="fmt_smf_ext.1.1_24">removal</selectable></selectables> by applications of X.509v3 certificates in the Trust Anchor Database</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-appCert"/>
                    must be included in the
              selection if the TSF allows applications, other than the MDM Agents, to import or
              remove X.509v3 certificates from the Trust Anchor Database. The MDM Agent is
              considered the administrator. This function does not apply to applications trusting a
              certificate for its own validations. The function only applies to situations where the
              application modifies the device-wide Trust Anchor Database, affecting the validations
              performed by the TSF for other applications. The user or administrator may be provided
              the ability to globally allow or deny any application requests in order to meet this
              requirement.
                  </app-note>
                </management-function>
                <management-function id="mf-certValidity">
                  <text>configure whether to allow or disallow establishment of a trusted channel if the TSF cannot establish a connection to determine the validity of a certificate</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-certValidity"/>
                    must be
              included in the ST if "administrator is allowed to configure certificate acceptance" is selected in
              FIA_X509_EXT.2.2 in
                    <xref to="X509"/>
                  </app-note>
                </management-function>
                <management-function id="mf-cellular">
                  <text>enable/disable the cellular protocols used to connect to cellular network base stations</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                </management-function>
                <management-function id="mf-auditLogs">
                  <text>read audit logs kept by the TSF</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <NA ref="AO"/>
                </management-function>
                <management-function id="mf-digSign">
                  <text>configure <selectables><selectable id="fmt_smf_ext.1.1_25">certificate</selectable><selectable id="fmt_smf_ext.1.1_26">public-key</selectable></selectables> used to validate digital signature on applications</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-digSign"/>
                    should be
              included in the selection if FPT_TUD_EXT.5.1 is included in the ST and the
              configurable option is selected.
                  </app-note>
                </management-function>
                <management-function id="mf-sharedKeys">
                  <text>approve exceptions for shared use of keys or secrets by multiple applications</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-sharedKeys"/>
                    should be included in the selection if user or administrator is
		    selected in FCS_STG_EXT.1.4.
                  </app-note>
                </management-function>
                <management-function id="mf-keyWipeRules">
                  <text>approve exceptions for destruction of keys or secrets by applications that did not import the key or secret</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-keyWipeRules"/>
                    should be included in the selection if
                    <xref to="s-killkey-user"/>
                    or
                    <xref to="s-killkey-admin"/>
                    is selected in FCS_STG_EXT.1.5.
                  </app-note>
                </management-function>
                <management-function id="mf-unlockBanner">
                  <text>configure the unlock banner</text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note/>
                </management-function>
                <management-function id="mf-auditItems">
                  <text>configure the auditable items</text>
                  <O ref="I"/>
                  <NA ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <xref to="mf-auditItems"/>
                    must be included in the selection if FAU_SEL.1
				    is included in the ST.
                  </app-note>
                </management-function>
                <management-function id="mf-integ">
                  <text>retrieve TSF-software integrity verification values</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                </management-function>
                <management-function id="mf-USB">
                  <text>enable/disable <selectables linebreak="yes"><selectable id="s-usbstore">USB mass storage mode</selectable><selectable id="fmt_smf_ext.1.1_27">USB data transfer without user authentication</selectable><selectable id="fmt_smf_ext.1.1_28">USB data transfer without authentication of the connecting system</selectable></selectables></text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                </management-function>
                <management-function id="mf-backup">
                  <text>enable/disable backup of <selectables><selectable id="s-backup-all-apps">all applications</selectable><selectable id="s-backup-sel-apps">selected applications</selectable><selectable id="s-backup-sel-grps">selected groups of applications</selectable><selectable id="s-backup-cfg">configuration data</selectable></selectables> to <selectables><selectable id="fmt_smf_ext.1.1_29">locally connected system</selectable><selectable id="fmt_smf_ext.1.1_30">remote system</selectable></selectables></text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                </management-function>
                <management-function id="mf-hotspot">
                  <text>enable/disable <selectables linebreak="yes"><selectable id="fmt_smf_ext.1.1_31">Hotspot functionality authenticated by <selectables><selectable id="fmt_smf_ext.1.1_32">pre-shared key</selectable><selectable id="fmt_smf_ext.1.1_33">passcode</selectable><selectable id="fmt_smf_ext.1.1_34" exclusive="yes">no authentication</selectable></selectables> </selectable><selectable id="s-tether">USB tethering authenticated by <selectables><selectable id="fmt_smf_ext.1.1_35">pre-shared key</selectable><selectable id="fmt_smf_ext.1.1_36">passcode</selectable><selectable id="fmt_smf_ext.1.1_37" exclusive="yes">no authentication</selectable></selectables> </selectable></selectables></text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    For function
                    <xref to="mf-hotspot"/>,
              hotspot functionality refers to the condition in which the mobile device is serving as
              an access point to other devices, not the connection of the TOE to external hotspots.
                  </app-note>
                </management-function>
                <management-function id="mf-dataSharing">
                  <text>approve exceptions for sharing data between <selectables><selectable id="fmt_smf_ext.1.1_38">applications</selectable><selectable id="fmt_smf_ext.1.1_39">groups of applications</selectable></selectables></text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Functions
                    <xref to="mf-dataSharing"/>
                    and
                    <xref to="mf-appGroups"/>
                    correspond to FDP_ACF_EXT.1.2.
                  </app-note>
                </management-function>
                <management-function id="mf-appGroups">
                  <text>place applications into application groups based on <assignable>enterprise configuration settings</assignable></text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                </management-function>
                <management-function id="mf-unenroll">
                  <text>unenroll the TOE from management</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    For function
                    <xref to="mf-unenroll"/>, FMT_SMF_EXT.2.1 specifies actions to be performed when
		the TOE is unenrolled from management.
                  </app-note>
                </management-function>
                <management-function id="mf-alwaysOnVPN">
                  <text>enable/disable the Always On VPN protection:  <h:ul><h:li>Across device  </h:li>  </h:ul><selectables linebreak="yes"><selectable id="fmt_smf_ext.1.1_41">on a per-app basis</selectable><selectable id="fmt_smf_ext.1.1_42">on a per-group of applications processes basis</selectable><selectable id="fmt_smf_ext.1.1_43" exclusive="yes">no other method</selectable></selectables></text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                  <app-note>
                    Function
                    <_/>
                    must be included in the ST if IPsec is selected in
              FTP_ITC_EXT.1 and the native IPsec VPN client can be configured to be Always-On.
              Always-On is defined as when the TOE has a network connection the VPN attempts to
              connect, all data leaving the device uses the VPN when the VPN is connected and no
              data leaves that device when the VPN is disconnected. The configuration of the VPN
              Client itself (with information such as VPN Gateway, certificates, and algorithms) is
              addressed by the
                    <xref to="mod-vpnclient"/>.
                  </app-note>
                </management-function>
                <management-function id="mf-bioRevoke">
                  <text>revoke Biometric template</text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                </management-function>
                <management-function id="mf-other">
                  <text>
                    <assignable>list of other management functions to be provided by the TSF</assignable>
                  </text>
                  <O ref="I"/>
                  <O ref="U"/>
                  <O ref="A"/>
                  <O ref="AO"/>
                </management-function>
              </management-function-set>].
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall be capable of performing
                <assignable>list of management functions</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              <xref to="fmt_smf"/>
              compares the management functions required by this
              Protection Profile.
              <h:br/>
              <h:br/>
              The first column lists the management functions
              identified in the PP.
              <h:br/>
              <h:br/>
              In the following columns:
              <h:ul>
                <h:li>‘M’ means Mandatory</h:li>
                <h:li>‘O’ means Optional/Objective</h:li>
                <h:li>'-' means that no value (M or O) can be assigned</h:li>
              </h:ul>
              <h:br/>
              <h:br/>
              The third column ("Impl.") indicates whether the function is
              to be implemented. The ST author should select which Optional functions are
              implemented.
              <h:br/>
              <h:br/>
              The fourth column ("User Only") indicates functions
              that are to be restricted to the user (i.e. not available to the administrator).
              <h:br/>
              <h:br/>
              The fifth column ("Admin") indicates functions that are
              available to the administrator. The functions restricted to the user (column 4) cannot
              also be available to the administrator. Functions available to the administrator can
              still be available to the user, as long as the function is not restricted to the
              administrator (column 6). Thus, if the TOE must offer these functions to the
              administrator to perform, the fifth column must be selected.
              <h:br/>
              <h:br/>
              The
              sixth column (FMT_MOF_EXT.1.2) indicates whether the function is to be restricted to
              the administrator when the device is enrolled and the administrator applies the
              indicated policy. If the function is restricted to the administrator the function is
              not available to the user. This does not prevent the user from modifying a setting to
              make the function stricter, but the user cannot undo the configuration enforced by the
              administrator.
              <h:br/>
              <h:br/>
              The ST author may use a table in the ST, listing
              only those functions that are implemented. For functions that are mandatory, any
              sub-functions not in a selection are also mandatory and any assignments must contain
              at least one assigned value. For functions that are optional and contain an assignment
              or selection, at least one value must be assigned/selected to be included in the ST.
              For non-selectable sub-functions in an optional function, all sub-functions must be
              implemented in order for the function to be included. For functions with a "per-app
              basis" sub function and an assignment, the ST author must indicate which assigned
              features are manageable on a per-app basis and which are not by iterating the row.
              <h:br/>
              <h:br/>
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes all management functions, what
                roles can perform each function, and how these functions are (or can be)
                restricted to the roles identified by FMT_MOF_EXT.1.
                <h:br/>
                <h:br/>
                The
                following activities are organized according to the function number in the table.
                These activities include TSS Evaluation Activities, AGD Evaluation Activities, and
                test activities.
                <h:br/>
                <h:br/>
                Test activities specified below shall take place
                in the test environment described in the evaluation activity for FPT_TUD_EXT.1.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall consult the AGD guidance to perform each of the
                specified tests, iterating each test as necessary if both the user and administrator
                may perform the function. The evaluator shall verify that the AGD guidance describes
                how to perform each management function, including any configuration details. For
                each specified management function tested, the evaluator shall confirm that the
                underlying mechanism exhibits the configured setting.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation of policy update</audit-event-descr>
            <audit-event-info>Policy name</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Change of settings</audit-event-descr>
            <audit-event-info>Role of user that changed setting, Value of new setting</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Success or failure of function</audit-event-descr>
            <audit-event-info>Role of user that performed function, Function performed, Reason for failure</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Initiation of software update</audit-event-descr>
            <audit-event-info>Version of update</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Initiation of application installation or update</audit-event-descr>
            <audit-event-info>Name and version of application</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FMT_SMF_EXT.2 Specification of Remediation Actions -->
        <f-component cc-id="fmt_smf_ext.2" id="fmt-smf-ext-2" name="Specification of Remediation Actions">
          <comp-lev> requires the TSF to automatically perform specific management functions in response to a specific event.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul><h:li>Configuration of the functions that are performed in response to unenrollment event.</h:li></h:ul></management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST: <h:ul><h:li>Initiation of unenrollment.</h:li><h:li>Completion of unenrollment.</h:li></h:ul></audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fmt-smf-ext-acts">
            <title>The TSF shall offer  <selectables><selectable id="s-smf-wipe-pro">wipe of protected data</selectable><selectable id="s-smf-wipe-sen">wipe of sensitive data</selectable><selectable id="s-smf-ext-2-rem-ent-app">remove Enterprise applications</selectable><selectable id="fmt_smf_ext.2.1_1">remove all device-stored Enterprise resource data</selectable><selectable id="fmt_smf_ext.2.1_2">remove Enterprise secondary authentication data</selectable><selectable id="fmt_smf_ext.2.1_4"><assignable>list other available remediation actions</assignable></selectable></selectables>  upon unenrollment and  <selectables><selectable id="fmt_smf_ext.2.1_6"><assignable>other administrator-configured triggers</assignable></selectable><selectable id="fmt_smf_ext.2.1_7" exclusive="yes">no other triggers</selectable></selectables>.</title>
            <ext-comp-def-title>
              <title>
                The TSF shall offer
                <assignable>list of remediation actions</assignable>
                upon unenrollment and
                <assignable>list of triggers</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              Unenrollment may consist of removing the MDM agent or
              removing the administrator’s policies. The functions in the selection are remediation
              actions that TOE may provide (perhaps via APIs) to the administrator (perhaps via an MDM
              agent) that may be performed upon unenrollment. "Enterprise applications" refers to
              applications that are in the Enterprise application group. "Enterprise resource data"
              refers to all stored Enterprise data and the separate resources that are available to
              the Enterprise application group, per FDP_ACF_EXT.2.1. If FDP_ACF_EXT.2.1 is included
              in the ST, then "remove all device-stored Enterprise resource data" must be selected,
              and is defined to be all resources selected in FDP_ACF_EXT.2.1. If FIA_UAU_EXT.4.1 is
              included in the ST, then "remove Enterprise secondary authentication data" must be
              selected. If FIA_UAU_EXT.4.1 is not included in the ST, then "remove Enterprise
              secondary authentication data" cannot be selected. Enterprise secondary authentication
              data only refers to any data stored on the TOE that is specifically used as part of a
              secondary authentication mechanism to authenticate access to Enterprise applications
              and shared resources. Material that is used for the TOE’s primary authentication
              mechanism or other purposes not related to authentication to or protection of
              Enterprise applications or shared resources should not be removed.
              <h:br/>
              <h:br/>
              Protected data is all non-TSF data, including all user or enterprise data. Some or all
              of this data may be considered sensitive data as well.
			  If
              <xref to="s-smf-wipe-pro"/>
              is selected it is assumed that the sensitive data is wiped as well.
			  However, if
              <xref to="s-smf-wipe-sen"/>
              is selected, it does not imply that all non-TSF data (protected data)
              is wiped.
			  If
              <xref to="s-smf-wipe-pro"/>
              or
              <xref to="s-smf-wipe-sen"/>
              is selected the wipe  must be in accordance with FCS_CKM_EXT.5.1.
			  Thus cryptographically wiping the device is an acceptable remediation action.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes all available remediation
                actions, when they are available for use, and any other administrator-configured
                triggers. The evaluator shall verify that the TSS describes how the remediation
                actions are provided to the administrator.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>The evaluator shall use the test environment to iteratively configure the device to perform each remediation action in the selection. The evaluator shall configure the remediation action per how the TSS states it is provided to the administrator. The test environment could be an MDM agent application, but can also be an application with administrator access.</Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Unenrollment, Initiation of unenrollment</audit-event-descr>
            <audit-event-info>Identity of administrator Remediation action performed, failure of accepting command to unenroll</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FMT_SMF_EXT.3 Current Administrator -->
        <f-component cc-id="fmt_smf_ext.3" id="fmt-smf-ext-3" name="Current Administrator" status="objective">
          <comp-lev> requires the TSF to provide users with a list of administrators and their specified functions.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FMT_SMR.1 Security Roles</dependencies>
          <f-element id="fel-smf-curr-admin">
            <title>The TSF shall provide a mechanism that allows users to view a list of currently
              authorized administrators and the management functions that each administrator is
              authorized to perform.</title>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>The evaluator shall cause the TOE to be enrolled into management. The evaluator shall then invoke this mechanism and verify the ability to view that the device has been enrolled, and view the management functions that the administrator is authorized to perform.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </section>
      <!-- 5.1.6 Class: Protection of the TSF (FPT) -->
      <section id="fpt" title="Class: Protection of the TSF (FPT)">
        <ext-comp-def title="Anti-Exploitation Capabilities" fam-id="FPT_AEX_EXT">
          <fam-behavior>This family defines requirements for protecting against common types of software exploitation techniques.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Baseband Processing" fam-id="FPT_BBD_EXT">
          <fam-behavior>This family defines requirements for separation of baseband and application processor execution.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Limitation of Bluetooth Profile Support" fam-id="FPT_BLT_EXT">
          <fam-behavior>This family defines requirements for limiting Bluetooth capabilities without user action.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="JTAG Disablement" fam-id="FPT_JTA_EXT">
          <fam-behavior>This family defines requirements for JTAG interface access limitations.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Key Storage" fam-id="FPT_KST_EXT">
          <fam-behavior>This family defines requirements for protecting plaintext keys.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Self-Test Notification" fam-id="FPT_NOT_EXT">
          <fam-behavior>This family defines requirements for generation of notifications in response to completed self-tests.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="TSF Self Test" fam-id="FPT_TST_EXT">
          <fam-behavior>This family defines requirements for execution of self-tests that are not addressed by FPT_TST in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="TSF Updates" fam-id="FPT_TUD_EXT">
          <fam-behavior>This family defines requirements for trusted updates.</fam-behavior>
        </ext-comp-def>
        <!-- FPT_AEX_EXT.1 Application Address Space Layout Randomization -->
        <f-component cc-id="fpt_aex_ext.1" id="fpt-aex-ext-1" name="Application Address Space Layout Randomization">
          <comp-lev> requires the TSF to support address space layout randomization (ASLR).</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_RBG.1 Random Bit Generation</dependencies>
          <f-element id="fel-aslr">
            <title>The TSF shall provide address space layout randomization ASLR to applications.</title>
          </f-element>
          <f-element id="fel-aslr-size">
            <title>The base address of any user-space memory mapping will consist of at least 8
              unpredictable bits.</title>
            <note role="application">The 8 unpredictable bits may be provided by the TSF RBG (as
              specified in FCS_RBG.1) but is not required.</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS section of the ST describes how the 8
                bits are generated and provides a justification as to why those bits are
                unpredictable.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following test require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <h:br/>
                <testlist>
                  <test>The evaluator must select 3 apps included with the TSF. These must include any web browser or mail client included with the TSF. For each of these apps, the evaluator shall launch the same app on two separate Mobile Devices of the same type and compare all memory mapping locations. The evaluator must ensure that no memory mappings are placed in the same location on both devices. <h:br/>  <h:br/> If the rare (at most 1/256) chance occurs that two mappings are the same for a single app and not the same for the other two apps, the evaluator shall repeat the test with that app to verify that in the second test the mappings are different.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_AEX_EXT.2 Memory Page Permissions -->
        <f-component cc-id="fpt_aex_ext.2" id="fpt-aex-ext-2" name="Memory Page Permissions">
          <comp-lev> requires the TSF to enforce access permissions on physical memory.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-page-perms">
            <title>The TSF shall be able to enforce read, write, and execute permissions on every
              page of physical memory.</title>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS describes of the memory management unit
                (MMU), and ensures that this description documents the ability of the MMU to enforce
                read, write, and execute permissions on all pages of virtual memory.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_AEX_EXT.3 Stack Overflow Protection -->
        <f-component cc-id="fpt_aex_ext.3" id="fpt-aex-ext-3" name="Stack Overflow Protection">
          <comp-lev> requires the TSF to implement stack overflow protection.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-stack-protect">
            <title>TSF processes that execute in a non-privileged execution domain on the
              application processor shall implement stack-based buffer overflow protection.</title>
            <note role="application">A "non-privileged execution domain" refers to the user mode (as
              opposed to kernel mode, for instance) of the processor. While not all TSF processes
              must implement such protection, it is expected that most of the processes (to include
              libraries used by TSF processes) do implement buffer overflow protections.</note>
            <aactivity>
              <TSS>
                The evaluator shall determine that the TSS contains a description of stack-based
                buffer overflow protections implemented in the TSF software which runs in the
                non-privileged execution mode of the application processor. The exact implementation
                of stack-based buffer overflow protection will vary by platform. Example
                implementations may be activated through compiler options such as
                "-fstack-protector-all", "-fstack-protector", and "/GS" flags. The evaluator shall
                ensure that the TSS contains an inventory of TSF binaries and libraries, indicating
                those that implement stack-based buffer overflow protections as well as those that
                do not. The TSS must provide a rationale for those binaries and libraries that are
                not protected in this manner.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_AEX_EXT.4 Domain Isolation -->
        <f-component cc-id="fpt_aex_ext.4" id="fpt-aex-ext-4" name="Domain Isolation">
          <comp-lev> requires the TSF to protect itself from untrusted subjects and enforce address space isolation.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-self-protect">
            <title>The TSF shall protect itself from modification by untrusted subjects. </title>
          </f-element>
          <f-element id="fel-iso-appmem">
            <title>The TSF shall enforce isolation of address space between applications. </title>
            <note role="application">
              In addition to the TSF software (e.g., kernel image, device
              drivers, trusted applications) that resides in storage, the execution context (e.g.,
              address space, processor registers, per-process environment variables) of the software
              operating in a privileged mode of the processor (e.g., kernel), as well as the context
              of the trusted applications is to be protected. In addition to the software, any
              configuration information that controls or influences the behavior of the TSF is also
              to be protected from modification by untrusted subjects.
              <h:br/>
              <h:br/>
              Configuration information includes, but is not limited to, user and administrative
              management function settings, WLAN profiles, and Bluetooth data such as the
              service-level security requirements database.
              <h:br/>
              <h:br/>
              Untrusted subjects
              include untrusted applications; unauthorized users who have access to the device while
              powered off, in a screen-locked state, or when booted into auxiliary boot modes; and,
              unauthorized users or untrusted software or hardware which may have access to the
              device over a wired interface, either when the device is in a screen-locked state or
              booted into auxiliary boot modes.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS describes the mechanisms that are in
                place that prevents non-TSF software from modifying the TSF software or TSF data
                that governs the behavior of the TSF. These mechanisms could range from
                hardware-based means (e.g. "execution rings" and memory management functionality);
                to software-based means (e.g. boundary checking of inputs to APIs). The evaluator
                determines that the described mechanisms appear reasonable to protect the TSF from
                modification.
                <h:br/>
                <h:br/>
                The evaluator shall ensure the TSS describes how
                the TSF ensures that the address spaces of applications are kept separate from one
                another.
                <h:br/>
                <h:br/>
                The evaluator shall ensure the TSS details the USSD and
                MMI codes available from the dialer at the locked state or during auxiliary boot
                modes that may alter the behavior of the TSF. The evaluator shall ensure that this
                description includes the code, the action performed by the TSF, and a justification
                that the actions performed do not modify user or TSF data. If no USSD or MMI codes
                are available, the evaluator shall ensure that the TSS provides a description of the
                method by which actions prescribed by these codes are prevented.
                <h:br/>
                <h:br/>
                The evaluator shall ensure the TSS documents any TSF data (including software,
                execution context, configuration information, and audit logs) which may be accessed
                and modified over a wired interface in auxiliary boot modes. The evaluator shall
                ensure that the description includes data, which is modified in support of update or
                restore of the device. The evaluator shall ensure that this documentation includes
                the auxiliary boot modes in which the data may be modified, the methods for entering
                the auxiliary boot modes, the location of the data, the manner in which data may be
                modified, the data format and packaging necessary to support modification, and
                software or hardware tools, if any, which are necessary for modifying the data.
                <h:br/>
                <h:br/>
                The evaluator shall ensure that the TSS provides a description of
                the means by which unauthorized and undetected modification (that is, excluding
                cryptographically verified updates per FPT_TUD_EXT.2) of the TSF data over the wired
                interface in auxiliary boots modes is prevented. The lack of publicly available
                tools is not sufficient justification. Examples of sufficient justification include
                auditing of changes, cryptographic verification in the form of a digital signature
                or hash, disabling the auxiliary boot modes, and access control mechanisms that
                prevent writing to files or flashing partitions.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following tests require the vendor to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products. In addition, the vendor provides a list of files (e.g., system files, libraries, configuration files, audit logs) that make up the TSF data. This list could be organized by folders/directories (e.g., /usr/sbin, /etc), as well as individual files that may exist outside of the identified directories.
                <h:br/>
                <testlist>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall create and load an app onto the Mobile Device. This app shall attempt to traverse over all file systems and report any locations to which data can be written or overwritten. The evaluator must ensure that none of these locations are part of the OS software, device drivers, system and security configuration files, key material, or another untrusted application’s image/data. For example, it is acceptable for a trusted photo editor app to have access to the data created by the camera app, but a calculator application shall not have access to the pictures.</test>
                  <test>For each available auxiliary boot mode, the evaluator shall attempt to modify a TSF file of their choosing using the software or hardware tools described in the TSS. The evaluator shall verify that the modification fails.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_AEX_EXT.5 Kernel Address Space Layout Randomization -->
        <f-component cc-id="fpt_aex_ext.5" id="fpt-aex-ext-5" name="Kernel Address Space Layout Randomization" status="objective">
          <comp-lev> requires the TSF to provide ASLR to the kernel.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_RBG.1 Random Bit Generation (RBG)</dependencies>
          <f-element id="fel-kaslr">
            <title>The TSF shall provide address space layout randomization (ASLR) to the kernel.</title>
          </f-element>
          <f-element id="fel-kaslr-min">
            <title>
              The base address of any kernel-space memory mapping will consist of
              <assignable>number greater than or equal to 4</assignable>
              unpredictable bits.
            </title>
            <note role="application">The unpredictable bits may be provided by the TSF RBG (as
              specified in FCS_RBG.1).</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS section of the ST describes how the
                bits are generated and provides a justification as to why those bits are
                unpredictable.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following test require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <testlist>
                  <test>The evaluator shall reboot the TOE six times. For each of these reboots, the evaluator shall examine memory mapping locations of the kernel. The evaluator must ensure that for at least five reboots the memory mappings are not placed in the same location on both devices.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_AEX_EXT.6 Write or Execute Memory Page Permissions -->
        <f-component cc-id="fpt_aex_ext.6" id="fpt-aex-ext-6" name="Write or Execute Memory Page Permissions" status="objective">
          <comp-lev> requires the TSF to prevent physical memory from being both writable and executable.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-nx">
            <title>
              The TSF shall prevent write and execute permissions from being simultaneously
              granted to any page of physical memory
              <selectables>
                <selectable id="fpt_aex_ext.6.1_1">with no exceptions</selectable>
                <selectable id="fpt_aex_ext.6.1_3">
                  <assignable>specific exceptions</assignable>
                </selectable>
              </selectables>.
            </title>
            <note role="application">Memory used for just-in-time (JIT) compilation is anticipated
              as an exception in this requirement; if so, the ST author must address how this
              exception is permitted. It is expected that the memory management unit will transition
              the system to a non-operational state if any violation is detected in kernel memory
              space.</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS describes how the operating system of the
                application processor prevents all processes executing in a non-privileged execution
                domain from achieving write and execute permissions on any page of memory (with only
                specified exceptions). The evaluator shall ensure that the TSS describes how such
                processes are unable to request pages of memory with such permissions, and how they
                are unable to change permissions to both write and execute on any pages already
                allocated to them.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_AEX_EXT.7 Heap Overflow Protection -->
        <f-component cc-id="fpt_aex_ext.7" id="fpt-aex-ext-7" name="Heap Overflow Protection" status="objective">
          <comp-lev> requires the TSF to support heap-based buffer overflow protection. </comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-heap-protect">
            <title>The TSF shall include heap-based buffer overflow protections in the runtime
              environment it provides to processes that execute on the application
              processor.</title>
            <note role="application">These heap-based buffer overflow protections are expected to
              ensure the integrity of heap metadata such as memory addresses or offsets recorded by
              the heap implementation to manage memory blocks. This includes chunk headers,
              look-aside lists, and other data structures used to track the state and location of
              memory blocks managed by the heap.</note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS enumerates the heap implementations
                provided to userspace processes. The evaluator shall ensure that the TSS lists all
                types of heap metadata and identifies how the integrity of each type of metadata is
                ensured. The evaluator shall ensure that the TSS identifies all fields within each
                type of metadata and identifies how the integrity of these fields is ensured. The
                evaluator shall verify that the TSS identifies the manner in which an error
                condition is entered when a heap overflow is detected and the resulting actions
                taken by the TSF.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>For each heap implementation, the evaluator shall write, or the developer shall provide access to, an application, which allocates memory from the heap and then writes arbitrary data significantly beyond the end of the allocated buffer. The evaluator shall attempt to execute this application and verify that the write is not allowed.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_BBD_EXT.1 Application Processor Mediation -->
        <f-component cc-id="fpt_bbd_ext.1" id="fc-ap_med" name="Application Processor Mediation" status="objective">
          <comp-lev> requires the TSF to enforce separation between baseband and application processor execution except through application processor mechanisms. </comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-cpu-med">
            <title>The TSF shall prevent code executing on any baseband processor (BP) from
              accessing application processor (AP) resources except when mediated by the AP.</title>
            <note role="application">
              These resources include:
              <h:br/>
              <h:ul>
                <h:li>Volatile and non-volatile memory</h:li>
                <h:li>Control of and data from integrated and non-integrated peripherals (e.g. USB
                  controllers, touch screen controllers, LCD controller, codecs)</h:li>
                <h:li>Control of and data from integrated and non-integrated I/O sensors (e.g.
                  camera, light, microphone, GPS, accelerometers, geomagnetic field
                  sensors)</h:li>
              </h:ul>
              <h:br/>
              Mobile devices are becoming increasingly complex having an application
              processor that runs an operating system and user applications and separate
              baseband processors that handle cellular and other wireless network connectivity.
              <h:br/>
              <h:br/>
              <h:ul>
                <h:li>The application processor within most modern Mobile Devices is a system on a
                  chip (SoC) that integrates, for example, CPU/GPU cores and memory interface
                  electronics into a single, power-efficient package.</h:li>
                <h:li>Baseband processors are becoming increasingly complex themselves delivering
                  voice encoding alongside multiple independent radios (LTE, Wi-Fi, Bluetooth, FM,
                  GPS) in a single package containing multiple CPUs and DSPs.</h:li>
              </h:ul>
              <h:br/>
              Thus, the baseband processors in these requirements include such
              integrated SoCs and include any radio processors (integrated or not) on the Mobile
              Device.
              <h:br/>
              <h:br/>
              All other requirements mostly, except where noted, apply to
              firmware/software on the application processor, but future requirements (notably, all
              Integrity, Access Control, and Anti-Exploitation requirements) will apply to
              application processors and baseband processors.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS section of the ST describes at a high
                level how the processors on the Mobile Device interact, including which bus
                protocols they use to communicate, any other devices operating on that bus
                (peripherals and sensors), and identification of any shared resources. The evaluator
                shall verify that the design described in the TSS does not permit any BPs from
                accessing any of the peripherals and sensors or from accessing main memory (volatile
                and non-volatile) used by the AP. In particular, the evaluator shall ensure that the
                design prevents modification of executable memory of the AP by the BP.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_BLT_EXT.1 Limitation of Bluetooth Profile Support -->
        <f-component cc-id="fpt_blt_ext.1" id="fpt-blt-ext-1" name="Limitation of Bluetooth Profile Support" status="objective">
          <comp-lev> requires the TSF to maintain a disabled by default posture for Bluetooth profiles.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-bluetooth-stop">
            <title>
              The TSF shall disable support for
              <assignable>list of Bluetooth profiles</assignable>
              Bluetooth profiles when they are not currently being used by
              an application on the Mobile Device, and shall require explicit user action to enable
              them.
            </title>
            <note role="application">
              Some Bluetooth services incur more serious consequences if
              unauthorized remote devices gain access to them. Such services should be protected by
              measures like disabling support for the associated Bluetooth profile unless it is
              actively being used by an application on the Mobile Device (in order to prevent
              discovery by a Service Discovery Protocol search), and then requiring explicit user
              action to enable those profiles in order to use the services. It may be further
              appropriate to require additional user action before granting a remote device access
              to that service.
              <h:br/>
              <h:br/>
              For example, it may be appropriate to disable the
              OBEX Push Profile until a user on the Mobile Device pushes a button in an application
              indicating readiness to transfer an object. After completion of the object transfer,
              support for the OBEX profile should be suspended until the next time the user requests
              its use.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS lists all Bluetooth profiles that are
                disabled while not in use by an application and which need explicit user action in
                order to become enabled.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <h:br/>
                  <h:br/>
                  <test>While the service is not in active use by an application on the TOE, the evaluator shall attempt to discover a service associated with a "protected" Bluetooth profile (as specified by the requirement) on the TOE via a Service Discovery Protocol search. The evaluator shall verify that the service does not appear in the Service Discovery Protocol search results. Next, the evaluator shall attempt to gain remote access to the service from a device that does not currently have a trusted device relationship with the TOE. The evaluator shall verify that this attempt fails due to the unavailability of the service and profile.</test>
                  <test>The evaluator shall repeat Test 1 with a device that currently has a trusted device relationship with the TOE and verify that the same behavior is exhibited.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_FLS.1 Failure with Preservation of Secure State -->
        <f-component cc-id="fpt_fls.1" id="fpt-fls-1" name="Failure with Preservation of Secure State">
          <f-element id="fel-pres-sec-state">
            <title>
              The TSF shall preserve a secure state when the following types of failures occur: [<h:i>DRBG self-test failure</h:i>].
            </title>
            <note role="application">The intent of this requirement is to ensure that cryptographic services requiring random bit generation cannot be performed if a failure of a self-test defined in FPT_TST.1 occurs.</note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSF describes how the TOE enters an error state in the event of a DRBG self-test failure.</TSS>
              <Guidance>The evaluator shall verify that the guidance documentation describes the error state that results from a DRBG self-test failure and the actions that a user or administrator should take in response to attempt to resolve the error state.</Guidance>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_JTA_EXT.1 JTAG Disablement -->
        <f-component cc-id="fpt_jta_ext.1" id="fpt-jta-ext-1" name="JTAG Disablement">
          <comp-lev> requires the TSF to specify the mechanism used to restrict access to its JTAG interface. </comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-jtag">
            <title>The TSF shall  <selectables><selectable id="s-jtag-kill-hw">disable access through hardware</selectable><selectable id="s-jtag-control-key">control access by a signing key</selectable></selectables>  to JTAG. </title>
            <ext-comp-def-title>
              <title>
                The TSF shall
                <assignable>list access control mechanisms</assignable>
                to JTAG.
              </title>
            </ext-comp-def-title>
            <note role="application">This requirement means that access to JTAG must be disabled
              either through hardware or restricted through the use of a signing key.</note>
            <aactivity>
              <TSS>
                If
                <xref to="s-jtag-kill-hw"/>
                is selected:
                <h:br/>
                The evaluator shall
                examine the TSS to determine the location of the JTAG ports on the TSF, to include
                the order of the ports (i.e. Data In, Data Out, Clock, etc.).
                <h:br/>
                <h:br/>
                If
                <xref to="s-jtag-control-key"/>
                is selected:
                <h:br/>
                The evaluator shall examine
                the TSS to determine how access to the JTAG is controlled by a signing key. The
                evaluator shall examine the TSS to determine when the JTAG can be accessed, i.e.
                what has the access to the signing key.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests><h:b>Evaluation Activity Note:</h:b>The following test requires the developer to provide access to a test platform that provides the evaluator with chip level access. <h:br/> <h:br/>If <xref to="s-jtag-kill-hw"/> is selected: <h:br/>The evaluator shall connect a packet analyzer to the JTAG ports. The evaluator shall query the JTAG port for its device ID and confirm that the device ID cannot be retrieved. <h:br/> <h:br/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_KST_EXT.1 Key Storage -->
        <f-component cc-id="fpt_kst_ext.1" id="fpt-kst-ext-1" name="Key Storage">
          <comp-lev> requires the TSF to avoid storage of plaintext keys in readable memory. </comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-keystore-no-text">
            <title>The TSF shall not store any plaintext key material in readable non-volatile
              memory.</title>
            <note role="application">
              The intention of this requirement is that the TOE will not
              write plaintext keying material to persistent storage. For the purposes of this
              requirement, keying material refers to authentication data, passwords, secret/private
              symmetric keys, private asymmetric keys, data used to derive keys, etc. These values
              must be stored encrypted.
              <h:br/>
              <h:br/>
              This requirement also applies to any
              value derived from passwords. Thus, the TOE cannot store plaintext password hashes for
              comparison purposes before protected data is decrypted, and the TOE should use key
              derivation and decryption to verify the Password Authentication Factor.
              <h:br/>
              <h:br/>
              If
              <xref to="uau_hybr"/>
              is selected in FIA_UAU.5.1 keying
              material also refers to the PIN/password used as part of the hybrid authentication.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall consult the TSS section of the ST in performing the Evaluation
                Activities for this requirement.
                <h:br/>
                <h:br/>
                In performing their review, the
                evaluator shall determine that the TSS contains a description of the activities that
                happen on power-up and password authentication relating to the decryption of DEKs,
                stored keys, and data.
                <h:br/>
                <h:br/>
                The evaluator shall ensure that the
                description also covers how the cryptographic functions in the FCS requirements are
                being used to perform the encryption functions, including how the KEKs, DEKs, and
                stored keys are unwrapped, saved, and used by the TOE so as to prevent plaintext
                from being written to non-volatile storage. The evaluator shall ensure that the TSS
                describes, for each power-down scenario how the TOE ensures that all keys in
                non-volatile storage are not stored in plaintext.
                <h:br/>
                <h:br/>
                The evaluator
                shall ensure that the TSS describes how other functions available in the system
                (e.g., regeneration of the keys) ensure that no unencrypted key material is present
                in persistent storage.
                <h:br/>
                <h:br/>
                The evaluator shall review the TSS to
                determine that it makes a case that key material is not written unencrypted to the
                persistent storage.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_KST_EXT.2 No Key Transmission -->
        <f-component cc-id="fpt_kst_ext.2" id="fpt-kst-ext-2" name="No Key Transmission">
          <comp-lev> requires the TSF to prevent transmitting plaintext key material to the operational environment.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-keystore-no-tran">
            <title>The TSF shall not transmit any plaintext key material outside the security
              boundary of the TOE.</title>
            <note role="application">
              The intention of this requirement is to prevent the logging of
              plaintext key information to a service that transmits the information off-device. For
              the purposes of this requirement, key material refers to keys, passwords, and other
              material that is used to derive keys.
              <h:br/>
              <h:br/>
              If
              <xref to="uau_hybr"/>
              is selected in  FIA_UAU.5.1
	       keying material also refers to the PIN/password used as part of
              the hybrid authentication.
              <h:br/>
              <h:br/>
              In the future, this requirement will
              apply to symmetric and asymmetric private keys stored in the TOE secure key storage
              where applications are outside the boundary of the TOE. Thus, the TSF will be required
              to provide cryptographic key operations (signature, encryption, and decryption) on
              behalf of applications (FCS_SRV_EXT.2.1) that have access to those keys.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall consult the TSS section of the ST in performing the Evaluation
                Activities for this requirement. The evaluator shall ensure that the TSS describes
                the TOE security boundary. The cryptographic module may very well be a particular
                kernel module, the Operating System, the Application Processor, or up to the entire
                Mobile Device.
                <h:br/>
                <h:br/>
                In performing their review, the evaluator shall
                determine that the TSS contains a description of the activities that happen on
                power-up and password authentication relating to the decryption of DEKs, stored
                keys, and data.
                <h:br/>
                <h:br/>
                The evaluator shall ensure that the TSS describes
                how other functions available in the system (e.g., regeneration of the keys) ensure
                that no unencrypted key material is transmitted outside the security boundary of the
                TOE.
                <h:br/>
                <h:br/>
                The evaluator shall review the TSS to determine that it
                makes a case that key material is not transmitted outside the security boundary of
                the TOE.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_KST_EXT.3 No Plaintext Key Export -->
        <f-component cc-id="fpt_kst_ext.3" id="fpt-kst-ext-3" name="No Plaintext Key Export">
          <comp-lev> requires the TSF to prevent the export of plaintext keys.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-key-no-export">
            <title>The TSF shall ensure it is not possible for the TOE users to export plaintext
              keys.</title>
            <note role="application">Plaintext keys include DEKs, KEKs, and all keys stored in the
              secure key storage (FCS_STG_EXT.1). The intent of this requirement is to prevent the
              plaintext keys from being exported during a backup authorized by the TOE user or
              administrator.</note>
            <aactivity>
              <TSS>
                The ST author will provide a statement of their policy for handling and
                protecting keys. The evaluator shall check to ensure the TSS describes a policy in
                line with not exporting either plaintext DEKs, KEKs, or keys stored in the secure
                key storage.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_NOT_EXT.1 Self-Test Notification -->
        <f-component cc-id="fpt_not_ext.1" id="fpt-not-ext-1" name="Self-Test Notification">
          <comp-lev> requires the TSF to become non-operational when certain failures occur.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Measurement of TSF software.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            FPT_TST_EXT.1 TSF Cryptographic Functionality Testing
            <h:br/>
            FPT_TST_EXT.2 TSF Integrity Checking
          </dependencies>
          <f-element id="fel-selftest-trans">
            <title>The TSF shall transition to non-operational mode and  <selectables><selectable id="fpt_not_ext.1.1_1">log failures in the audit record</selectable><selectable id="fpt_not_ext.1.1_2">notify the administrator</selectable><selectable id="fpt_not_ext.1.1_4"><assignable>other actions</assignable></selectable><selectable id="fpt_not_ext.1.1_5" exclusive="yes">no other actions</selectable></selectables>  when the following types of failures occur: <h:ul><h:li>failures of the self-tests</h:li> <h:li>TSF software integrity verification failures</h:li> <h:li> <selectables><selectable id="fpt_not_ext.1.1_6" exclusive="yes">no other failures</selectable><selectable id="fpt_not_ext.1.1_8"><assignable>other failures</assignable></selectable></selectables></h:li></h:ul></title>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes critical failures that may
                occur and the actions to be taken upon these critical failures.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following test require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <testlist>
                  <test>The evaluator shall use a tool provided by the developer to modify files and processes in the system that correspond to critical failures specified in the second list. The evaluator shall verify that creating these critical failures causes the device to take the remediation actions specified in the first list.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>
              <selectables onlyone="yes">
                <selectable>Measurement of TSF software</selectable>
                <selectable>none</selectable>
              </selectables>
            </audit-event-descr>
            <audit-event-info>
              <selectables onlyone="yes">
                <selectable>Integrity verification value</selectable>
                <selectable>No additional information</selectable>
              </selectables>
            </audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_NOT_EXT.2 Software Integrity Verification -->
        <f-component cc-id="fpt_not_ext.2" id="fpt-not-ext-2" name="Software Integrity Verification" status="objective">
          <comp-lev> requires the TSF to generate and sign software integrity verification values.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Retrieval of TSF software integrity verification values.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_COP.1 Cryptographic Operation</dependencies>
          <f-element id="fel-selftest-notify">
            <title>The TSF shall  <selectables><selectable id="fpt_not_ext.2.1_1">audit</selectable><selectable id="fpt_not_ext.2.1_2">provide the administrator with</selectable></selectables>  TSF-software integrity verification values.</title>
            <note role="application">These notifications are typically called remote attestation and
              these integrity values are typically called measurements. The integrity values are
              calculated from hashes of critical memory and values, including executable code. The
              ST author must select whether these values are logged as a part of FAU_GEN.1.1 or are
              provided to the administrator.</note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS describes which critical memory is
                measured for these integrity values and how the measurement is performed (including
                which TOE software performs these generates these values, how that software accesses
                the critical memory, and which algorithms are used).
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                If the integrity values are provided to the administrator, the evaluator
                shall verify that the AGD guidance contains instructions for retrieving these values
                and information for interpreting them. For example, if multiple measurements are
                taken, what those measurements are and how changes to those values relate to changes
                in the device state.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following test may require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <h:br/>
                <h:br/>
                The evaluator shall repeat the following test for each measurement:
                <testlist>
                  <test>The evaluator shall boot the device in an approved state and record the measurement taken (either from the log or by using the administrative guidance to retrieve the value via an MDM Agent). The evaluator shall modify the critical memory or value that is measured. The evaluator shall boot the device and verify that the measurement changed.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-sign-integrity">
            <title>The TSF shall cryptographically sign all integrity verification values.</title>
            <note role="application">The intent of this requirement is to provide assurance to the
              administrator that the responses provided are from the TOE and have not been modified
              or spoofed by a man-in-the-middle such as a network-based adversary or a malicious MDM
              Agent.</note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS describes which key the TSF uses to sign
                the responses to queries and the certificate used to prove ownership of the key, and
                the method of associating the certificate with a particular device manufacturer and
                model.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                The evaluator shall perform the following test:
                <testlist>
                  <test>The evaluator shall write, or the developer shall provide, a management application that queries either the audit logs or the measurements. The evaluator shall verify that the responses to these queries are signed and verify the signatures against the TOE’s certificate.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_STM.1 Reliable Time Stamps -->
        <f-component cc-id="fpt_stm.1" id="fpt-stm-1" name="Reliable Time Stamps">
          <f-element id="fel-timestamp">
            <title>The TSF shall be able to provide reliable time stamps <h:b>for its own use</h:b>. </title>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to ensure that it lists each security
                function that makes use of time. The TSS provides a description of how the time is
                maintained and considered reliable in the context of each of the time related
                functions. This documentation must identify whether the TSF uses a NTP server or the
                carrier’s network time as the primary time sources.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator examines the operational guidance to ensure it describes how
                to set the time.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator uses the operational guide to set the time. The evaluator shall then use an available interface to observe that the time was set correctly.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_TST.1 TSF Self-Testing -->
        <f-component cc-id="fpt_tst.1" id="fpt-tst-1" name="TSF Self-Testing">
          <f-element id="fel-tsf-self-test">
            <title>
              The TSF shall run a suite of the following self-tests
              <selectables>
                <selectable id="fpt_tst.1.1_1">during initial start-up</selectable>
                <selectable id="fpt_tst.1.1_2">periodically during normal operation</selectable>
                <selectable id="fpt_tst.1.1_3">at the request of the authorized user</selectable>
                <selectable id="fpt_tst.1.1_4">at the conditions <assignable>conditions under which self-test should occur</assignable></selectable>
              </selectables>
              to demonstrate the correct operation of [<h:i>TSF DRBG specified in FCS_RBG.1</h:i>].
            </title>
          </f-element>
          <f-element id="fel-tsf-ver-int-data">
            <title>
              The TSF shall provide authorized users with the capability to verify the integrity of [<h:i>[DRBG seed/output data]</h:i>].
            </title>
          </f-element>
          <f-element id="fel-tsf-ver-int">
            <title>
              The TSF shall provide authorized users with the capability to verify the integrity of [<h:i>[TSF DRBG specified in FCS_RBG.1]</h:i>].
            </title>
            <note role="application">This SFR is a required dependency of FCS_RBG.1. It is intended to require that any DRBG implemented by the TOE undergo health testing to ensure that the random bit generation functionality has not been degraded. If the TSF supports multiple DRBGs, this SFR should be iterated to describe the self-test behavior for each.</note>
            <aactivity>
              <TSS>
                <h:p>The	evaluator shall examine the TSS to ensure that it details the self-tests that are run by the TSF along with how they are run. This description should include an outline of what the tests are actually doing. The evaluator shall ensure that the TSS makes an argument that the tests are sufficient to demonstrate that the DRBG is operating correctly.</h:p>
                <h:p>
                  Note that this information may also be placed in the entropy documentation specified by
                  <xref to="entropyappendix"/>.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>If a self-test can be executed at the request of an authorized user, the evaluator shall verify that the operational guidance provides instructions on how to execute that self-test.</h:p>
              </Guidance>
              <Tests>
                <h:p>For each self-test, the evaluator shall verify that evidence is produced that the self-test is executed when specified by FPT_TST.1.1.</h:p>
                <h:p>If a self-test can be executed at the request of an authorized user, the evaluator shall verify that following the steps documented in the operational guidance to perform the self-test will result in execution of the self-test.</h:p>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Execution of self-tests.</audit-event-descr>
            <audit-event-info>None.</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_TST_EXT.1 TSF Cryptographic Functionality Testing -->
        <f-component cc-id="fpt_tst_ext.1" id="fpt-tst-ext-1" name="TSF Cryptographic Functionality Testing">
          <comp-lev> requires the TSF to run self-test at start-up to verify correct operation. </comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Initiation of self-test.</h:li>
              <h:li>Failure of self-test.</h:li>
            </h:ul>
          </audit>
          <dependencies>FCS_COP.1 Cryptographic Operation</dependencies>
          <f-element id="fel-selftest-startup">
            <title>The TSF shall run a suite of self-tests during initial start-up (on power on) to
              demonstrate the correct operation of all cryptographic functionality.</title>
            <note role="application">
              This requirement may be met by performing known answer tests
              or pair-wise consistency tests. The self-tests must be performed before the
              cryptographic functionality is exercised (for example, during the initialization of a
              process that utilizes the functionality).
              <h:br/>
              <h:br/>
              The cryptographic
              functionality includes the cryptographic operations in FCS_COP, the key generation
              functions in FCS_CKM, and the random bit generation in FCS_RBG.1.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to ensure that it specifies the self-tests
                that are performed at start-up. This description must include an outline of the test
                procedures conducted by the TSF (e.g., rather than saying "memory is tested", a
                description similar to "memory is tested by writing a value to each memory location
                and reading it back to ensure it is identical to what was written" shall be used).
                The TSS must include any error states that they TSF may enter when self-tests fail,
                and the conditions and actions necessary to exit the error states and resume normal
                operation. The evaluator shall verify that the TSS indicates these self-tests are
                run at start-up automatically, and do not involve any inputs from or actions by the
                user or operator.
                <h:br/>
                <h:br/>
                The evaluator shall inspect the list of
                self-tests in the TSS and verify that it includes algorithm self-tests. The
                algorithm self-tests will typically be conducted using known answer tests.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>There are no test evaluation activities for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation of self-test</audit-event-descr>
          </audit-event>
          <audit-event>
            <audit-event-descr>Failure of self-test</audit-event-descr>
            <audit-event-info>
              <selectables onlyone="yes">
                <selectable>Algorithm that caused the failure</selectable>
                <selectable>No additional information</selectable>
              </selectables>
            </audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_TST_EXT.2 TSF Integrity Checking -->
        <f-component cc-id="fpt_tst_ext.2" id="fpt-tst-ext-2" name="TSF Integrity Checking" status="invisible">
          <comp-lev>requires the TSF to verify code and bootchain integrity is stored prior to execution by a
            designated key or hash.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Start-up of TOE.</h:li>
              <h:li>
                <selectables>
                  <selectable>Detected integrity violation</selectable>
                  <selectable>None</selectable>
                </selectables></h:li>
            </h:ul>
          </audit>
          <dependencies>FCS_COP.1 Cryptographic Operation</dependencies>
          <f-element id="fel-bootchain-stub">
            <title>
              The TSF shall verify the integrity of
              <assignable>TSF data</assignable>
              stored in mutable media 
              prior to its execution through the use of
              <assignable>cryptographic or immutable hardware mechanism</assignable>.
            </title>
            <aactivity>
              <no-tests/>
            </aactivity>
          </f-element>
        </f-component>
        <!-- FPT_TST_EXT.2/POSTKERNEL TSF Integrity Checking (Post-Kernel) -->
        <f-component cc-id="fpt_tst_ext.2" id="fpt-tst-ext-2-postkernel" name="TSF Integrity Checking (Post-Kernel)" iteration="POSTKERNEL" status="objective">
          <f-element id="fel-integrity-what">
            <title>The TSF shall verify the integrity of  <selectables><selectable id="s-all-exe">all executable code</selectable><selectable id="fpt_tst_ext.2.1_POSTKERNEL_2"><assignable>subset of executable code</assignable></selectable></selectables>  stored in mutable media prior to its execution through the use of  <selectables><selectable id="fpt_tst_ext.2.1_POSTKERNEL_3">a digital signature using an immutable hardware asymmetric key</selectable><selectable id="fpt_tst_ext.2.1_POSTKERNEL_4">an immutable hardware hash of an asymmetric key</selectable><selectable id="fpt_tst_ext.2.1_POSTKERNEL_5">an immutable hardware hash</selectable><selectable id="fpt_tst_ext.2.1_POSTKERNEL_6">a digital signature using a hardware-protected asymmetric key</selectable><selectable id="fpt_tst_ext.2.1_POSTKERNEL_7">hardware-protected hash</selectable></selectables>. </title>
            <note role="application">
              All executable code covered in this requirement is executed
              after the kernel is loaded.
              <h:br/>
              <h:br/>
              If "all executable code in mutable
              media" is verified, implementation in hardware or in read-only memory is a natural
              logical consequence.
              <h:br/>
              <h:br/>
              At this time, the verification of software
              executed on other processors stored in mutable media is not required; however, it may
              be added in the first assignment. If all executable code (including bootloaders,
              kernel, device drivers, pre-loaded applications, user-loaded applications, and
              libraries) is verified, "all executable code stored in mutable media" should be
              selected.
            </note>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>The evaluation activity shall be completed in conjunction with FPT_TST_EXT.2/PREKERNEL for all executable code specified.</Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>
              <selectables onlyone="yes">
                <selectable>Detected integrity violation</selectable>
                <selectable>none</selectable>
              </selectables>
            </audit-event-descr>
            <audit-event-info>
              <selectables onlyone="yes">
                <selectable>The TSF code file that cause the integrity violation</selectable>
                <selectable>No additional information</selectable>
              </selectables>
            </audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_TST_EXT.2/PREKERNEL TSF Integrity Checking (Pre-Kernel) -->
        <f-component cc-id="fpt_tst_ext.2" id="fpt-tst-ext-2-prekernel" name="TSF Integrity Checking (Pre-Kernel)" iteration="PREKERNEL">
          <f-element id="fel-bootchain">
            <title>The TSF shall verify the integrity of [<h:i>the bootchain up through the Application
              Processor OS kernel</h:i>] stored in mutable media prior to its execution through the use of  <selectables><selectable id="fpt_tst_ext.2.1_PREKERNEL_1">a digital signature using an immutable hardware asymmetric key</selectable><selectable id="fpt_tst_ext.2.1_PREKERNEL_2">an immutable hardware hash of an asymmetric key</selectable><selectable id="fpt_tst_ext.2.1_PREKERNEL_3">an immutable hardware hash</selectable><selectable id="fpt_tst_ext.2.1_PREKERNEL_4">a digital signature using a hardware-protected asymmetric key</selectable></selectables>. </title>
            <note role="application">
              The bootchain of the TSF is the sequence of firmware and
              software, including ROM, bootloaders, and kernel, which ultimately result in loading
              the kernel on the Application Processor, regardless of which processor executes that
              code. Executable code that would be loaded after the kernel is covered in
              FPT_TST_EXT.2/POSTKERNEL.
              <h:br/>
              <h:br/>
              In order to meet this requirement, the hardware
              protection may be transitive in nature: a hardware-protected public key, hash of an
              asymmetric key, or hash may be used to verify the mutable bootloader code which
              contains a key or hash used by the bootloader to verify the mutable OS kernel code,
              which contains a key or hash to verify the next layer of executable code, and so on.
              <h:br/>
              <h:br/>
              The cryptographic mechanism used to verify the (initial) mutable
              executable code must be protected, such as being implemented in hardware or in
              read-only memory (ROM).
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS section of the ST includes a description
                of the boot procedures, including a description of the entire bootchain, of the
                software for the TSF’s Application Processor. The evaluator shall ensure that before
                loading the bootloaders for the operating system and the kernel, all bootloaders
                and the kernel software itself is cryptographically verified. For each additional
                category of executable code verified before execution, the evaluator shall verify
                that the description in the TSS describes how that software is cryptographically
                verified.
                <h:br/>
                <h:br/>
                The evaluator shall verify that the TSS contains a
                justification for the protection of the cryptographic key or hash, preventing it
                from being modified by unverified or unauthenticated software. The evaluator shall
                verify that the TSS contains a description of the protection afforded to the
                mechanism performing the cryptographic verification.
                <h:br/>
                <h:br/>
                The
                evaluator shall verify that the TSS describes each auxiliary boot mode available on
                the TOE during the boot procedures. The evaluator shall verify that, for each
                auxiliary boot mode, a description of the cryptographic integrity of the executed
                code through the kernel is verified before each execution.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following tests require the vendor to provide access to a test platform that provides the evaluator with tools that are typically not found on consumer Mobile Device products.
                <h:br/>
                <h:br/>
                The evaluator shall perform the following tests:
                <testlist>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall perform actions to cause TSF software to load and observe that the integrity mechanism does not flag any executables as containing integrity errors and that the TOE properly boots.</test>
                  <test>The evaluator shall modify a TSF executable that is integrity protected and cause that executable to be successfully loaded by the TSF. The evaluator observes that an integrity violation is triggered and the TOE does not boot. (Care must be taken so that the integrity violation is determined to be the cause of the failure to load the module, and not the fact that the module was modified so that it was rendered unable to run because its format was corrupt).</test>
                  <test>[conditional] If the ST author indicates that the integrity verification is performed using a public key, the evaluator shall verify that the update mechanism includes a certificate validation according to FIA_X509_EXT.1 as defined in <xref to="X509"/>. The evaluator shall digitally sign the TSF executable with a certificate that does not have the Code Signing purpose in the extendedKeyUsage field and verify that an integrity violation is triggered. The evaluator shall repeat the test using a certificate that contains the Code Signing purpose and verify that the integrity verification succeeds. Ideally, the two certificates should be identical except for the extendedKeyUsage field.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Start-up of TOE</audit-event-descr>
          </audit-event>
          <audit-event>
            <audit-event-descr>
              <selectables onlyone="yes">
                <selectable>Detected integrity violation</selectable>
                <selectable>none</selectable>
              </selectables>
            </audit-event-descr>
            <audit-event-info>
              <selectables onlyone="yes">
                <selectable>The TSF code file that caused the integrity violation</selectable>
                <selectable>No additional information</selectable>
              </selectables>
            </audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_TST_EXT.3 TSF Integrity Testing -->
        <f-component cc-id="fpt_tst_ext.3" id="fpt-tst-ext-3" name="TSF Integrity Testing" status="sel-based">
          <depends on-sel="x509-integrity"/>
          <comp-lev> requires the TSF to validate a code signing certificate before the associated code is executed.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FPT_TST_EXT.2 TSF Integrity Checking
            <h:br/>
            FIA_X509_EXT.1 X.509 Validation of Certificates
            <h:br/>
            FIA_X509_EXT.2 X.509 Certificate Authentication
          </dependencies>
          <f-element id="fel-integrity-fail">
            <title>The TSF shall not execute code if the code signing certificate is deemed invalid. </title>
            <note role="application">
              Certificates may optionally be used for code signing for
            integrity verification (FPT_TST_EXT.2.1/PREKERNEL).
            If "code signing for software integrity testing" is selected in FIA_X509_EXT.2.1 in
              <xref to="X509"/>, FPT_TST_EXT.3.1 must be included in the
            ST.
              <h:br/>
              <h:br/>
              Validity is determined by the certificate path, the expiration
            date, and the revocation status in accordance with RFC 5280.
            </note>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>Testing for this component is performed in conjunction with the Evaluation Activities for FPT_TST_EXT.2.1/PREKERNEL.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_TUD_EXT.1 TSF Version Query -->
        <f-component cc-id="fpt_tud_ext.1" id="fpt-tud-ext-1" name="TSF Version Query">
          <comp-lev> requires the TSF to provide authorized users the ability to query the version of the TOE hardware, TOE software, and installed applications.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FMT_SMR.1 Security Roles</dependencies>
          <f-element id="fel-get-software-version">
            <title>The TSF shall provide authorized users the ability to query the current version
              of the TOE firmware/software.</title>
          </f-element>
          <f-element id="fel-get-hardware-version">
            <title>The TSF shall provide authorized users the ability to query the current version
              of the hardware model of the device.</title>
            <note role="application">The current version of the hardware model of the device is an
              identifier that is sufficient to indicate (in tandem with manufacturer documentation)
              the hardware which comprises the device.</note>
          </f-element>
          <f-element id="fel-get-app-version">
            <title>The TSF shall provide authorized users the ability to query the current version
              of installed mobile applications.</title>
            <note role="application">The current version of mobile applications is the name and
              published version number of each installed mobile application.</note>
            <aactivity>
              The evaluator shall establish a test environment consisting of the Mobile
              Device and any supporting software that demonstrates usage of the management
              functions. This can be test software from the developer, a reference implementation of
              management software from the developer, or other commercially available software. The
              evaluator shall set up the Mobile Device and the other software to exercise the
              management functions according to the provided guidance documentation.
              <h:br/>
              <h:br/>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <testlist>
                  <test>Using the AGD guidance provided, the evaluator shall test that the administrator and user can query: <h:ul><h:li>The current version of the TSF operating system and any firmware that
                        can be updated separately</h:li> <h:li>The hardware model of the TSF</h:li> <h:li>The current version of all installed mobile applications</h:li></h:ul></test>
                </testlist>
                The evaluator must review manufacturer documentation to ensure that the hardware model identifier is sufficient to identify the hardware which comprises the device.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_TUD_EXT.2 TSF Update Verification -->
        <f-component cc-id="fpt_tud_ext.2" id="fpt-tud-ext-2" name="TSF Update Verification">
          <comp-lev> requires the TSF to ensure that system software updates are digitally signed prior to installation.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Updating of system software.</h:li>
            </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Success or failure of signature verification for applications.</h:li>
            </h:ul>
          </audit>
          <dependencies>FCS_COP.1 Cryptographic Operation</dependencies>
          <f-element id="fel-updates-verify">
            <title>
              The TSF shall verify software updates to the Application Processor system
              software and
              <selectables>
                <selectable id="fpt_tud_ext.2.1_2">
                  <assignable>other processor system software</assignable>
                </selectable>
                <selectable id="fpt_tud_ext.2.1_3">no other processor system software</selectable>
              </selectables>
              using a digital signature verified by the manufacturer trusted key
              prior to installing those updates.
            </title>
            <note role="application">
              The digital signature mechanism is implemented in accordance
              with FCS_COP.1.1/SIGN.
              <h:br/>
              <h:br/>
              At this time, this requirement does not
              require verification of software updates to the software operating outside the
              Application Processor.
              <h:br/>
              <h:br/>
              Any change, via a supported mechanism, to
              software residing in non-volatile storage is deemed a software update. Thus, this
              requirement applies to TSF software updates regardless of how the software arrives or
              is delivered to the device. This includes over-the-air (OTA) updates as well as
              partition images containing software which may be delivered to the device over a wired
              interface.
            </note>
          </f-element>
          <f-element id="fel-boot-key-update">
            <title>The TSF shall  <selectables><selectable id="fpt_tud_ext.2.2_1">never update</selectable><selectable id="fpt_tud_ext.2.2_2">update only by verified software</selectable></selectables>  the TSF boot integrity  <selectables><selectable id="fpt_tud_ext.2.2_3">key</selectable><selectable id="fpt_tud_ext.2.2_4">hash</selectable></selectables>.</title>
            <note role="application">The key or hash updated via this requirement is used for
              verifying software before execution in FPT_TST_EXT.2/PREKERNEL. The key or hash is verified
              as a part of the digital signature on an update, and the software which performs the
              update of the key or hash is verified by FPT_TST_EXT.2/PREKERNEL.</note>
          </f-element>
          <f-element id="fel-update-key-verify">
            <title>
              The TSF shall verify that the digital signature verification key used for TSF
              updates
              <selectables>
                <selectable id="fpt_tud_ext.2.3_1">is validated to a public key in the Trust Anchor Database</selectable>
                <selectable id="fpt_tud_ext.2.3_2">matches an immutable hardware public key</selectable>
              </selectables>.
            </title>
            <note role="application">
              The ST author must indicate the method by which the signing
              key for system software updates is limited and, if selected in FPT_TUD_EXT.2.3, must
              indicate how this signing key is protected by the hardware.
              <h:br/>
              <h:br/>
              If
              certificates are used, certificates are validated for the purpose of software updates
              in accordance with FIA_X509_EXT.1 in
              <xref to="X509"/>
              and should be selected in FIA_X509_EXT.2.1 in
              <xref to="X509"/>.
              Additionally, FPT_TUD_EXT.4 must be included in the ST.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS section of the ST describes all TSF
                software update mechanisms for updating the system software. The evaluator shall
                verify that the description includes a digital signature verification of the
                software before installation and that installation fails if the verification fails.
                The evaluator shall verify that all software and firmware involved in updating the
                TSF is described and, if multiple stages and software are indicated, that the
                software/firmware responsible for each stage is indicated and that the stages
                which perform signature verification of the update are identified.
                <h:br/>
                <h:br/>
                The evaluator shall verify that the TSS describes the method by
                which the digital signature is verified and that the public key used to verify the
                signature is either hardware-protected or is validated to chain to a public key in
                the Trust Anchor Database. If hardware-protection is selected, the evaluator shall
                verify that the method of hardware-protection is described and that the ST author
                has justified why the public key may not be modified by unauthorized parties.
                <h:br/>
                <h:br/>
                [conditional] If the ST author indicates that software updates to
                system software running on other processors is verified, the evaluator shall verify
                that these other processors are listed in the TSS and that the description includes
                the software update mechanism for these processors, if different than the update
                mechanism for the software executing on the Application Processor.
                <h:br/>
                <h:br/>
                [conditional] If the ST author indicates that the public key is
                used for software update digital signature verification, the evaluator shall verify
                that the update mechanism includes a certificate validation according to
                FIA_X509_EXT.1 and a check for the Code Signing purpose in the extendedKeyUsage.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                The evaluator shall verify that the developer has provided evidence that the following tests were performed for each available update mechanism:
                <testlist>
                  <test>The tester shall try to install an update without the digital signature and shall verify that installation fails. The tester shall attempt to install an update with digital signature, and verify that installation succeeds. <h:br/></test>
                  <test>The tester shall digitally sign the update with a key disallowed by the device and verify that installation fails. The tester shall attempt to install an update signed with the allowed key and verify that installation succeeds. <h:br/></test>
                  <test>[conditional] The tester shall digitally sign the update with an invalid certificate and verify that update installation fails. The tester attempt to install an update that was digitally signed using a valid certificate and a certificate that contains the purpose and verify that the update installation succeeds. <h:br/></test>
                  <test>[conditional] The tester shall repeat these test for the software executing on each processor listed in the first selection. The tester shall attempt to install an update without the digital signature and shall verify that installation fails. The tester shall attempt to install an update with digital signature, and verify that installation succeeds.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Success or failure of signature verification for software updates</audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FPT_TUD_EXT.3 Application Signing -->
        <f-component cc-id="fpt_tud_ext.3" id="fpt-tud-ext-3" name="Application Signing">
          <comp-lev> requires the TSF to ensure that application software updates are digitally signed prior to installation.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Success or failure of signature verification for applications.</h:li>
            </h:ul>
          </audit>
          <dependencies>FCS_COP.1 Cryptographic Operation</dependencies>
          <f-element id="fel-update-app-verify">
            <title>The TSF shall verify mobile application software using a digital signature
              mechanism prior to installation.</title>
            <note role="application">
              This requirement does not necessitate an X.509v3 certificate or
              certificate validation. X.509v3 certificates and certificate validation are addressed
              in
              <xref to="fel-app-verify-how"/>.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes how mobile application software
                is verified at installation. The evaluator shall ensure that this method uses a
                digital signature.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <h:b>Evaluation Activity Note:</h:b>
                The following test does not have to be tested using the commercial application store.
                <h:br/>
                <h:br/>
                <testlist>
                  <test>The evaluator shall write, or the developer shall provide access to, an application. The evaluator shall try to install this application without a digitally signature and shall verify that installation fails. The evaluator shall attempt to install a digitally signed application, and verify that installation succeeds.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Success or failure of signature verification for applications</audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FPT_TUD_EXT.4 Trusted Update Verification -->
        <f-component cc-id="fpt_tud_ext.4" id="fpt-tud-ext-4" name="Trusted Update Verification" status="sel-based">
          <depends on-sel="x509-updates"/>
          <depends on-sel="x509-other-uses"/>
          <comp-lev> requires the TSF to enforce validity of system software’s code signing certificate prior to installation.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FIA_X509_EXT.1 X.509 Validation of Certificates
            <h:br/>
            FIA_X509_EXT.2 X.509 Certificate Authentication
          </dependencies>
          <f-element id="fel-update-int-fail">
            <title>The TSF shall not install code if the code signing certificate is deemed invalid. </title>
            <note role="application">
              Certificates may optionally be used for code signing of system
              software updates (FPT_TUD_EXT.2.3) and of mobile applications (<xref to="fel-app-verify-how"/>). This
              element must be included in the ST if certificates are used for either update element.
              If "code signing for system software updates" is selected or the assignment is selected and specifies the use of 
              X.509 in code signing for mobile
              applications in FIA_X509_EXT.2.1 in
              <xref to="X509"/>,
	      FPT_TUD_EXT.4 must be included in the
              ST.
              <h:br/>
              <h:br/>
              Validity is determined by the certificate path, the expiration
              date, and the revocation status in accordance with RFC 5280.
            </note>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>Testing for this component is performed in conjunction with the Evaluation Activities for FPT_TUD_EXT.2 and FPT_TUD_EXT.5.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_TUD_EXT.5 Application Verification -->
        <f-component cc-id="fpt_tud_ext.5" id="fc-crypt-veri" name="Application Verification" status="objective">
          <comp-lev> requires the TSF to enforce validity of application software’s code signing certificate prior to installation.</comp-lev>
          <management>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Configure certificate or public key used to validate digital signature on applications.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FIA_X509_EXT.1 X.509 Validation of Certificates
            <h:br/>
            FIA_X509_EXT.2 X.509 Certificate Authentication
          </dependencies>
          <f-element id="fel-app-verify-how">
            <title>
              The TSF shall by default only install mobile applications cryptographically
              verified by
              <selectables>
                <selectable id="fpt_tud_ext.5.1_1">a built-in X.509v3 certificate</selectable>
                <selectable id="fpt_tud_ext.5.1_2">a configured X.509v3 certificate</selectable>
              </selectables>.
            </title>
            <note role="application">
              The built-in certificate is installed by the manufacturer
              either at time of manufacture or as a part of system updates. The configured
              certificate used to verify the signature is set according to FMT_SMF_EXT.1 function
              <xref to="mf-digSign"/>.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes how mobile application software
                is verified at installation. The evaluator shall ensure that this method uses a
                digital signature by a code signing certificate.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                <testlist>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall write, or the developer shall provide access to, an application. The evaluator shall try to install this application without a digitally signature and shall verify that installation fails. The evaluator shall attempt to install an application digitally signed with an appropriate certificate, and verify that installation succeeds.</test>
                  <test>The evaluator shall digitally sign the application with an invalid certificate and verify that application installation fails. The evaluator shall digitally sign the application with a certificate that does not have the Code Signing purpose and verify that application installation fails. This test may be performed in conjunction with the Evaluation Activities for FIA_X509_EXT.1 as defined in <xref to="X509"/>.</test>
                  <test>If necessary, the evaluator shall configure the device to limit the public keys that can sign application software according to the AGD guidance. The evaluator shall digitally sign the application with a certificate disallowed by the device or configuration and verify that application installation fails. The evaluator shall attempt to install an application digitally signed with an authorized certificate and verify that application installation succeeds.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_TUD_EXT.6 Trusted Update Verification -->
        <f-component cc-id="fpt_tud_ext.6" id="fpt-tud-ext-6" name="Trusted Update Verification" status="objective">
          <comp-lev> requires the TSF to prevent the intentional rollback of software updates. </comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-updates-inc-version">
            <title>The TSF shall verify that software updates to the TSF are a current or later
              version than the current version of the TSF.</title>
            <note role="application">A later version has a larger version number. The method for
              distinguishing newer software versions from older versions is determined by the
              manufacturer.</note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes the mechanism that prevents the
                TSF from installing software updates that are an older version that the currently
                installed version.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                The evaluator shall repeat the following tests to cover all allowed software update mechanisms as described in the TSS. For example, if the update mechanism replaces an entire partition containing many separate code files, the evaluator does not need to repeat the test for each individual file.
                <testlist>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall attempt to install an earlier version of software (as determined by the manufacturer). The evaluator shall verify that this attempt fails by checking the version identifiers or cryptographic hashes of the privileged software against those previously recorded and checking that the values have not changed.</test>
                  <test>The evaluator shall attempt to install a current or later version and shall verify that the update succeeds.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </section>
      <!-- 5.1.7 Class: TOE Access (FTA) -->
      <section id="fta" title="Class: TOE Access (FTA)">
        <ext-comp-def title="Session Locking and Termination" fam-id="FTA_SSL_EXT">
          <fam-behavior>This family defines requirements for session locking capabilities that are not addressed by FTA_SSL in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <!-- FTA_SSL_EXT.1 TSF- and User-initiated Locked State  -->
        <f-component cc-id="fta_ssl_ext.1" id="fta-ssl-ext-1" name="TSF- and User-initiated Locked State ">
          <comp-lev> requires the TSF to manage the transition to a locked state and what operations can be performed. </comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Configuring session locking policy.</h:li>
              <h:li>Transitioning to the locked state.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FMT_SMR.1 Security Roles
            <h:br/>
            FPT_STM.1 Reliable Time Stamps
          </dependencies>
          <f-element id="fel-time-lock">
            <title>The TSF shall transition to a locked state after a time interval of inactivity.</title>
          </f-element>
          <f-element id="fel-user-lock">
            <title>The TSF shall transition to a locked state after initiation by either the user or
              the administrator.</title>
          </f-element>
          <f-element id="fel-lock-what">
            <title>
              The TSF shall, upon transitioning to the locked state, perform the following
              operations:
              <h:ul>
                <h:li>Clearing or overwriting display devices, obscuring the previous contents; </h:li>
                <h:li><assignable>Other actions performed upon transitioning to the locked state</assignable>.</h:li>
              </h:ul>
            </title>
            <note role="application">
              The time interval of inactivity is configured using FMT_SMF_EXT.1 function
              <xref to="mf-screenlock"/>. The user/administrator-initiated lock is specified in FMT_SMF_EXT.1 function
              <xref to="mf-lockState"/>.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify the TSS describes the actions performed upon
                transitioning to the locked state.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluation shall verify that the AGD guidance describes the method of
                setting the inactivity interval and of commanding a lock. The evaluator shall verify
                that the TSS describes the information allowed to be displayed to unauthorized
                users.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall configure the TSF to transition to the locked state after a time of inactivity (FMT_SMF_EXT.1) according to the AGD guidance. The evaluator shall wait until the TSF locks and verify that the display is cleared or overwritten and that the only actions allowed in the locked state are unlocking the session and those actions specified in FIA_UAU_EXT.2.</test>
                  <test>The evaluator shall command the TSF to transition to the locked state according to the AGD guidance as both the user and the administrator. The evaluator shall wait until the TSF locks and verify that the display is cleared or overwritten and that the only actions allowed in the locked state are unlocking the session and those actions specified in FIA_UAU_EXT.2.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FTA_TAB.1 Default TOE Access Banners -->
        <f-component cc-id="fta_tab.1" id="fc-banner" name="Default TOE Access Banners">
          <f-element id="fel-banner">
            <title>
              Before establishing a user session, the [<h:i>TSF</h:i>] shall display an
              [<h:i>advisory warning</h:i>] message
              <h:b>regarding unauthorized use of the TOE</h:b>.
            </title>
            <note role="application">
              This requirement may be met with the configuration of either
              text or an image containing the text of the desired message. The TSF must minimally
              display this information at startup, but may also display the information at every
              unlock. The banner is configured according to FMT_SMF_EXT.1 function
              <xref to="mf-unlockBanner"/>.
            </note>
            <aactivity>
              <TSS>The TSS shall describe when the banner is displayed.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                The evaluator shall also perform the following test:
                <testlist>
                  <test>The evaluator follows the operational guidance to configure a notice and consent warning message. The evaluator shall then start up or unlock the TSF. The evaluator shall verify that the notice and consent warning message is displayed in each instance described in the TSS.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </section>
      <!-- 5.1.8 Class: Trusted Path/Channels (FTP) -->
      <section id="ftp" title="Class: Trusted Path/Channels (FTP)">
        <ext-comp-def title="Inter-TSF Trusted Channel" fam-id="FTP_ITC_EXT">
          <fam-behavior>This family defines requirements for trusted channels that are not addressed by FTP_ITC in CC Part 2 because they apply specifically to channels required by a mobile device.</fam-behavior>
        </ext-comp-def>
        <!-- FTP_ITC_EXT.1 Trusted Channel Communication -->
        <f-component cc-id="ftp_itc_ext.1" id="ftp-itc-ext-1" name="Trusted Channel Communication">
          <comp-lev> requires the TSF to manage the communication channel between itself and other trusted products. </comp-lev>
          <management>The following actions could be considered for the management functions in FMT:<h:ul><h:li>Configuring the actions that require trusted channel, if applicable.</h:li> <h:li>Enabling/disabling communications protocols where the TSF acts as a server.</h:li></h:ul></management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST: <h:ul><h:li>Initiation and termination of trusted channel.</h:li></h:ul></audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-wlan">
            <title>
              The TSF shall use
              <h:ul>
                <h:li>802.11-2012 in accordance with the [<h:i><xref to="mod-wlanclient"/></h:i>],</h:li>
                <h:li>802.1X in accordance with the [<h:i><xref to="mod-wlanclient"/></h:i>],</h:li>
                <h:li>EAP-TLS in accordance with the [<h:i><xref to="mod-wlanclient"/></h:i>],</h:li>
                <h:li>Mutually authenticated TLS in accordance with the [<h:i><xref to="tls"/></h:i>]</h:li>
              </h:ul>
              and
              <selectables linebreak="yes">
                <selectable id="s-itc-ipsec">IPsec in accordance with the <xref to="mod-vpnclient"/></selectable>
                <selectable id="itc_dtls">mutually authenticated DTLS as defined in the <xref to="tls"/></selectable>
                <selectable id="ftp_itc_ext.1.1_1">HTTPS</selectable>
              </selectables>
              protocols to provide a communication channel between itself and another trusted IT product using certificates as defined in [<h:i>
                <xref to="X509"/>
              </h:i>] that is logically distinct from other communication channels, 
              provides assured identification of its end points, protects channel data from disclosure, and detects modification of the channel data.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall use
                <h:ul>
                  <h:li>802.11-2012 in accordance with <assignable>requirements or standards defining implementation of this protocol</assignable>,</h:li>
                  <h:li>802.1X in accordance with <assignable>requirements or standards defining implementation of this protocol</assignable>,</h:li>
                  <h:li>EAP-TLS in accordance with <assignable>requirements or standards defining implementation of this protocol</assignable>,</h:li>
                  <h:li>Mutually authenticated TLS in accordance with <assignable>requirements or standards defining implementation of this protocol</assignable></h:li>
                </h:ul>
                and
                <assignable>other protocols</assignable>
                protocols to provide a communication channel between itself and another trusted IT product 
                using certificates as defined in
                <assignable>requirement or standard defining the use of certificates</assignable>
                that is logically distinct from other communication channels, 
                provides assured identification of its end points, protects channel data from disclosure, and detects modification of the channel data.
              </title>
            </ext-comp-def-title>
            <note role="application">
              The intent of the mandatory portion of the above requirement is to use the cryptographic protocols identified in the requirement to establish and maintain a trusted channel between the TOE and an access point, VPN Gateway, or other trusted IT product.
              <h:br/>
              <h:br/>
              <h:br/>
              <if-opt-app>
                <!--   TODO: Looks like appref is broken   -->
                <xref to="sel-based-reqs"/>
                contains the requirements for implementing each of the other optional trusted
                channel protocols.
              </if-opt-app>
              The ST author must include the security functional
              requirements for the trusted channel protocol selected in FTP_ITC_EXT.1 in the main
              body of the ST.
              <h:br/>
              <h:br/>
              Assured identification of endpoints is performed
              according to the authentication mechanisms used by the listed trusted channel
              protocols.
              <h:br/>
              <h:br/>
              <h:p>
                Claims from the
                <xref to="X509"/>
                are only required to the extent that they are needed to support the functionality required by the trusted protocols that are claimed.
              </h:p>
              <h:p>The TSF is mandated to support mutually authenticated TLS, which means that it implements a protocol that requires the validation of a certificate presented by an external entity. Therefore, FIA_X509_EXT.1 and FIA_X509_EXT.2 will be claimed, as will FIA_TSM_EXT.1 for management of the trust store.</h:p>
              <h:p>The requirement to implement mutually authenticated TLS also means that it
                implements a protocol that requires the presentation of any certificates to an external entity. Therefore, FIA_XCU_EXT.2 will be claimed. FIA_X509_EXT.6 will also be claimed, along with any applicable dependencies, depending on how the certificates presented by the TOE are obtained.</h:p>
            </note>
          </f-element>
          <f-element id="fel-chan-init">
            <title>The TSF shall permit the TSF to initiate communication via the trusted channel.</title>
          </f-element>
          <f-element id="fel-chan-init-what">
            <title>
              The TSF shall initiate communication via the trusted channel for wireless access
              point connections, administrative communication, configured enterprise connections,
              and
              <selectables>
                <selectable id="ftp_itc_ext.1.3_1">OTA updates</selectable>
                <selectable id="ftp_itc_ext.1.3_2" exclusive="yes">no other connections</selectable>
              </selectables>.
            </title>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to determine that it describes the details
                of the TOE connecting to access points, VPN Gateways, and other trusted IT products
                in terms of the cryptographic protocols specified in the requirement, along with
                TOE-specific options or procedures that might not be reflected in the
                specifications. The evaluator shall also confirm that all protocols listed in the
                TSS are specified and included in the requirements in the ST.
                <h:br/>
                <h:br/>
                If
                OTA updates are selected, the TSS shall describe which trusted channel protocol is
                initiated by the TOE and is used for updates.
                <h:br/>
                <h:br/>
              </TSS>
              <Guidance>
                The evaluator shall confirm that the operational guidance contains
                instructions for establishing the connection to access points, VPN Gateways, and
                other trusted IT products.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                The evaluator shall also perform the following tests for each protocol listed:
                <testlist>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <h:br/>
                  <test>The evaluator shall ensure, for each communication channel with an authorized IT entity, the channel data are not sent in plaintext and that a protocol analyzer identifies the traffic as the protocol under testing.</test>
                  <test>[conditional] If <xref to="s-itc-ipsec"/> is selected, the evaluator shall ensure that the TOE is able to initiate communications with a VPN Gateway, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>[conditional]If OTA updates are selected, the evaluator shall trigger an update request according to the operational guidance and shall ensure that the communication is successful.</test>
                  <test>For any other selected protocol (not tested in Test 1, 2, or 3), the evaluator shall ensure that the TOE is able to initiate communications with a trusted IT product using the protocol, setting up the connection as described in the operational guidance and ensuring that the communication is successful.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol, non-TOE endpoint of connection</audit-event-info>
          </audit-event>
        </f-component>
        <implements>
          <feature/>
          <feature/>
        </implements>
      </section>
    </sec:SFRs>
    <!-- 5.2 Security Assurance Requirements -->
    <section title="Security Assurance Requirements" id="sar">
      The Security Objectives in
      <xref to="Security_Objectives"/>
      were constructed to address threats identified in
      <xref to="Security_Problem_Description"/>.
      The Security Functional Requirements (SFRs) in
      <xref to="sfr"/>
      are a formal
      instantiation of the Security Objectives. The PP identifies the Security Assurance
      Requirements (SARs) to frame the extent to which the evaluator assesses the documentation
      applicable for the evaluation and performs independent testing.
      <h:br/>
      <h:br/>
      This section
      lists the set of SARs from CC part 3 that are required in evaluations against this PP.
      Individual Evaluation Activities to be performed are specified both in
      <xref to="sfr"/>
      as well as in this section.
      <h:br/>
      <h:br/>
      The general model for evaluation of TOEs
      against STs written to conform to this PP is as follows:
      <h:br/>
      <h:br/>
      After the ST has
      been approved for evaluation, the ITSEF will obtain the
      TOE, supporting environmental IT, and the administrative/user guides for the TOE. The ITSEF is
      expected to perform actions mandated by the Common Evaluation Methodology (CEM) for the ASE
      and ALC SARs. The ITSEF also performs the Evaluation Activities contained within
      <xref to="sfr"/>, which are intended to be an interpretation of the other CEM evaluation
      requirements as they apply to the specific technology instantiated in the TOE. The Evaluation
      Activities that are captured in
      <xref to="sfr"/>
      also provide clarification as to what
      the developer needs to provide to demonstrate the TOE is compliant with the PP.
      <h:br/>
      <h:br/>
      The TOE Security Assurance Requirements are identified in
      <xref to="sartable"/>.
      <h:br/>
      <h:br/>
      <ctr id="sartable" ctr-type="Table">: Security Assurance Requirements</ctr>
      <h:table>
        <h:tr class="header">
          <h:td>Assurance Class</h:td>
          <h:td>Assurance Components</h:td>
        </h:tr>
        <h:tr>
          <h:td rowspan="7">Security Target (ASE)</h:td>
          <h:td>Conformance Claims (ASE_CCL.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>Extended Components Definition (ASE_ECD.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>ST Introduction (ASE_INT.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>Security Objectives for the Operational Environment
          (ASE_OBJ.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>Stated Security Requirements (ASE_REQ.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>Security Problem Definition (ASE_SPD.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>TOE Summary Specification (ASE_TSS.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>Development (ADV)</h:td>
          <h:td>Basic Functional Specification (ADV_FSP.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td rowspan="2">Guidance Documents (AGD)</h:td>
          <h:td>Operational User Guidance (AGD_OPE.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>Preparative Procedures (AGD_PRE.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td rowspan="3">Life Cycle Support (ALC)</h:td>
          <h:td>Labeling of the TOE (ALC_CMC.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>TOE CM Coverage (ALC_CMS.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>Timely Security Updates (ALC_TSU_EXT)</h:td>
        </h:tr>
        <h:tr>
          <h:td>Tests (ATE)</h:td>
          <h:td>Independent Testing – Sample (ATE_IND.1)</h:td>
        </h:tr>
        <h:tr>
          <h:td>Vulnerability Assessment (AVA)</h:td>
          <h:td>Vulnerability Survey (AVA_VAN.1)</h:td>
        </h:tr>
      </h:table>
      <section title="Class ASE: Security Target" id="ase">
        The ST is evaluated as per ASE
        activities defined in the CEM for ASE_CCL.1, ASE_ECD.1, ASE_INT.1, ASE_OBJ.1, ASE_REQ.1,
        ASE_SPD.1, and ASE_TSS.1. In addition, there may be Evaluation Activities specified within
        <xref to="sfr"/>
        that call for necessary descriptions to be included in the TSS
        that are specific to the TOE technology type.
      </section>
      <section title="Class ADV: Development" id="adv">
        The design information about the TOE is
        contained in the guidance documentation available to the end user as well as the TSS portion
        of the ST, and any additional information required by this PP that is not to be made public.
        <a-component cc-id="adv_fsp.1" name="Basic Functional Specification">
          <a-element type="D">
            <title>The developer shall provide a functional specification.</title>
            <aactivity/>
          </a-element>
          <a-element type="D">
            <title>The developer shall provide a tracing from the functional specification to the
              SFRs.</title>
            <note role="application">
              As indicated in the introduction to this section, the
              functional specification is comprised of the information contained in the AGD_OPE,
              AGD_PRE, and the API information that is provided to application developers, including
              the APIs that require privilege to invoke.
              <h:br/>
              <h:br/>
              The developer may
              reference a website accessible to application developers and the evaluator. The API
              documentation must include those interfaces required in this profile. The API
              documentation must clearly indicate to which products and versions each available
              function applies.
              <h:br/>
              <h:br/>
              The evaluation activities in the functional
              requirements point to evidence that should exist in the documentation and TSS section;
              since these are directly associated with the SFRs, the tracing in element ADV_FSP.1.2D
              is implicitly already done and no additional documentation is necessary.
            </note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The functional specification shall describe the purpose and method of use for
              each SFR-enforcing and SFR-supporting TSFI.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The functional specification shall identify all parameters associated with each
              SFR-enforcing and SFR-supporting TSFI.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The functional specification shall provide rationale for the implicit
              categorization of interfaces as SFR-non-interfering.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The tracing shall demonstrate that the SFRs trace to 
                TSFIs in the functional specification.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements
              for content and presentation of evidence.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall determine that the functional specification is an accurate
              and complete instantiation of the SFRs.</title>
            <aactivity>
              There are no specific evaluation activities associated with these SARs, except
              ensuring the information is provided. The functional specification documentation is
              provided to support the evaluation activities described in
              <xref to="sfr"/>,
              and other activities described for AGD, ATE, and AVA SARs. The requirements on the
              content of the functional specification information is implicitly assessed by virtue
              of the other evaluation activities being performed; if the evaluator is unable to
              perform an activity because there is insufficient interface information, then an
              adequate functional specification has not been provided.
            </aactivity>
          </a-element>
        </a-component>
      </section>
      <section title="Class AGD: Guidance Documentation" id="agd">
        The guidance documents will be
        provided with the ST. Guidance must include a description of how the IT personnel verifies
        that the Operational Environment can fulfill its role for the security functionality. The
        documentation should be in an informal style and readable by the IT personnel.
        <h:br/>
        <h:br/>
        Guidance must be provided for every operational environment that the
        product supports as claimed in the ST. This guidance includes:
        <h:ul>
          <h:li>Instructions to successfully install the TSF in that environment</h:li>
          <h:li>Instructions to manage the security of the TSF as a product and as a component of
            the larger operational environment</h:li>
          <h:li>Instructions to provide a protected administrative capability</h:li>
        </h:ul>
        <h:br/>
        Guidance pertaining to particular security functionality is also provided;
        requirements on such guidance are contained in the evaluation activities specified with each
        requirement.
        <a-component cc-id="agd_ope.1" name="Operational User Guidance">
          <a-element type="D">
            <title>The developer shall provide operational user guidance.</title>
            <note role="application">
              The operational user guidance does not have to be contained in
              a single document. Guidance to users, administrators and application developers can be
              spread among documents or web pages. Where appropriate, the guidance documentation is
              expressed in the eXtensible Configuration Checklist Description Format (XCCDF) to
              support security automation.
              <h:br/>
              <h:br/>
              Rather than repeat information here,
              the developer should review the evaluation activities for this component to ascertain
              the specifics of the guidance that the evaluator will be checking for. This will
              provide the necessary information for the preparation of acceptable guidance.
            </note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall describe, for each user role, the
              user-accessible functions and privileges that should be controlled in a secure
              processing environment, including appropriate warnings.</title>
            <note role="application">User and administrator (e.g., MDM agent), and application
              developer are to be considered in the definition of user role.</note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall describe, for each user role, how to use the
              available interfaces provided by the TOE in a secure manner.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall describe, for each user role, the available
              functions and interfaces, in particular all security parameters under the control of
              the user, indicating secure values as appropriate.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall, for each user role, clearly present each
              type of security-relevant event relative to the user-accessible functions that need to
              be performed, including changing the security characteristics of entities under the
              control of the TSF.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall identify all possible modes of operation of
              the OS (including operation following failure or operational error), their
              consequences, and implications for maintaining secure operation.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall, for each user role, describe the security
              measures to be followed in order to fulfill the security objectives for the
              operational environment as described in the ST.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall be clear and reasonable.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements
              for content and presentation of evidence.</title>
            <aactivity>
              Some of the contents of the operational guidance are verified by the
              evaluation activities in
              <xref to="sfr"/>
              and evaluation of the TOE according to
              the
              <xref to="CEM"/>. The following additional information is also required.
              <h:br/>
              <h:br/>
              The operational guidance shall contain a list of natively installed
              applications and any relevant version numbers. If any third party vendors are
              permitted to install applications before purchase by the end user or enterprise, these
              applications shall also be listed.
              <h:br/>
              <h:br/>
              The operational guidance shall
              contain instructions for configuring the cryptographic engine associated with the
              evaluated configuration of the TOE. It shall provide a warning to the administrator
              that use of other cryptographic engines was not evaluated nor tested during the CC
              evaluation of the TOE.
              <h:br/>
              <h:br/>
              The documentation must describe the process
              for verifying updates to the TOE by verifying a digital signature. The evaluator shall
              verify that this process includes the following steps:
              <h:ul>
                <h:li>Instructions for obtaining the update itself. This should include
                  instructions for making the update accessible to the TOE (e.g., placement in a
                  specific directory).</h:li>
                <h:li>Instructions for initiating the update process, as well as discerning
                  whether the process was successful or unsuccessful. This includes generation of
                  the hash/digital signature.</h:li>
              </h:ul>
              The TOE will likely contain security functionality that does not fall in the
              scope of evaluation under this PP. The operational guidance shall make it clear to an
              administrator which security functionality is covered by the evaluation activities.
            </aactivity>
          </a-element>
        </a-component>
        <a-component cc-id="agd_pre.1" name="Preparative Procedures">
          <a-element type="D">
            <title>The developer shall provide the TOE, including its preparative
              procedures.</title>
            <note role="application">As with the operational guidance, the developer should look to
              the evaluation activities to determine the required content with respect to preparative
              procedures.</note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The preparative procedures shall describe all the steps necessary for secure
              acceptance of the delivered TOE in accordance with the developer's delivery
              procedures.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The preparative procedures shall describe all the steps necessary for secure
              installation of the TOE and for the secure preparation of the operational environment
              in accordance with the security objectives for the operational environment as
              described in the ST.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements
              for content and presentation of evidence.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall apply the preparative procedures to confirm that the OS can
              be prepared securely for operation.</title>
            <aactivity>As indicated in the introduction above, there are significant expectations
              with respect to the documentation—especially when configuring the operational
              environment to support TOE functional requirements. The evaluator shall check to
              ensure that the guidance provided for the TOE adequately addresses all platforms
              claimed for the TOE in the ST.</aactivity>
          </a-element>
        </a-component>
      </section>
      <section title="Class ALC: Life-cycle Support" id="alc">
        At the assurance level provided
        for TOEs conformant to this PP, life-cycle support is limited to end-user-visible aspects of
        the life-cycle, rather than an examination of the TOE vendor’s development and configuration
        management process. This is not meant to diminish the critical role that a developer’s
        practices play in contributing to the overall trustworthiness of a product; rather, it is a
        reflection on the information to be made available for evaluation at this assurance level.
        <a-component cc-id="alc_cmc.1" name="Labeling of the TOE">
          <a-element type="D">
            <title>The developer shall provide the TOE and a reference for the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The TOE shall be labeled with a unique reference.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements
              for content and presentation of evidence.</title>
            <aactivity>The evaluator shall check the ST to ensure that it contains an identifier
              (such as a product name/version number) that specifically identifies the version that
              meets the requirements of the ST. Further, the evaluator shall check the AGD guidance
              and TOE samples received for testing to ensure that the version number is consistent
              with that in the ST. If the vendor maintains a web site advertising the TOE, the
              evaluator shall examine the information on the web site to ensure that the information
              in the ST is sufficient to distinguish the product.</aactivity>
          </a-element>
        </a-component>
        <a-component cc-id="alc_cms.1" name="TOE CM Coverage">
          <a-element type="D">
            <title> The developer shall provide a configuration list for the TOE. </title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The configuration list shall include the following: the TOE itself; and the
              evaluation evidence required by the SARs.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The configuration list shall uniquely identify the configuration items.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements
              for content and presentation of evidence.</title>
            <note role="application">
              The "evaluation evidence required by the SARs" in this PP is
              limited to the information in the ST coupled with the guidance provided to
              administrators and users under the AGD requirements. By ensuring that the TOE is
              specifically identified and that this identification is consistent in the ST and in
              the AGD guidance (as done in the evaluation activity for ALC_CMC.1), the evaluator
              implicitly confirms the information required by this component.
              <h:br/>
              <h:br/>
              Life-cycle support is targeted aspects of the developer’s life-cycle and instructions
              to providers of applications for the developer’s devices, rather than an in-depth
              examination of the TSF manufacturer’s development and configuration management
              process. This is not meant to diminish the critical role that a developer’s practices
              play in contributing to the overall trustworthiness of a product; rather, it’s a
              reflection on the information to be made available for evaluation.
            </note>
            <aactivity>
              The evaluator shall ensure that the developer has identified (in
              public-facing development guidance for their platform) one or more development
              environments appropriate for use in developing applications for the developer’s
              platform. For each of these development environments, the developer shall provide
              information on how to configure the environment to ensure that buffer overflow
              protection mechanisms in the environments are invoked (e.g., compiler and linker
              flags). The evaluator shall ensure that this documentation also includes an indication
              of whether such protections are on by default, or have to be specifically enabled.
              <h:br/>
              <h:br/>
              The evaluator shall ensure that the TSF is uniquely identified
              (with respect to other products from the TSF vendor), and that documentation provided
              by the developer in association with the requirements in the ST is associated with the
              TSF using this unique identification.
            </aactivity>
          </a-element>
        </a-component>
        <a-component cc-id="alc_flr.1" name="Basic Flaw Remediation (ALC_FLR.1)" status="optional">
          <a-element type="D">
            <title>The developer shall document and provide flaw remediation procedures addressed to TOE
              developers.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the procedures used to
              track all reported security flaws in each release of the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that a description of the nature and effect
              of each security flaw be provided, as well as the status of finding a correction to that flaw.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that corrective actions be identified for
              each of the security flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the methods used to
              provide flaw information, corrections and guidance on corrective actions to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for
              content and presentation of evidence.</title>
            <aactivity>Evaluated as specified by <xref to="bibCEM"/>.</aactivity>
          </a-element>
        </a-component>
        <a-component cc-id="alc_flr.2" name="Flaw Reporting Procedures (ALC_FLR.2)" status="optional">
          <a-element type="D">
            <title>The developer shall document and provide flaw remediation procedures addressed to TOE
              developers.</title>
            <aactivity/>
          </a-element>
          <a-element type="D">
            <title>The developer shall establish a procedure for accepting and acting upon all reports of
              security flaws and requests for corrections to those flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="D">
            <title>The developer shall provide flaw remediation guidance addressed to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the procedures used to track all
              reported security flaws in each release of the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that a description of the nature and effect of each
              security flaw be provided, as well as the status of finding a correction to that flaw.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that corrective actions be identified for each of the
              security flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the methods used to provide flaw
              information, corrections and guidance on corrective actions to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall describe a means by which the developer receives
              from TOE users reports and enquiries of suspected security flaws in the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The procedures for processing reported security flaws shall ensure that any reported
              flaws are remediated and the remediation procedures issued to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The procedures for processing reported security flaws shall provide safeguards that any
              corrections to these security flaws do not introduce any new flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation guidance shall describe a means by which TOE users report to the
              developer any suspected security flaws in the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for content and
              presentation of evidence.</title>
            <aactivity>Evaluated as specified by <xref to="bibCEM"/>.</aactivity>
          </a-element>
        </a-component>
        <a-component cc-id="alc_flr.3" name="Systematic Flaw Remediation (ALC_FLR.3)" status="optional">
          <a-element type="D">
            <title>The developer shall document and provide flaw remediation procedures addressed to TOE
              developers.</title>
            <aactivity/>
          </a-element>
          <a-element type="D">
            <title>The developer shall establish a procedure for accepting and acting upon all reports of security
              flaws and requests for corrections to those flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="D">
            <title>The developer shall provide flaw remediation guidance addressed to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the procedures used to track all
              reported security flaws in each release of the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that a description of the nature and effect of each
              security flaw be provided, as well as the status of finding a correction to that flaw.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that corrective actions be identified for each of the
              security flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the methods used to provide flaw
              information, corrections and guidance on corrective actions to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall describe a means by which the developer receives from
              TOE users reports and enquiries of suspected security flaws in the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall include a procedure requiring timely response and
              the automatic distribution of security flaw reports and the associated corrections to
              registered users who might be affected by the security flaw.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The procedures for processing reported security flaws shall ensure that any reported flaws are
              remediated and the remediation procedures issued to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The procedures for processing reported security flaws shall provide safeguards that any
              corrections to these security flaws do not introduce any new flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation guidance shall describe a means by which TOE users report to the
              developer any suspected security flaws in the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation guidance shall describe a means by which TOE users may register
              with the developer, to be eligible to receive security flaw reports and corrections.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation guidance shall identify the specific points of contact for all reports
              and enquiries about security issues involving the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for content and
              presentation of evidence.</title>
            <aactivity>Evaluated as specified by <xref to="bibCEM"/>.</aactivity>
          </a-element>
        </a-component>
        <a-component cc-id="alc_tsu_ext.1" name="Timely Security Updates">
          <a-element type="D">
            <title>The developer shall provide a description in the TSS of how timely security
              updates are made to the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The description shall include the process for creating and deploying security
              updates for the TOE software.</title>
            <note role="application">The software to be described includes the operating systems of the application
              processor and the baseband processor, as well as any firmware and applications. The
              process description includes the TOE developer processes as well as any third-party
              (carrier) processes. The process description includes each deployment mechanism (e.g.,
              over-the-air updates, per-carrier updates, downloaded updates).</note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The description shall express the time window as the length of time, in days,
              between public disclosure of a vulnerability and the public availability of security
              updates to the TOE.</title>
            <note role="application">The total length of time may be presented as a summation of the periods of time
              that each party (e.g., TOE developer, mobile carrier) on the critical path consumes.
              The time period until public availability per deployment mechanism may differ; each is
              described.</note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The description shall include the mechanisms publicly available for reporting
              security issues pertaining to the TOE.</title>
            <note role="application">The reporting mechanism could include web sites, email addresses, as well as a
              means to protect the sensitive nature of the report (e.g., public keys that could be
              used to encrypt the details of a proof-of-concept exploit).</note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The description shall include where users can seek information about the
              availability of new updates including details (e.g. CVE identifiers) of the specific
              public vulnerabilities corrected by each update.</title>
            <note role="application">The purpose of providing this information is so that users and enterprises can
              determine which devices are susceptible to publicly known vulnerabilities so that they
              can make appropriate risk decisions, such as limiting access to enterprise resources
              until updates are installed.</note>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements
              for content and presentation of evidence.</title>
            <aactivity>
              The evaluator shall verify that the TSS contains a description of the timely
              security update process used by the developer to create and deploy security updates.
              The evaluator shall verify that this description addresses the TOE OS, the firmware,
              and bundled applications, each. The evaluator shall also verify that, in addition to
              the TOE developer’s process, any carrier or other third-party processes are also
              addressed in the description. The evaluator shall also verify that each mechanism for
              deployment of security updates is described.
              <h:br/>
              <h:br/>
              The evaluator shall
              verify that, for each deployment mechanism described for the update process, the TSS
              lists a time between public disclosure of a vulnerability and public availability of
              the security update to the TOE patching this vulnerability, to include any third-party
              or carrier delays in deployment. The evaluator shall verify that this time is
              expressed in a number or range of days.
              <h:br/>
              <h:br/>
              The evaluator shall verify
              that this description includes the publicly available mechanisms (including either an
              email address or website) for reporting security issues related to the TOE. The
              evaluator shall verify that the description of this mechanism includes a method for
              protecting the report either using a public key for encrypting email or a trusted
              channel for a website.
              <h:br/>
              <h:br/>
              The evaluator shall verify that the
              description includes where users can seek information about the availability of new
              security updates including details of the specific public vulnerabilities corrected by
              each update. The evaluator shall verify that the description includes the minimum
              amount of time that the TOE is expected to be supported with security updates, and the
              process by which users can seek information about when the TOE is no longer expected
              to receive security updates.
            </aactivity>
          </a-element>
        </a-component>
      </section>
      <section title="Class ATE: Tests" id="ate">
        Testing is specified for functional aspects of
        the system as well as aspects that take advantage of design or implementation weaknesses.
        The former is done through the ATE_IND family, while the latter is through the AVA_VAN
        family. At the assurance level specified in this PP, testing is based on advertised
        functionality and interfaces with dependency on the availability of design information. One
        of the primary outputs of the evaluation process is the test report as specified in the
        following requirements.
        <h:br/>
        <h:br/>
        Since many of the APIs are not exposed at the
        user interface (e.g., touch screen), the ability to stimulate the necessary interfaces
        requires a developer’s test environment. This test environment will allow the evaluator, for
        example, to access APIs and view file system information that is not available on consumer
        Mobile Devices.
        <a-component cc-id="ate_ind.1" name="Independent Testing – Conformance">
          <a-element type="D">
            <title>The developer shall provide the TOE for testing.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The TOE shall be suitable for testing.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets
              all requirements for content and presentation of evidence.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall test a subset of the TSF to confirm that the TSF operates as
              specified.</title>
            <aactivity>
              The evaluator shall prepare a test plan and report documenting the testing
              aspects of the system. The test plan covers all of the testing actions contained in
              the
              <xref to="CEM"/>
              and the body of this PP’s Evaluation Activities. While it is
              not necessary to have one test case per test listed in an evaluation activity, the
              evaluator must document in the test plan that each applicable testing requirement in
              the ST is covered.
              <h:br/>
              <h:br/>
              The test plan identifies the platforms to be
              tested, and for those platforms not included in the test plan but included in the ST,
              the test plan provides a justification for not testing the platforms. This
              justification must address the differences between the tested platforms and the
              untested platforms, and make an argument that the differences do not affect the
              testing to be performed. It is not sufficient to merely assert that the differences
              have no affect; rationale must be provided. If all platforms claimed in the ST are
              tested, then no rationale is necessary.
              <h:br/>
              <h:br/>
              The test plan describes the
              composition of each platform to be tested, and any setup that is necessary beyond what
              is contained in the AGD documentation. It should be noted that the evaluator is
              expected to follow the AGD documentation for installation and setup of each platform
              either as part of a test or as a standard pre-test condition. This may include special
              test drivers or tools. For each driver or tool, an argument (not just an assertion)
              should be provided that the driver or tool will not adversely affect the performance
              of the functionality by the TOE and its platform. This also includes the configuration
              of the cryptographic engine to be used. The cryptographic algorithms implemented by
              this engine are those specified by this PP and used by the cryptographic protocols
              being evaluated (IPsec, TLS/HTTPS, SSH).
              <h:br/>
              <h:br/>
              The test plan identifies
              high-level test objectives as well as the test procedures to be followed to achieve
              those objectives. These procedures include expected results. The test report (which
              could just be an annotated version of the test plan) details the activities that took
              place when the test procedures were executed, and includes the actual results of the
              tests. This shall be a cumulative account, so if there was a test run that resulted in
              a failure; a fix installed; and then a successful re-run of the test, the report would
              show a "fail" and "pass" result (and the supporting details), and not just the "pass"
              result.
            </aactivity>
          </a-element>
        </a-component>
      </section>
      <section title="Class AVA: Vulnerability Assessment" id="ava">
        For the current generation
        of this protection profile, the evaluation lab is expected to survey open sources to
        discover what vulnerabilities have been discovered in these types of products. In most
        cases, these vulnerabilities will require sophistication beyond that of a basic attacker.
        Until penetration tools are created and uniformly distributed to the evaluation labs, the
        evaluator will not be expected to test for these vulnerabilities in the TOE. The labs will
        be expected to comment on the likelihood of these vulnerabilities given the documentation
        provided by the vendor. This information will be used in the development of penetration
        testing tools and for the development of future protection profiles.
        <a-component cc-id="ava_van.1" name="Vulnerability Survey">
          <a-element type="D">
            <title>The developer shall provide the TOE for testing.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The TOE shall be suitable for testing.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements
              for content and presentation of evidence.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall perform a search of public domain sources to identify
              potential vulnerabilities in the TOE.</title>
            <note role="application">Public domain sources include the Common Vulnerabilities and
              Exposures (CVE) dictionary for publicly-known vulnerabilities.</note>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall conduct penetration testing, based on the identified
              potential vulnerabilities, to determine that the TOE is resistant to attacks performed
              by an attacker possessing Basic attack potential.</title>
            <aactivity>
              The evaluator shall generate a report to document their findings with respect
              to this requirement. This report could physically be part of the overall test report
              mentioned in ATE_IND, or a separate document. The evaluator performs a search of
              public information to find vulnerabilities that have been found in mobile devices and
              the implemented communication protocols in general, as well as those that pertain to
              the particular TOE. The evaluator documents the sources consulted and the
              vulnerabilities found in the report.
              <h:br/>
              <h:br/>
              For each vulnerability found,
              the evaluator either provides a rationale with respect to its non-applicability, or
              the evaluator formulates a test (using the guidelines provided in ATE_IND) to confirm
              the vulnerability, if suitable. Suitability is determined by assessing the attack
              vector needed to take advantage of the vulnerability. If exploiting the vulnerability
              requires expert skills and an electron microscope, for instance, then a test would not
              be suitable and an appropriate justification would be formulated.
            </aactivity>
          </a-element>
        </a-component>
      </section>
    </section>
  </sec:req>
  <appendix title="Implicitly Satisfied Requirements" id="satisfiedreqs">
    <h:table>
      <h:tr>
        <h:th>Requirement</h:th>
        <h:th>Rationale for Satisfaction</h:th>
      </h:tr>
      <h:tr>
        <h:td>FAU_SEL.1 - Selective Audit</h:td>
        <h:td>FAU_SEL.1 has a dependency on FMT_MTD.1 since configuration of audit data is a subset of managing TSF data. This dependency is met by FMT_SMF_EXT.1, which 
          defines "configure the auditable items" as a management function and specifies the roles that may perform this, consistent with how FMT_MTD.1 would typically satisfy the dependency.</h:td>
      </h:tr>
      <!--   
      <h:tr>
        <h:td>FCS_HTTPS_EXT.1 - HTTPS Protocol</h:td>
        <h:td>FCS_HTTPS_EXT.1 has a dependency on FMT_SMF_EXT.1 for management of the TOE's behavior in the event of an invalid certificate. This dependency is met
          by the extended SFR FMT_SMF_EXT.1 (specifically function 23), which serves the same purpose as its CC Part 2 equivalent.</h:td>
      </h:tr>
        -->
      <h:tr>
        <h:td>FCS_STG_EXT.1 - Cryptographic Key Storage</h:td>
        <h:td>FCS_STG_EXT.1 has a dependency on FMT_SMR.1 for the management roles that are authorized to manage the functionality defined by the requirement. 
          This dependency is met by FMT_SMF_EXT.1, which implicitly defines separate management roles for the TSF.</h:td>
      </h:tr>
      <h:tr>
        <h:td>FDP_ACF_EXT.1 - Access Control for System Services</h:td>
        <h:td>FDP_ACF_EXT.1 has a dependency on FMT_SMR.1 for the management roles that are authorized to manage the functionality defined by the requirement. 
          This dependency is met by FMT_SMF_EXT.1, which implicitly defines separate management roles for the TSF.</h:td>
      </h:tr>
      <h:tr>
        <h:td>FDP_ACF_EXT.2 - Access Control for System Resources</h:td>
        <h:td>FDP_ACF_EXT.2 has a dependency on FMT_SMR.1 for the management roles that are authorized to manage the functionality defined by the requirement. 
          This dependency is met by FMT_SMF_EXT.1, which implicitly defines separate management roles for the TSF.</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_AFL_EXT.1 - Authentication Failure Handling</h:td>
        <h:td>FIA_AFL_EXT.1 has a dependency on FIA_UAU.1 since handling of authentication failures is not possible without an authentication mechanism. This dependency is met
          by the extended SFR FIA_UAU_EXT.1, which serves the same purpose as its CC Part 2 equivalent.</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_PMG_EXT.1 - Password Management</h:td>
        <h:td>FIA_PMG_EXT.1 has a dependency on FIA_UAU.1 since composition of authentication credentials is not possible without an authentication mechanism. This dependency is met
          by the extended SFR FIA_UAU_EXT.1, which serves the same purpose as its CC Part 2 equivalent.</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_UAU.7 - Protected Authentication Feedback</h:td>
        <h:td>FIA_UAU.7 has a dependency on FIA_UAU.1 since protected authentication feedback is not possible without an authentication mechanism. This dependency is met
          by the extended SFR FIA_UAU_EXT.1, which serves the same purpose as its CC Part 2 equivalent.</h:td>
      </h:tr>
      <h:tr>
        <h:td>FMT_MOF_EXT.1 - Management of Security Functions Behavior</h:td>
        <h:td>FMT_MOF_EXT.1 has a dependency on FMT_SMF.1 through its reference to management functions in the requirement text. 
          This dependency is met by FMT_SMF_EXT.1, which defines management functions specifically for the TSF.</h:td>
      </h:tr>
      <h:tr>
        <h:td>FMT_SMF_EXT.3 - Current Administrator</h:td>
        <h:td>FMT_SMF_EXT.3 has a dependency on FMT_SMR.1 through its reference to management roles in the requirement text. 
          This dependency is met by FMT_SMF_EXT.1, which implicitly defines separate management roles for the TSF.</h:td>
      </h:tr>
    </h:table>
  </appendix>
  <appendix title="Entropy Documentation And Assessment" id="entropyappendix">
    The documentation of the
    entropy source should be detailed enough that, after reading, the evaluator will thoroughly
    understand the entropy source and why it can be relied upon to provide entropy. This
    documentation should include multiple detailed sections: design description, entropy
    justification, operating conditions, and health testing. This documentation is not required to
    be part of the TSS.
    <section id="description" title="Design Description">
      Documentation shall
      include the design of the entropy source as a whole, including the interaction of all entropy
      source components. It will describe the operation of the entropy source to include how it
      works, how entropy is produced, and how unprocessed (raw) data can be obtained from within the
      entropy source for testing purposes. The documentation should walk through the entropy source
      design indicating where the random comes from, where it is passed next, any post-processing of
      the raw outputs (hash, XOR, etc.), if/where it is stored, and finally, how it is output from
      the entropy source. Any conditions placed on the process (e.g., blocking) should also be
      described in the entropy source design. Diagrams and examples are encouraged.
      <h:br/>
      <h:br/>
      This design must also include a description of the content of the security
      boundary of the entropy source and a description of how the security boundary ensures that an
      adversary outside the boundary cannot affect the entropy rate.
      <h:br/>
      <h:br/>
      If
      implemented, the design description shall include a description of how third-party
      applications can add entropy to the RBG. A description of any RBG state saving between
      power-off and power-on shall be included.
    </section>
    <section id="justification" title="Entropy Justification">
      There should be a technical argument
      for where the unpredictability in the source comes from and why there is confidence in the
      entropy source exhibiting probabilistic behavior (an explanation of the probability
      distribution and justification for that distribution given the particular source is one way to
      describe this). This argument will include a description of the expected entropy rate and
      explain how you ensure that sufficient entropy is going into the TOE randomizer seeding
      process. This discussion will be part of a justification for why the entropy source can be
      relied upon to produce bits with entropy.
      <h:br/>
      <h:br/>
      The entropy justification shall
      not include any data added from any third-party application or from any state saving between
      restarts.
    </section>
    <section id="conditions" title="Operating Conditions">Documentation will also include the range
      of operating conditions under which the entropy source is expected to generate random data. It
      will clearly describe the measures that have been taken in the system design to ensure the
      entropy source continues to operate under those conditions. Similarly, documentation shall
      describe the conditions under which the entropy source is known to malfunction or become
      inconsistent. Methods used to detect failure or degradation of the source shall be included.</section>
    <section id="testing" title="Health Testing">More specifically, all entropy source health tests
      and their rationale will be documented. This will include a description of the health tests,
      the rate and conditions under which each health test is performed (e.g., at startup,
      continuously, or on-demand), the expected results for each health test, and rationale
      indicating why each test is believed to be appropriate for detecting one or more failures in
      the entropy source.</section>
  </appendix>
  <appendix title="Acknowledgments" id="ack">
    <after_bib/>
    This protection profile was developed by the Mobility Technical Community with representatives from industry, U.S. Government agencies, Common Criteria Test Laboratories, and international Common Criteria schemes. The National Information Assurance Partnership wishes to acknowledge and thank the members of this group whose dedicated efforts contributed significantly to the publication. These organizations include:
    <h:br/>
    <h:br/>
    <h:b>U.S. Government</h:b>
    <h:br/>
    Defense Information Systems Agency (DISA)
    <h:br/>
    CyberSecurity Directorate (CSD)
    <h:br/>
    National Information Assurance Partnership (NIAP)
    <h:br/>
    National Institute of Standards and Technology (NIST)
    <h:br/>
    <h:br/>
    <h:b>International Common Criteria Schemes</h:b>
    <h:br/>
    Australian Information Security Evaluation Program (AISEP)
    <h:br/>
    Canadian Common Criteria Evaluation and Certification Scheme (CSEC)
    <h:br/>
    Information-technology Promotion Agency, Japan (IPA)
    <h:br/>
    UK IT Security Evaluation and Certificate Scheme (NCSC)
    <h:br/>
    <h:br/>
    <h:b>Industry</h:b>
    <h:br/>
    Apple, Inc.
    <h:br/>
    BlackBerry
    <h:br/>
    LG Electronics, Inc.
    <h:br/>
    Microsoft Corporation
    <h:br/>
    Motorola Solutions
    <h:br/>
    Samsung Electronics Co., Ltd.
    <h:br/>
    Other Members of the Mobility Technical Community
    <h:br/>
    <h:br/>
    <h:b>Common Criteria Test Laboratories</h:b>
    <h:br/>
    EWA-Canada, Ltd.
    <h:br/>
    Gossamer Security Solutions
    <h:br/>
  </appendix>
  <bibliography/>
</PP>
